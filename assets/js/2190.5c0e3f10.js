/*! For license information please see 2190.5c0e3f10.js.LICENSE.txt */
(self.webpackChunkreact_spreadsheet=self.webpackChunkreact_spreadsheet||[]).push([[2190],{7370:t=>{const e="\u0e28\u0e39\u0e19\u0e22\u0e4c\u0e1a\u0e32\u0e17\u0e16\u0e49\u0e27\u0e19",r=["","\u0e2b\u0e19\u0e36\u0e48\u0e07","\u0e2a\u0e2d\u0e07","\u0e2a\u0e32\u0e21","\u0e2a\u0e35\u0e48","\u0e2b\u0e49\u0e32","\u0e2b\u0e01","\u0e40\u0e08\u0e47\u0e14","\u0e41\u0e1b\u0e14","\u0e40\u0e01\u0e49\u0e32"],n=["","\u0e2a\u0e34\u0e1a","\u0e23\u0e49\u0e2d\u0e22","\u0e1e\u0e31\u0e19","\u0e2b\u0e21\u0e37\u0e48\u0e19","\u0e41\u0e2a\u0e19","\u0e25\u0e49\u0e32\u0e19"];function o(t){let e="";const a=t.length;if(a>7){const e=a-7+1,r=t.slice(0,e),n=t.slice(e);return o(r)+"\u0e25\u0e49\u0e32\u0e19"+o(n)}for(let o=0;o<a;o++){const i=t[o];i>0&&(e+=r[i]+n[a-o-1])}return e}function a(t){let e=t;e=e.replace("\u0e2b\u0e19\u0e36\u0e48\u0e07\u0e2a\u0e34\u0e1a","\u0e2a\u0e34\u0e1a"),e=e.replace("\u0e2a\u0e2d\u0e07\u0e2a\u0e34\u0e1a","\u0e22\u0e35\u0e48\u0e2a\u0e34\u0e1a");return e.length>5&&e.length-e.lastIndexOf("\u0e2b\u0e19\u0e36\u0e48\u0e07")==5&&(e=e.substr(0,e.length-5)+"\u0e40\u0e2d\u0e47\u0e14"),e}null!=t.exports&&(t.exports=function(t){let r=e;if(isNaN(t))return r;if(t>=Number.MAX_SAFE_INTEGER)return r;const n=Math.floor(t).toString(),i=Math.round(t%1*100).toString(),c=Array.from(n).map(Number),s=Array.from(i).map(Number);let u=o(c),l=o(s);return u=a(u),l=a(l),r=function(t,r){let n="";return n=""===t&&""===r?e:""!==t&&""===r?t+"\u0e1a\u0e32\u0e17\u0e16\u0e49\u0e27\u0e19":""===t&&""!==r?r+"\u0e2a\u0e15\u0e32\u0e07\u0e04\u0e4c":t+"\u0e1a\u0e32\u0e17"+r+"\u0e2a\u0e15\u0e32\u0e07\u0e04\u0e4c",n}(u,l),r})},4809:(t,e)=>{var r;r=function(t){t.version="1.0.2";var e=Math;function r(t,e){for(var r=0,n=0;r<t.length;++r)n=e*n+t[r];return n}function n(t,e,r,n,o){if(0===e)return r;if(1===e)return n;for(var a=2/t,i=n,c=1;c<e;++c)i=n*c*a+o*r,r=n,n=i;return i}function o(t,e,r,o,a){return function(r,i){if(o){if(0===r)return 1==o?-1/0:1/0;if(r<0)return NaN}return 0===i?t(r):1===i?e(r):i<0?NaN:n(r,i|=0,t(r),e(r),a)}}var a,i,c,s,u,l,f,h,p,d,m,v,g,E=function(){var t=.636619772,o=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),a=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),i=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),c=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse();function s(n){var s=0,u=0,l=0,f=n*n;if(n<8)s=(u=r(o,f))/(l=r(a,f));else{var h=n-.785398164;u=r(i,f=64/f),l=r(c,f),s=e.sqrt(t/n)*(e.cos(h)*u-e.sin(h)*l*8/n)}return s}var u=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),l=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),f=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),h=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function p(n){var o=0,a=0,i=0,c=n*n,s=e.abs(n)-2.356194491;return Math.abs(n)<8?o=(a=n*r(u,c))/(i=r(l,c)):(a=r(f,c=64/c),i=r(h,c),o=e.sqrt(t/e.abs(n))*(e.cos(s)*a-e.sin(s)*i*8/e.abs(n)),n<0&&(o=-o)),o}return function t(r,o){if(o=Math.round(o),!isFinite(r))return isNaN(r)?r:0;if(o<0)return(o%2?-1:1)*t(r,-o);if(r<0)return(o%2?-1:1)*t(-r,o);if(0===o)return s(r);if(1===o)return p(r);if(0===r)return 0;var a=0;if(r>o)a=n(r,o,s(r),p(r),-1);else{for(var i=!1,c=0,u=0,l=1,f=0,h=2/r,d=2*e.floor((o+e.floor(e.sqrt(40*o)))/2);d>0;d--)f=d*h*l-c,c=l,l=f,e.abs(l)>1e10&&(l*=1e-10,c*=1e-10,a*=1e-10,u*=1e-10),i&&(u+=l),i=!i,d==o&&(a=c);a/=u=2*u-l}return a}}(),y=(a=.636619772,i=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),c=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),s=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),u=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),l=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),f=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),h=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),p=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse(),o((function(t){var n=0,o=0,l=0,f=t*t,h=t-.785398164;return t<8?n=(o=r(i,f))/(l=r(c,f))+a*E(t,0)*e.log(t):(o=r(s,f=64/f),l=r(u,f),n=e.sqrt(a/t)*(e.sin(h)*o+e.cos(h)*l*8/t)),n}),(function(t){var n=0,o=0,i=0,c=t*t,s=t-2.356194491;return t<8?n=(o=t*r(l,c))/(i=r(f,c))+a*(E(t,1)*e.log(t)-1/t):(o=r(h,c=64/c),i=r(p,c),n=e.sqrt(a/t)*(e.sin(s)*o+e.cos(s)*i*8/t)),n}),0,1,-1)),N=(d=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),m=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),v=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),g=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function t(n,o){if(0===(o=Math.round(o)))return function(t){return t<=3.75?r(d,t*t/14.0625):e.exp(e.abs(t))/e.sqrt(e.abs(t))*r(m,3.75/e.abs(t))}(n);if(1===o)return function(t){return t<3.75?t*r(v,t*t/14.0625):(t<0?-1:1)*e.exp(e.abs(t))/e.sqrt(e.abs(t))*r(g,3.75/e.abs(t))}(n);if(o<0)return NaN;if(0===e.abs(n))return 0;if(n==1/0)return 1/0;var a,i=0,c=2/e.abs(n),s=0,u=1,l=0;for(a=2*e.round((o+e.round(e.sqrt(40*o)))/2);a>0;a--)l=a*c*u+s,s=u,u=l,e.abs(u)>1e10&&(u*=1e-10,s*=1e-10,i*=1e-10),a==o&&(i=s);return i*=t(n,0)/u,n<0&&o%2?-i:i}),R=function(){var t=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),n=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),a=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),i=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return o((function(o){return o<=2?-e.log(o/2)*N(o,0)+r(t,o*o/4):e.exp(-o)/e.sqrt(o)*r(n,2/o)}),(function(t){return t<=2?e.log(t/2)*N(t,1)+1/t*r(a,t*t/4):e.exp(-t)/e.sqrt(t)*r(i,2/t)}),0,2,1)}();t.besselj=E,t.bessely=y,t.besseli=N,t.besselk=R},"undefined"==typeof DO_NOT_EXPORT_BESSEL?r(e):r({})},5949:(t,e,r)=>{"use strict";r.r(e),r.d(e,{Alternation:()=>Ot,Alternative:()=>Nt,CstParser:()=>Cr,EMPTY_ALT:()=>Ir,EOF:()=>pt,EarlyExitException:()=>De,EmbeddedActionsParser:()=>br,GAstVisitor:()=>xt,Lexer:()=>Z,LexerDefinitionErrorType:()=>X,MismatchedTokenException:()=>ke,NoViableAltException:()=>Pe,NonTerminal:()=>Et,NotAllInputParsedException:()=>Be,Option:()=>Rt,Parser:()=>zr,ParserDefinitionErrorType:()=>Mr,Repetition:()=>Mt,RepetitionMandatory:()=>Tt,RepetitionMandatoryWithSeparator:()=>At,RepetitionWithSeparator:()=>wt,Rule:()=>yt,Terminal:()=>It,VERSION:()=>n,assignOccurrenceIndices:()=>Oe,clearCache:()=>Gr,createSyntaxDiagramsCode:()=>Ur,createToken:()=>ht,createTokenInstance:()=>dt,defaultGrammarResolverErrorProvider:()=>zt,defaultGrammarValidatorErrorProvider:()=>Ht,defaultLexerErrorProvider:()=>J,defaultParserErrorProvider:()=>Gt,generateParserFactory:()=>jr,generateParserModule:()=>Vr,isRecognitionException:()=>Le,resolveGrammar:()=>Me,serializeGrammar:()=>St,serializeProduction:()=>Ct,tokenLabel:()=>tt,tokenMatcher:()=>mt,tokenName:()=>et,validateGrammar:()=>we});var n="7.1.2",o=r(1632),a=r(2475),i={},c=new a.RegExpParser;function s(t){var e=t.toString();if(i.hasOwnProperty(e))return i[e];var r=c.pattern(e);return i[e]=r,r}var u,l=(u=function(t,e){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},u(t,e)},function(t,e){function r(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),f="Complement Sets are not supported for first char optimization",h='Unable to use "first char" lexer optimizations:\n';function p(t,e){void 0===e&&(e=!1);try{var r=s(t);return d(r.value,{},r.flags.ignoreCase)}catch(i){if(i.message===f)e&&(0,o.x5)(h+"\tUnable to optimize: < "+t.toString()+" >\n\tComplement Sets cannot be automatically optimized.\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.");else{var n="";e&&(n="\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details."),(0,o.Zi)(h+"\n\tFailed parsing: < "+t.toString()+" >\n\tUsing the regexp-to-ast library version: "+a.VERSION+"\n\tPlease open an issue at: https://github.com/bd82/regexp-to-ast/issues"+n)}}return[]}function d(t,e,r){switch(t.type){case"Disjunction":for(var n=0;n<t.value.length;n++)d(t.value[n],e,r);break;case"Alternative":var a=t.value;for(n=0;n<a.length;n++){var i=a[n];switch(i.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var c=i;switch(c.type){case"Character":m(c.value,e,r);break;case"Set":if(!0===c.complement)throw Error(f);(0,o.jJ)(c.value,(function(t){if("number"==typeof t)m(t,e,r);else{var n=t;if(!0===r)for(var o=n.from;o<=n.to;o++)m(o,e,r);else{for(o=n.from;o<=n.to&&o<D;o++)m(o,e,r);if(n.to>=D)for(var a=n.from>=D?n.from:D,i=n.to,c=F(a),s=F(i),u=c;u<=s;u++)e[u]=u}}}));break;case"Group":d(c.value,e,r);break;default:throw Error("Non Exhaustive Match")}var s=void 0!==c.quantifier&&0===c.quantifier.atLeast;if("Group"===c.type&&!1===g(c)||"Group"!==c.type&&!1===s)break}break;default:throw Error("non exhaustive match!")}return(0,o.zu)(e)}function m(t,e,r){var n=F(t);e[n]=n,!0===r&&function(t,e){var r=String.fromCharCode(t),n=r.toUpperCase();if(n!==r){e[o=F(n.charCodeAt(0))]=o}else{var o,a=r.toLowerCase();if(a!==r)e[o=F(a.charCodeAt(0))]=o}}(t,e)}function v(t,e){return(0,o.I6)(t.value,(function(t){if("number"==typeof t)return(0,o.gR)(e,t);var r=t;return void 0!==(0,o.I6)(e,(function(t){return r.from<=t&&t<=r.to}))}))}function g(t){return!(!t.quantifier||0!==t.quantifier.atLeast)||!!t.value&&((0,o.cy)(t.value)?(0,o.Si)(t.value,g):g(t.value))}var E=function(t){function e(e){var r=t.call(this)||this;return r.targetCharCodes=e,r.found=!1,r}return l(e,t),e.prototype.visitChildren=function(e){if(!0!==this.found){switch(e.type){case"Lookahead":return void this.visitLookahead(e);case"NegativeLookahead":return void this.visitNegativeLookahead(e)}t.prototype.visitChildren.call(this,e)}},e.prototype.visitCharacter=function(t){(0,o.gR)(this.targetCharCodes,t.value)&&(this.found=!0)},e.prototype.visitSet=function(t){t.complement?void 0===v(t,this.targetCharCodes)&&(this.found=!0):void 0!==v(t,this.targetCharCodes)&&(this.found=!0)},e}(a.BaseRegExpVisitor);function y(t,e){if(e instanceof RegExp){var r=s(e),n=new E(t);return n.visit(r),n.found}return void 0!==(0,o.I6)(e,(function(e){return(0,o.gR)(t,e.charCodeAt(0))}))}var N=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),R="PATTERN",T="defaultMode",A="modes",M="boolean"==typeof new RegExp("(?:)").sticky;function w(t,e){var r,n=(e=(0,o.NT)(e,{useSticky:M,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r","\n"],tracer:function(t,e){return e()}})).tracer;n("initCharCodeToOptimizedIndexMap",(function(){!function(){if((0,o.Im)(j)){j=new Array(65536);for(var t=0;t<65536;t++)j[t]=t>255?255+~~(t/255):t}}()})),n("Reject Lexer.NA",(function(){r=(0,o.ku)(t,(function(t){return t[R]===Z.NA}))}));var a,i,c,s,u,l,f,d,m,v,g,E=!1;n("Transform Patterns",(function(){E=!1,a=(0,o.Tj)(r,(function(t){var r=t[R];if((0,o.gd)(r)){var n=r.source;return 1!==n.length||"^"===n||"$"===n||"."===n||r.ignoreCase?2!==n.length||"\\"!==n[0]||(0,o.gR)(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],n[1])?e.useSticky?b(r):C(r):n[1]:n}if((0,o.Tn)(r))return E=!0,{exec:r};if((0,o.zy)(r,"exec"))return E=!0,r;if("string"==typeof r){if(1===r.length)return r;var a=r.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),i=new RegExp(a);return e.useSticky?b(i):C(i)}throw Error("non exhaustive match")}))})),n("misc mapping",(function(){i=(0,o.Tj)(r,(function(t){return t.tokenTypeIdx})),c=(0,o.Tj)(r,(function(t){var e=t.GROUP;if(e!==Z.SKIPPED){if((0,o.Kg)(e))return e;if((0,o.b0)(e))return!1;throw Error("non exhaustive match")}})),s=(0,o.Tj)(r,(function(t){var e=t.LONGER_ALT;if(e)return(0,o.qh)(r,e)})),u=(0,o.Tj)(r,(function(t){return t.PUSH_MODE})),l=(0,o.Tj)(r,(function(t){return(0,o.zy)(t,"POP_MODE")}))})),n("Line Terminator Handling",(function(){var t=P(e.lineTerminatorCharacters);f=(0,o.Tj)(r,(function(t){return!1})),"onlyOffset"!==e.positionTracking&&(f=(0,o.Tj)(r,(function(e){return(0,o.zy)(e,"LINE_BREAKS")?e.LINE_BREAKS:!1===k(e,t)?y(t,e.PATTERN):void 0})))})),n("Misc Mapping #2",(function(){d=(0,o.Tj)(r,x),m=(0,o.Tj)(a,L),v=(0,o.TS)(r,(function(t,e){var r=e.GROUP;return(0,o.Kg)(r)&&r!==Z.SKIPPED&&(t[r]=[]),t}),{}),g=(0,o.Tj)(a,(function(t,e){return{pattern:a[e],longerAlt:s[e],canLineTerminator:f[e],isCustom:d[e],short:m[e],group:c[e],push:u[e],pop:l[e],tokenTypeIdx:i[e],tokenType:r[e]}}))}));var N=!0,T=[];return e.safeMode||n("First Char Optimization",(function(){T=(0,o.TS)(r,(function(t,r,n){if("string"==typeof r.PATTERN){var a=F(r.PATTERN.charCodeAt(0));B(t,a,g[n])}else if((0,o.cy)(r.START_CHARS_HINT)){var i;(0,o.jJ)(r.START_CHARS_HINT,(function(e){var r=F("string"==typeof e?e.charCodeAt(0):e);i!==r&&(i=r,B(t,r,g[n]))}))}else if((0,o.gd)(r.PATTERN))if(r.PATTERN.unicode)N=!1,e.ensureOptimizations&&(0,o.Zi)(h+"\tUnable to analyze < "+r.PATTERN.toString()+" > pattern.\n\tThe regexp unicode flag is not currently supported by the regexp-to-ast library.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE");else{var c=p(r.PATTERN,e.ensureOptimizations);(0,o.Im)(c)&&(N=!1),(0,o.jJ)(c,(function(e){B(t,e,g[n])}))}else e.ensureOptimizations&&(0,o.Zi)(h+"\tTokenType: <"+r.name+"> is using a custom token pattern without providing <start_chars_hint> parameter.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE"),N=!1;return t}),[])})),n("ArrayPacking",(function(){T=(0,o.VS)(T)})),{emptyGroups:v,patternIdxToConfig:g,charCodeToPatternIdxToConfig:T,hasCustom:E,canBeOptimized:N}}function O(t,e){var r=[],n=function(t){var e=(0,o.pb)(t,(function(t){return!(0,o.zy)(t,R)})),r=(0,o.Tj)(e,(function(t){return{message:"Token Type: ->"+t.name+"<- missing static 'PATTERN' property",type:X.MISSING_PATTERN,tokenTypes:[t]}})),n=(0,o.iv)(t,e);return{errors:r,valid:n}}(t);r=r.concat(n.errors);var i=function(t){var e=(0,o.pb)(t,(function(t){var e=t[R];return!((0,o.gd)(e)||(0,o.Tn)(e)||(0,o.zy)(e,"exec")||(0,o.Kg)(e))})),r=(0,o.Tj)(e,(function(t){return{message:"Token Type: ->"+t.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:X.INVALID_PATTERN,tokenTypes:[t]}})),n=(0,o.iv)(t,e);return{errors:r,valid:n}}(n.valid),c=i.valid;return r=(r=r.concat(i.errors)).concat(function(t){var e=[],r=(0,o.pb)(t,(function(t){return(0,o.gd)(t[R])}));return e=e.concat(function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.found=!1,e}return N(e,t),e.prototype.visitEndAnchor=function(t){this.found=!0},e}(a.BaseRegExpVisitor),r=(0,o.pb)(t,(function(t){var r=t[R];try{var n=s(r),o=new e;return o.visit(n),o.found}catch(a){return I.test(r.source)}})),n=(0,o.Tj)(r,(function(t){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+t.name+"<- static 'PATTERN' cannot contain end of input anchor '$'\n\tSee chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:X.EOI_ANCHOR_FOUND,tokenTypes:[t]}}));return n}(r)),e=e.concat(function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.found=!1,e}return N(e,t),e.prototype.visitStartAnchor=function(t){this.found=!0},e}(a.BaseRegExpVisitor),r=(0,o.pb)(t,(function(t){var r=t[R];try{var n=s(r),o=new e;return o.visit(n),o.found}catch(a){return S.test(r.source)}})),n=(0,o.Tj)(r,(function(t){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+t.name+"<- static 'PATTERN' cannot contain start of input anchor '^'\n\tSee https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:X.SOI_ANCHOR_FOUND,tokenTypes:[t]}}));return n}(r)),e=e.concat(function(t){var e=(0,o.pb)(t,(function(t){var e=t[R];return e instanceof RegExp&&(e.multiline||e.global)})),r=(0,o.Tj)(e,(function(t){return{message:"Token Type: ->"+t.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:X.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[t]}}));return r}(r)),e=e.concat(function(t){var e=[],r=(0,o.Tj)(t,(function(r){return(0,o.TS)(t,(function(t,n){return r.PATTERN.source!==n.PATTERN.source||(0,o.gR)(e,n)||n.PATTERN===Z.NA||(e.push(n),t.push(n)),t}),[])}));r=(0,o.oE)(r);var n=(0,o.pb)(r,(function(t){return t.length>1})),a=(0,o.Tj)(n,(function(t){var e=(0,o.Tj)(t,(function(t){return t.name}));return{message:"The same RegExp pattern ->"+(0,o.$1)(t).PATTERN+"<-has been used in all of the following Token Types: "+e.join(", ")+" <-",type:X.DUPLICATE_PATTERNS_FOUND,tokenTypes:t}}));return a}(r)),e=e.concat(function(t){var e=(0,o.pb)(t,(function(t){return t[R].test("")})),r=(0,o.Tj)(e,(function(t){return{message:"Token Type: ->"+t.name+"<- static 'PATTERN' must not match an empty string",type:X.EMPTY_MATCH_PATTERN,tokenTypes:[t]}}));return r}(r)),e}(c)),r=r.concat(function(t){var e=(0,o.pb)(t,(function(t){if(!(0,o.zy)(t,"GROUP"))return!1;var e=t.GROUP;return e!==Z.SKIPPED&&e!==Z.NA&&!(0,o.Kg)(e)})),r=(0,o.Tj)(e,(function(t){return{message:"Token Type: ->"+t.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:X.INVALID_GROUP_TYPE_FOUND,tokenTypes:[t]}}));return r}(c)),r=r.concat(function(t,e){var r=(0,o.pb)(t,(function(t){return void 0!==t.PUSH_MODE&&!(0,o.gR)(e,t.PUSH_MODE)})),n=(0,o.Tj)(r,(function(t){return{message:"Token Type: ->"+t.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+t.PUSH_MODE+"<-which does not exist",type:X.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[t]}}));return n}(c,e)),r=r.concat(function(t){var e=[],r=(0,o.TS)(t,(function(t,e,r){var n,a,i=e.PATTERN;return i===Z.NA||((0,o.Kg)(i)?t.push({str:i,idx:r,tokenType:e}):(0,o.gd)(i)&&(n=i,a=[".","\\","[","]","|","^","$","(",")","?","*","+","{"],void 0===(0,o.I6)(a,(function(t){return-1!==n.source.indexOf(t)})))&&t.push({str:i.source,idx:r,tokenType:e})),t}),[]);return(0,o.jJ)(t,(function(t,n){(0,o.jJ)(r,(function(r){var a=r.str,i=r.idx,c=r.tokenType;if(n<i&&function(t,e){if((0,o.gd)(e)){var r=e.exec(t);return null!==r&&0===r.index}if((0,o.Tn)(e))return e(t,0,[],{});if((0,o.zy)(e,"exec"))return e.exec(t,0,[],{});if("string"==typeof e)return e===t;throw Error("non exhaustive match")}(a,t.PATTERN)){var s="Token: ->"+c.name+"<- can never be matched.\nBecause it appears AFTER the Token Type ->"+t.name+"<-in the lexer's definition.\nSee https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE";e.push({message:s,type:X.UNREACHABLE_PATTERN,tokenTypes:[t,c]})}}))})),e}(c)),r}var I=/[^\\][\$]/;var S=/[^\\[][\^]|^\^/;function C(t){var e=t.ignoreCase?"i":"";return new RegExp("^(?:"+t.source+")",e)}function b(t){var e=t.ignoreCase?"iy":"y";return new RegExp(""+t.source,e)}function U(t,e,r){var n=[],a=!1,i=(0,o.oE)((0,o.Bq)((0,o.LG)(t.modes,(function(t){return t})))),c=(0,o.ku)(i,(function(t){return t[R]===Z.NA})),s=P(r);return e&&(0,o.jJ)(c,(function(t){var e=k(t,s);if(!1!==e){var r=function(t,e){if(e.issue===X.IDENTIFY_TERMINATOR)return"Warning: unable to identify line terminator usage in pattern.\n\tThe problem is in the <"+t.name+"> Token Type\n\t Root cause: "+e.errMsg+".\n\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(e.issue===X.CUSTOM_LINE_BREAK)return"Warning: A Custom Token Pattern should specify the <line_breaks> option.\n\tThe problem is in the <"+t.name+"> Token Type\n\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}(t,e),i={message:r,type:e.issue,tokenType:t};n.push(i)}else(0,o.zy)(t,"LINE_BREAKS")?!0===t.LINE_BREAKS&&(a=!0):y(s,t.PATTERN)&&(a=!0)})),e&&!a&&n.push({message:"Warning: No LINE_BREAKS Found.\n\tThis Lexer has been defined to track line and column information,\n\tBut none of the Token Types can be identified as matching a line terminator.\n\tSee https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS \n\tfor details.",type:X.NO_LINE_BREAKS_FLAGS}),n}function x(t){var e=t.PATTERN;if((0,o.gd)(e))return!1;if((0,o.Tn)(e))return!0;if((0,o.zy)(e,"exec"))return!0;if((0,o.Kg)(e))return!1;throw Error("non exhaustive match")}function L(t){return!(!(0,o.Kg)(t)||1!==t.length)&&t.charCodeAt(0)}var _={test:function(t){for(var e=t.length,r=this.lastIndex;r<e;r++){var n=t.charCodeAt(r);if(10===n)return this.lastIndex=r+1,!0;if(13===n)return 10===t.charCodeAt(r+1)?this.lastIndex=r+2:this.lastIndex=r+1,!0}return!1},lastIndex:0};function k(t,e){if((0,o.zy)(t,"LINE_BREAKS"))return!1;if((0,o.gd)(t.PATTERN)){try{y(e,t.PATTERN)}catch(r){return{issue:X.IDENTIFY_TERMINATOR,errMsg:r.message}}return!1}if((0,o.Kg)(t.PATTERN))return!1;if(x(t))return{issue:X.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}function P(t){return(0,o.Tj)(t,(function(t){return(0,o.Kg)(t)&&t.length>0?t.charCodeAt(0):t}))}function B(t,e,r){void 0===t[e]?t[e]=[r]:t[e].push(r)}var D=256;function F(t){return t<D?t:j[t]}var j=[];function V(t,e){var r=t.tokenTypeIdx;return r===e.tokenTypeIdx||!0===e.isParent&&!0===e.categoryMatchesMap[r]}function G(t,e){return t.tokenTypeIdx===e.tokenTypeIdx}var z=1,H={};function W(t){var e=function(t){var e=(0,o.T9)(t),r=t,n=!0;for(;n;){r=(0,o.oE)((0,o.Bq)((0,o.Tj)(r,(function(t){return t.CATEGORIES}))));var a=(0,o.iv)(r,e);e=e.concat(a),(0,o.Im)(a)?n=!1:r=a}return e}(t);!function(t){(0,o.jJ)(t,(function(t){var e;K(t)||(H[z]=t,t.tokenTypeIdx=z++),q(t)&&!(0,o.cy)(t.CATEGORIES)&&(t.CATEGORIES=[t.CATEGORIES]),q(t)||(t.CATEGORIES=[]),e=t,(0,o.zy)(e,"categoryMatches")||(t.categoryMatches=[]),function(t){return(0,o.zy)(t,"categoryMatchesMap")}(t)||(t.categoryMatchesMap={})}))}(e),function(t){(0,o.jJ)(t,(function(t){Y([],t)}))}(e),function(t){(0,o.jJ)(t,(function(t){t.categoryMatches=[],(0,o.jJ)(t.categoryMatchesMap,(function(e,r){t.categoryMatches.push(H[r].tokenTypeIdx)}))}))}(e),(0,o.jJ)(e,(function(t){t.isParent=t.categoryMatches.length>0}))}function Y(t,e){(0,o.jJ)(t,(function(t){e.categoryMatchesMap[t.tokenTypeIdx]=!0})),(0,o.jJ)(e.CATEGORIES,(function(r){var n=t.concat(e);(0,o.gR)(n,r)||Y(n,r)}))}function K(t){return(0,o.zy)(t,"tokenTypeIdx")}function q(t){return(0,o.zy)(t,"CATEGORIES")}function $(t){return(0,o.zy)(t,"tokenTypeIdx")}var X,J={buildUnableToPopLexerModeMessage:function(t){return"Unable to pop Lexer Mode after encountering Token ->"+t.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(t,e,r,n,o){return"unexpected character: ->"+t.charAt(e)+"<- at offset: "+e+", skipped "+r+" characters."}};!function(t){t[t.MISSING_PATTERN=0]="MISSING_PATTERN",t[t.INVALID_PATTERN=1]="INVALID_PATTERN",t[t.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",t[t.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",t[t.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",t[t.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",t[t.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",t[t.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",t[t.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",t[t.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",t[t.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",t[t.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",t[t.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",t[t.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",t[t.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",t[t.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",t[t.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"}(X||(X={}));var Q={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:["\n","\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:J,traceInitPerf:!1,skipValidations:!1};Object.freeze(Q);var Z=function(){function t(t,e){var r=this;if(void 0===e&&(e=Q),this.lexerDefinition=t,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},"boolean"==typeof e)throw Error("The second argument to the Lexer constructor is now an ILexerConfig Object.\na boolean 2nd argument is no longer supported");this.config=(0,o.h1)(Q,e);var n=this.config.traceInitPerf;!0===n?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):"number"==typeof n&&(this.traceInitMaxIdent=n,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",(function(){var n,a=!0;r.TRACE_INIT("Lexer Config handling",(function(){if(r.config.lineTerminatorsPattern===Q.lineTerminatorsPattern)r.config.lineTerminatorsPattern=_;else if(r.config.lineTerminatorCharacters===Q.lineTerminatorCharacters)throw Error("Error: Missing <lineTerminatorCharacters> property on the Lexer config.\n\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS");if(e.safeMode&&e.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');r.trackStartLines=/full|onlyStart/i.test(r.config.positionTracking),r.trackEndLines=/full/i.test(r.config.positionTracking),(0,o.cy)(t)?((n={modes:{}}).modes[T]=(0,o.T9)(t),n[T]=T):(a=!1,n=(0,o.lR)(t))})),!1===r.config.skipValidations&&(r.TRACE_INIT("performRuntimeChecks",(function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(function(t){var e=[];return(0,o.zy)(t,T)||e.push({message:"A MultiMode Lexer cannot be initialized without a <"+T+"> property in its definition\n",type:X.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),(0,o.zy)(t,A)||e.push({message:"A MultiMode Lexer cannot be initialized without a <modes> property in its definition\n",type:X.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),(0,o.zy)(t,A)&&(0,o.zy)(t,T)&&!(0,o.zy)(t.modes,t.defaultMode)&&e.push({message:"A MultiMode Lexer cannot be initialized with a "+T+": <"+t.defaultMode+">which does not exist\n",type:X.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),(0,o.zy)(t,A)&&(0,o.jJ)(t.modes,(function(t,r){(0,o.jJ)(t,(function(t,n){(0,o.b0)(t)&&e.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:<"+r+"> at index: <"+n+">\n",type:X.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})}))})),e}(n,r.trackStartLines,r.config.lineTerminatorCharacters))})),r.TRACE_INIT("performWarningRuntimeChecks",(function(){r.lexerDefinitionWarning=r.lexerDefinitionWarning.concat(U(n,r.trackStartLines,r.config.lineTerminatorCharacters))}))),n.modes=n.modes?n.modes:{},(0,o.jJ)(n.modes,(function(t,e){n.modes[e]=(0,o.ku)(t,(function(t){return(0,o.b0)(t)}))}));var c=(0,o.HP)(n.modes);if((0,o.jJ)(n.modes,(function(t,n){r.TRACE_INIT("Mode: <"+n+"> processing",(function(){var a;(r.modes.push(n),!1===r.config.skipValidations&&r.TRACE_INIT("validatePatterns",(function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(O(t,c))})),(0,o.Im)(r.lexerDefinitionErrors))&&(W(t),r.TRACE_INIT("analyzeTokenTypes",(function(){a=w(t,{lineTerminatorCharacters:r.config.lineTerminatorCharacters,positionTracking:e.positionTracking,ensureOptimizations:e.ensureOptimizations,safeMode:e.safeMode,tracer:r.TRACE_INIT.bind(r)})})),r.patternIdxToConfig[n]=a.patternIdxToConfig,r.charCodeToPatternIdxToConfig[n]=a.charCodeToPatternIdxToConfig,r.emptyGroups=(0,o.h1)(r.emptyGroups,a.emptyGroups),r.hasCustom=a.hasCustom||r.hasCustom,r.canModeBeOptimized[n]=a.canBeOptimized)}))})),r.defaultMode=n.defaultMode,!(0,o.Im)(r.lexerDefinitionErrors)&&!r.config.deferDefinitionErrorsHandling){var s=(0,o.Tj)(r.lexerDefinitionErrors,(function(t){return t.message})).join("-----------------------\n");throw new Error("Errors detected in definition of Lexer:\n"+s)}(0,o.jJ)(r.lexerDefinitionWarning,(function(t){(0,o.x5)(t.message)})),r.TRACE_INIT("Choosing sub-methods implementations",(function(){if(M?(r.chopInput=o.zK,r.match=r.matchWithTest):(r.updateLastIndex=o.tE,r.match=r.matchWithExec),a&&(r.handleModes=o.tE),!1===r.trackStartLines&&(r.computeNewColumn=o.zK),!1===r.trackEndLines&&(r.updateTokenEndLineColumnLocation=o.tE),/full/i.test(r.config.positionTracking))r.createTokenInstance=r.createFullToken;else if(/onlyStart/i.test(r.config.positionTracking))r.createTokenInstance=r.createStartOnlyToken;else{if(!/onlyOffset/i.test(r.config.positionTracking))throw Error('Invalid <positionTracking> config option: "'+r.config.positionTracking+'"');r.createTokenInstance=r.createOffsetOnlyToken}r.hasCustom?(r.addToken=r.addTokenUsingPush,r.handlePayload=r.handlePayloadWithCustom):(r.addToken=r.addTokenUsingMemberAccess,r.handlePayload=r.handlePayloadNoCustom)})),r.TRACE_INIT("Failed Optimization Warnings",(function(){var t=(0,o.TS)(r.canModeBeOptimized,(function(t,e,r){return!1===e&&t.push(r),t}),[]);if(e.ensureOptimizations&&!(0,o.Im)(t))throw Error("Lexer Modes: < "+t.join(", ")+' > cannot be optimized.\n\t Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.\n\t Or inspect the console log for details on how to resolve these issues.')})),r.TRACE_INIT("clearRegExpParserCache",(function(){i={}})),r.TRACE_INIT("toFastProperties",(function(){(0,o.Bl)(r)}))}))}return t.prototype.tokenize=function(t,e){if(void 0===e&&(e=this.defaultMode),!(0,o.Im)(this.lexerDefinitionErrors)){var r=(0,o.Tj)(this.lexerDefinitionErrors,(function(t){return t.message})).join("-----------------------\n");throw new Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+r)}return this.tokenizeInternal(t,e)},t.prototype.tokenizeInternal=function(t,e){var r,n,a,i,c,s,u,l,f,h,p,d,m,v,g,E,y,N=this,R=t,T=R.length,A=0,M=0,w=this.hasCustom?0:Math.floor(t.length/10),O=new Array(w),I=[],S=this.trackStartLines?1:void 0,C=this.trackStartLines?1:void 0,b=(g=this.emptyGroups,E={},y=(0,o.HP)(g),(0,o.jJ)(y,(function(t){var e=g[t];if(!(0,o.cy)(e))throw Error("non exhaustive match");E[t]=[]})),E),U=this.trackStartLines,x=this.config.lineTerminatorsPattern,L=0,_=[],k=[],P=[],B=[];Object.freeze(B);var D=void 0;function j(){return _}function V(t){var e=F(t),r=k[e];return void 0===r?B:r}var G,z=function(t){if(1===P.length&&void 0===t.tokenType.PUSH_MODE){var e=N.config.errorMessageProvider.buildUnableToPopLexerModeMessage(t);I.push({offset:t.startOffset,line:void 0!==t.startLine?t.startLine:void 0,column:void 0!==t.startColumn?t.startColumn:void 0,length:t.image.length,message:e})}else{P.pop();var r=(0,o.HV)(P);_=N.patternIdxToConfig[r],k=N.charCodeToPatternIdxToConfig[r],L=_.length;var n=N.canModeBeOptimized[r]&&!1===N.config.safeMode;D=k&&n?V:j}};function H(t){P.push(t),k=this.charCodeToPatternIdxToConfig[t],_=this.patternIdxToConfig[t],L=_.length,L=_.length;var e=this.canModeBeOptimized[t]&&!1===this.config.safeMode;D=k&&e?V:j}for(H.call(this,e);A<T;){c=null;var W=R.charCodeAt(A),Y=D(W),K=Y.length;for(r=0;r<K;r++){var q=(G=Y[r]).pattern;if(s=null,!1!==(ot=G.short)?W===ot&&(c=q):!0===G.isCustom?null!==(v=q.exec(R,A,O,b))?(c=v[0],void 0!==v.payload&&(s=v.payload)):c=null:(this.updateLastIndex(q,A),c=this.match(q,t,A)),null!==c){if(void 0!==(i=G.longerAlt)){var $=_[i],X=$.pattern;u=null,!0===$.isCustom?null!==(v=X.exec(R,A,O,b))?(a=v[0],void 0!==v.payload&&(u=v.payload)):a=null:(this.updateLastIndex(X,A),a=this.match(X,t,A)),a&&a.length>c.length&&(c=a,s=u,G=$)}break}}if(null!==c){if(l=c.length,void 0!==(f=G.group)&&(h=G.tokenTypeIdx,p=this.createTokenInstance(c,A,h,G.tokenType,S,C,l),this.handlePayload(p,s),!1===f?M=this.addToken(O,M,p):b[f].push(p)),t=this.chopInput(t,l),A+=l,C=this.computeNewColumn(C,l),!0===U&&!0===G.canLineTerminator){var J=0,Q=void 0,Z=void 0;x.lastIndex=0;do{!0===(Q=x.test(c))&&(Z=x.lastIndex-1,J++)}while(!0===Q);0!==J&&(S+=J,C=l-Z,this.updateTokenEndLineColumnLocation(p,f,Z,J,S,C,l))}this.handleModes(G,z,H,p)}else{for(var tt=A,et=S,rt=C,nt=!1;!nt&&A<T;)for(R.charCodeAt(A),t=this.chopInput(t,1),A++,n=0;n<L;n++){var ot,at=_[n];q=at.pattern;if(!1!==(ot=at.short)?R.charCodeAt(A)===ot&&(nt=!0):!0===at.isCustom?nt=null!==q.exec(R,A,O,b):(this.updateLastIndex(q,A),nt=null!==q.exec(t)),!0===nt)break}d=A-tt,m=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(R,tt,d,et,rt),I.push({offset:tt,line:et,column:rt,length:d,message:m})}}return this.hasCustom||(O.length=M),{tokens:O,groups:b,errors:I}},t.prototype.handleModes=function(t,e,r,n){if(!0===t.pop){var o=t.push;e(n),void 0!==o&&r.call(this,o)}else void 0!==t.push&&r.call(this,t.push)},t.prototype.chopInput=function(t,e){return t.substring(e)},t.prototype.updateLastIndex=function(t,e){t.lastIndex=e},t.prototype.updateTokenEndLineColumnLocation=function(t,e,r,n,o,a,i){var c,s;void 0!==e&&(s=(c=r===i-1)?-1:0,1===n&&!0===c||(t.endLine=o+s,t.endColumn=a-1-s))},t.prototype.computeNewColumn=function(t,e){return t+e},t.prototype.createTokenInstance=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return null},t.prototype.createOffsetOnlyToken=function(t,e,r,n){return{image:t,startOffset:e,tokenTypeIdx:r,tokenType:n}},t.prototype.createStartOnlyToken=function(t,e,r,n,o,a){return{image:t,startOffset:e,startLine:o,startColumn:a,tokenTypeIdx:r,tokenType:n}},t.prototype.createFullToken=function(t,e,r,n,o,a,i){return{image:t,startOffset:e,endOffset:e+i-1,startLine:o,endLine:o,startColumn:a,endColumn:a+i-1,tokenTypeIdx:r,tokenType:n}},t.prototype.addToken=function(t,e,r){return 666},t.prototype.addTokenUsingPush=function(t,e,r){return t.push(r),e},t.prototype.addTokenUsingMemberAccess=function(t,e,r){return t[e]=r,++e},t.prototype.handlePayload=function(t,e){},t.prototype.handlePayloadNoCustom=function(t,e){},t.prototype.handlePayloadWithCustom=function(t,e){null!==e&&(t.payload=e)},t.prototype.match=function(t,e,r){return null},t.prototype.matchWithTest=function(t,e,r){return!0===t.test(e)?e.substring(r,t.lastIndex):null},t.prototype.matchWithExec=function(t,e){var r=t.exec(e);return null!==r?r[0]:r},t.prototype.TRACE_INIT=function(t,e){if(!0===this.traceInitPerf){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--\x3e <"+t+">");var n=(0,o.O1)(e),a=n.time,i=n.value,c=a>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&c(r+"<-- <"+t+"> time: "+a+"ms"),this.traceInitIndent--,i}return e()},t.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",t.NA=/NOT_APPLICABLE/,t}();function tt(t){return rt(t)?t.LABEL:t.name}function et(t){return t.name}function rt(t){return(0,o.Kg)(t.LABEL)&&""!==t.LABEL}var nt="parent",ot="categories",at="label",it="group",ct="push_mode",st="pop_mode",ut="longer_alt",lt="line_breaks",ft="start_chars_hint";function ht(t){return function(t){var e=t.pattern,r={};r.name=t.name,(0,o.b0)(e)||(r.PATTERN=e);if((0,o.zy)(t,nt))throw"The parent property is no longer supported.\nSee: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.";(0,o.zy)(t,ot)&&(r.CATEGORIES=t[ot]);W([r]),(0,o.zy)(t,at)&&(r.LABEL=t[at]);(0,o.zy)(t,it)&&(r.GROUP=t[it]);(0,o.zy)(t,st)&&(r.POP_MODE=t[st]);(0,o.zy)(t,ct)&&(r.PUSH_MODE=t[ct]);(0,o.zy)(t,ut)&&(r.LONGER_ALT=t[ut]);(0,o.zy)(t,lt)&&(r.LINE_BREAKS=t[lt]);(0,o.zy)(t,ft)&&(r.START_CHARS_HINT=t[ft]);return r}(t)}var pt=ht({name:"EOF",pattern:Z.NA});function dt(t,e,r,n,o,a,i,c){return{image:e,startOffset:r,endOffset:n,startLine:o,endLine:a,startColumn:i,endColumn:c,tokenTypeIdx:t.tokenTypeIdx,tokenType:t}}function mt(t,e){return V(t,e)}W([pt]);var vt=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),gt=function(){function t(t){this._definition=t}return Object.defineProperty(t.prototype,"definition",{get:function(){return this._definition},set:function(t){this._definition=t},enumerable:!1,configurable:!0}),t.prototype.accept=function(t){t.visit(this),(0,o.jJ)(this.definition,(function(e){e.accept(t)}))},t}(),Et=function(t){function e(e){var r=t.call(this,[])||this;return r.idx=1,(0,o.kp)(r,(0,o.Up)(e,(function(t){return void 0!==t}))),r}return vt(e,t),Object.defineProperty(e.prototype,"definition",{get:function(){return void 0!==this.referencedRule?this.referencedRule.definition:[]},set:function(t){},enumerable:!1,configurable:!0}),e.prototype.accept=function(t){t.visit(this)},e}(gt),yt=function(t){function e(e){var r=t.call(this,e.definition)||this;return r.orgText="",(0,o.kp)(r,(0,o.Up)(e,(function(t){return void 0!==t}))),r}return vt(e,t),e}(gt),Nt=function(t){function e(e){var r=t.call(this,e.definition)||this;return r.ignoreAmbiguities=!1,(0,o.kp)(r,(0,o.Up)(e,(function(t){return void 0!==t}))),r}return vt(e,t),e}(gt),Rt=function(t){function e(e){var r=t.call(this,e.definition)||this;return r.idx=1,(0,o.kp)(r,(0,o.Up)(e,(function(t){return void 0!==t}))),r}return vt(e,t),e}(gt),Tt=function(t){function e(e){var r=t.call(this,e.definition)||this;return r.idx=1,(0,o.kp)(r,(0,o.Up)(e,(function(t){return void 0!==t}))),r}return vt(e,t),e}(gt),At=function(t){function e(e){var r=t.call(this,e.definition)||this;return r.idx=1,(0,o.kp)(r,(0,o.Up)(e,(function(t){return void 0!==t}))),r}return vt(e,t),e}(gt),Mt=function(t){function e(e){var r=t.call(this,e.definition)||this;return r.idx=1,(0,o.kp)(r,(0,o.Up)(e,(function(t){return void 0!==t}))),r}return vt(e,t),e}(gt),wt=function(t){function e(e){var r=t.call(this,e.definition)||this;return r.idx=1,(0,o.kp)(r,(0,o.Up)(e,(function(t){return void 0!==t}))),r}return vt(e,t),e}(gt),Ot=function(t){function e(e){var r=t.call(this,e.definition)||this;return r.idx=1,r.ignoreAmbiguities=!1,r.hasPredicates=!1,(0,o.kp)(r,(0,o.Up)(e,(function(t){return void 0!==t}))),r}return vt(e,t),Object.defineProperty(e.prototype,"definition",{get:function(){return this._definition},set:function(t){this._definition=t},enumerable:!1,configurable:!0}),e}(gt),It=function(){function t(t){this.idx=1,(0,o.kp)(this,(0,o.Up)(t,(function(t){return void 0!==t})))}return t.prototype.accept=function(t){t.visit(this)},t}();function St(t){return(0,o.Tj)(t,Ct)}function Ct(t){function e(t){return(0,o.Tj)(t,Ct)}if(t instanceof Et)return{type:"NonTerminal",name:t.nonTerminalName,idx:t.idx};if(t instanceof Nt)return{type:"Alternative",definition:e(t.definition)};if(t instanceof Rt)return{type:"Option",idx:t.idx,definition:e(t.definition)};if(t instanceof Tt)return{type:"RepetitionMandatory",idx:t.idx,definition:e(t.definition)};if(t instanceof At)return{type:"RepetitionMandatoryWithSeparator",idx:t.idx,separator:Ct(new It({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof wt)return{type:"RepetitionWithSeparator",idx:t.idx,separator:Ct(new It({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof Mt)return{type:"Repetition",idx:t.idx,definition:e(t.definition)};if(t instanceof Ot)return{type:"Alternation",idx:t.idx,definition:e(t.definition)};if(t instanceof It){var r={type:"Terminal",name:t.terminalType.name,label:tt(t.terminalType),idx:t.idx},n=t.terminalType.PATTERN;return t.terminalType.PATTERN&&(r.pattern=(0,o.gd)(n)?n.source:n),r}if(t instanceof yt)return{type:"Rule",name:t.name,orgText:t.orgText,definition:e(t.definition)};throw Error("non exhaustive match")}var bt=function(){function t(){}return t.prototype.walk=function(t,e){var r=this;void 0===e&&(e=[]),(0,o.jJ)(t.definition,(function(n,a){var i=(0,o.gv)(t.definition,a+1);if(n instanceof Et)r.walkProdRef(n,i,e);else if(n instanceof It)r.walkTerminal(n,i,e);else if(n instanceof Nt)r.walkFlat(n,i,e);else if(n instanceof Rt)r.walkOption(n,i,e);else if(n instanceof Tt)r.walkAtLeastOne(n,i,e);else if(n instanceof At)r.walkAtLeastOneSep(n,i,e);else if(n instanceof wt)r.walkManySep(n,i,e);else if(n instanceof Mt)r.walkMany(n,i,e);else{if(!(n instanceof Ot))throw Error("non exhaustive match");r.walkOr(n,i,e)}}))},t.prototype.walkTerminal=function(t,e,r){},t.prototype.walkProdRef=function(t,e,r){},t.prototype.walkFlat=function(t,e,r){var n=e.concat(r);this.walk(t,n)},t.prototype.walkOption=function(t,e,r){var n=e.concat(r);this.walk(t,n)},t.prototype.walkAtLeastOne=function(t,e,r){var n=[new Rt({definition:t.definition})].concat(e,r);this.walk(t,n)},t.prototype.walkAtLeastOneSep=function(t,e,r){var n=Ut(t,e,r);this.walk(t,n)},t.prototype.walkMany=function(t,e,r){var n=[new Rt({definition:t.definition})].concat(e,r);this.walk(t,n)},t.prototype.walkManySep=function(t,e,r){var n=Ut(t,e,r);this.walk(t,n)},t.prototype.walkOr=function(t,e,r){var n=this,a=e.concat(r);(0,o.jJ)(t.definition,(function(t){var e=new Nt({definition:[t]});n.walk(e,a)}))},t}();function Ut(t,e,r){return[new Rt({definition:[new It({terminalType:t.separator})].concat(t.definition)})].concat(e,r)}var xt=function(){function t(){}return t.prototype.visit=function(t){var e=t;switch(e.constructor){case Et:return this.visitNonTerminal(e);case Nt:return this.visitAlternative(e);case Rt:return this.visitOption(e);case Tt:return this.visitRepetitionMandatory(e);case At:return this.visitRepetitionMandatoryWithSeparator(e);case wt:return this.visitRepetitionWithSeparator(e);case Mt:return this.visitRepetition(e);case Ot:return this.visitAlternation(e);case It:return this.visitTerminal(e);case yt:return this.visitRule(e);default:throw Error("non exhaustive match")}},t.prototype.visitNonTerminal=function(t){},t.prototype.visitAlternative=function(t){},t.prototype.visitOption=function(t){},t.prototype.visitRepetition=function(t){},t.prototype.visitRepetitionMandatory=function(t){},t.prototype.visitRepetitionMandatoryWithSeparator=function(t){},t.prototype.visitRepetitionWithSeparator=function(t){},t.prototype.visitAlternation=function(t){},t.prototype.visitTerminal=function(t){},t.prototype.visitRule=function(t){},t}(),Lt=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function _t(t,e){return void 0===e&&(e=[]),!!(t instanceof Rt||t instanceof Mt||t instanceof wt)||(t instanceof Ot?(0,o.zN)(t.definition,(function(t){return _t(t,e)})):!(t instanceof Et&&(0,o.gR)(e,t))&&(t instanceof gt&&(t instanceof Et&&e.push(t),(0,o.Si)(t.definition,(function(t){return _t(t,e)})))))}function kt(t){if(t instanceof Et)return"SUBRULE";if(t instanceof Rt)return"OPTION";if(t instanceof Ot)return"OR";if(t instanceof Tt)return"AT_LEAST_ONE";if(t instanceof At)return"AT_LEAST_ONE_SEP";if(t instanceof wt)return"MANY_SEP";if(t instanceof Mt)return"MANY";if(t instanceof It)return"CONSUME";throw Error("non exhaustive match")}var Pt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.separator="-",e.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},e}return Lt(e,t),e.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},e.prototype.visitTerminal=function(t){var e=t.terminalType.name+this.separator+"Terminal";(0,o.zy)(this.dslMethods,e)||(this.dslMethods[e]=[]),this.dslMethods[e].push(t)},e.prototype.visitNonTerminal=function(t){var e=t.nonTerminalName+this.separator+"Terminal";(0,o.zy)(this.dslMethods,e)||(this.dslMethods[e]=[]),this.dslMethods[e].push(t)},e.prototype.visitOption=function(t){this.dslMethods.option.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.dslMethods.repetitionWithSeparator.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.dslMethods.repetitionMandatory.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.dslMethods.repetitionMandatoryWithSeparator.push(t)},e.prototype.visitRepetition=function(t){this.dslMethods.repetition.push(t)},e.prototype.visitAlternation=function(t){this.dslMethods.alternation.push(t)},e}(xt),Bt=new Pt;function Dt(t){if(t instanceof Et)return Dt(t.referencedRule);if(t instanceof It)return[t.terminalType];if(function(t){return t instanceof Nt||t instanceof Rt||t instanceof Mt||t instanceof Tt||t instanceof At||t instanceof wt||t instanceof It||t instanceof yt}(t))return function(t){var e,r=[],n=t.definition,a=0,i=n.length>a,c=!0;for(;i&&c;)c=_t(e=n[a]),r=r.concat(Dt(e)),a+=1,i=n.length>a;return(0,o.sb)(r)}(t);if(function(t){return t instanceof Ot}(t))return function(t){var e=(0,o.Tj)(t.definition,(function(t){return Dt(t)}));return(0,o.sb)((0,o.Bq)(e))}(t);throw Error("non exhaustive match")}var Ft="_~IN~_",jt=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Vt=function(t){function e(e){var r=t.call(this)||this;return r.topProd=e,r.follows={},r}return jt(e,t),e.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},e.prototype.walkTerminal=function(t,e,r){},e.prototype.walkProdRef=function(t,e,r){var n,o,a=(n=t.referencedRule,o=t.idx,n.name+o+Ft+this.topProd.name),i=e.concat(r),c=Dt(new Nt({definition:i}));this.follows[a]=c},e}(bt);var Gt={buildMismatchTokenMessage:function(t){var e=t.expected,r=t.actual;t.previous,t.ruleName;return"Expecting "+(rt(e)?"--\x3e "+tt(e)+" <--":"token of type --\x3e "+e.name+" <--")+" but found --\x3e '"+r.image+"' <--"},buildNotAllInputParsedMessage:function(t){var e=t.firstRedundant;t.ruleName;return"Redundant input, expecting EOF but found: "+e.image},buildNoViableAltMessage:function(t){var e=t.expectedPathsPerAlt,r=t.actual,n=(t.previous,t.customUserDescription),a=(t.ruleName,"Expecting: "),i="\nbut found: '"+(0,o.$1)(r).image+"'";if(n)return a+n+i;var c=(0,o.TS)(e,(function(t,e){return t.concat(e)}),[]),s=(0,o.Tj)(c,(function(t){return"["+(0,o.Tj)(t,(function(t){return tt(t)})).join(", ")+"]"}));return a+("one of these possible Token sequences:\n"+(0,o.Tj)(s,(function(t,e){return"  "+(e+1)+". "+t})).join("\n"))+i},buildEarlyExitMessage:function(t){var e=t.expectedIterationPaths,r=t.actual,n=t.customUserDescription,a=(t.ruleName,"Expecting: "),i="\nbut found: '"+(0,o.$1)(r).image+"'";return n?a+n+i:a+("expecting at least one iteration which starts with one of these possible Token sequences::\n  <"+(0,o.Tj)(e,(function(t){return"["+(0,o.Tj)(t,(function(t){return tt(t)})).join(",")+"]"})).join(" ,")+">")+i}};Object.freeze(Gt);var zt={buildRuleNotFoundError:function(t,e){return"Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+"<-\ninside top level rule: ->"+t.name+"<-"}},Ht={buildDuplicateFoundError:function(t,e){var r,n=t.name,a=(0,o.$1)(e),i=a.idx,c=kt(a),s=(r=a)instanceof It?r.terminalType.name:r instanceof Et?r.nonTerminalName:"",u="->"+c+(i>0?i:"")+"<- "+(s?"with argument: ->"+s+"<-":"")+"\n                  appears more than once ("+e.length+" times) in the top level rule: ->"+n+"<-.                  \n                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES \n                  ";return u=(u=u.replace(/[ \t]+/g," ")).replace(/\s\s+/g,"\n")},buildNamespaceConflictError:function(t){return"Namespace conflict found in grammar.\nThe grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+t.name+">.\nTo resolve this make sure each Terminal and Non-Terminal names are unique\nThis is easy to accomplish by using the convention that Terminal names start with an uppercase letter\nand Non-Terminal names start with a lower case letter."},buildAlternationPrefixAmbiguityError:function(t){var e=(0,o.Tj)(t.prefixPath,(function(t){return tt(t)})).join(", "),r=0===t.alternation.idx?"":t.alternation.idx;return"Ambiguous alternatives: <"+t.ambiguityIndices.join(" ,")+"> due to common lookahead prefix\nin <OR"+r+"> inside <"+t.topLevelRule.name+"> Rule,\n<"+e+"> may appears as a prefix path in all these alternatives.\nSee: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX\nFor Further details."},buildAlternationAmbiguityError:function(t){var e=(0,o.Tj)(t.prefixPath,(function(t){return tt(t)})).join(", "),r=0===t.alternation.idx?"":t.alternation.idx,n="Ambiguous Alternatives Detected: <"+t.ambiguityIndices.join(" ,")+"> in <OR"+r+"> inside <"+t.topLevelRule.name+"> Rule,\n<"+e+"> may appears as a prefix path in all these alternatives.\n";return n+="See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES\nFor Further details."},buildEmptyRepetitionError:function(t){var e=kt(t.repetition);return 0!==t.repetition.idx&&(e+=t.repetition.idx),"The repetition <"+e+"> within Rule <"+t.topLevelRule.name+"> can never consume any tokens.\nThis could lead to an infinite loop."},buildTokenNameError:function(t){return"deprecated"},buildEmptyAlternationError:function(t){return"Ambiguous empty alternative: <"+(t.emptyChoiceIdx+1)+"> in <OR"+t.alternation.idx+"> inside <"+t.topLevelRule.name+"> Rule.\nOnly the last alternative may be an empty alternative."},buildTooManyAlternativesError:function(t){return"An Alternation cannot have more than 256 alternatives:\n<OR"+t.alternation.idx+"> inside <"+t.topLevelRule.name+"> Rule.\n has "+(t.alternation.definition.length+1)+" alternatives."},buildLeftRecursionError:function(t){var e=t.topLevelRule.name;return"Left Recursion found in grammar.\nrule: <"+e+"> can be invoked from itself (directly or indirectly)\nwithout consuming any Tokens. The grammar path that causes this is: \n "+(e+" --\x3e "+o.Tj(t.leftRecursionPath,(function(t){return t.name})).concat([e]).join(" --\x3e "))+"\n To fix this refactor your grammar to remove the left recursion.\nsee: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring."},buildInvalidRuleNameError:function(t){return"deprecated"},buildDuplicateRuleNameError:function(t){return"Duplicate definition, rule: ->"+(t.topLevelRule instanceof yt?t.topLevelRule.name:t.topLevelRule)+"<- is already defined in the grammar: ->"+t.grammarName+"<-"}},Wt=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();var Yt=function(t){function e(e,r){var n=t.call(this)||this;return n.nameToTopRule=e,n.errMsgProvider=r,n.errors=[],n}return Wt(e,t),e.prototype.resolveRefs=function(){var t=this;(0,o.jJ)((0,o.zu)(this.nameToTopRule),(function(e){t.currTopLevel=e,e.accept(t)}))},e.prototype.visitNonTerminal=function(t){var e=this.nameToTopRule[t.nonTerminalName];if(e)t.referencedRule=e;else{var r=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,t);this.errors.push({message:r,type:Mr.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:t.nonTerminalName})}},e}(xt),Kt=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),qt=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.path=r,n.nextTerminalName="",n.nextTerminalOccurrence=0,n.nextTerminalName=n.path.lastTok.name,n.nextTerminalOccurrence=n.path.lastTokOccurrence,n}return Kt(e,t),e.prototype.walkTerminal=function(t,e,r){if(this.isAtEndOfPath&&t.terminalType.name===this.nextTerminalName&&t.idx===this.nextTerminalOccurrence&&!this.found){var n=e.concat(r),o=new Nt({definition:n});this.possibleTokTypes=Dt(o),this.found=!0}},e}(function(t){function e(e,r){var n=t.call(this)||this;return n.topProd=e,n.path=r,n.possibleTokTypes=[],n.nextProductionName="",n.nextProductionOccurrence=0,n.found=!1,n.isAtEndOfPath=!1,n}return Kt(e,t),e.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=(0,o.T9)(this.path.ruleStack).reverse(),this.occurrenceStack=(0,o.T9)(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},e.prototype.walk=function(e,r){void 0===r&&(r=[]),this.found||t.prototype.walk.call(this,e,r)},e.prototype.walkProdRef=function(t,e,r){if(t.referencedRule.name===this.nextProductionName&&t.idx===this.nextProductionOccurrence){var n=e.concat(r);this.updateExpectedNext(),this.walk(t.referencedRule,n)}},e.prototype.updateExpectedNext=function(){(0,o.Im)(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},e}(bt)),$t=function(t){function e(e,r){var n=t.call(this)||this;return n.topRule=e,n.occurrence=r,n.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},n}return Kt(e,t),e.prototype.startWalking=function(){return this.walk(this.topRule),this.result},e}(bt),Xt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Kt(e,t),e.prototype.walkMany=function(e,r,n){if(e.idx===this.occurrence){var a=(0,o.$1)(r.concat(n));this.result.isEndOfRule=void 0===a,a instanceof It&&(this.result.token=a.terminalType,this.result.occurrence=a.idx)}else t.prototype.walkMany.call(this,e,r,n)},e}($t),Jt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Kt(e,t),e.prototype.walkManySep=function(e,r,n){if(e.idx===this.occurrence){var a=(0,o.$1)(r.concat(n));this.result.isEndOfRule=void 0===a,a instanceof It&&(this.result.token=a.terminalType,this.result.occurrence=a.idx)}else t.prototype.walkManySep.call(this,e,r,n)},e}($t),Qt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Kt(e,t),e.prototype.walkAtLeastOne=function(e,r,n){if(e.idx===this.occurrence){var a=(0,o.$1)(r.concat(n));this.result.isEndOfRule=void 0===a,a instanceof It&&(this.result.token=a.terminalType,this.result.occurrence=a.idx)}else t.prototype.walkAtLeastOne.call(this,e,r,n)},e}($t),Zt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Kt(e,t),e.prototype.walkAtLeastOneSep=function(e,r,n){if(e.idx===this.occurrence){var a=(0,o.$1)(r.concat(n));this.result.isEndOfRule=void 0===a,a instanceof It&&(this.result.token=a.terminalType,this.result.occurrence=a.idx)}else t.prototype.walkAtLeastOneSep.call(this,e,r,n)},e}($t);function te(t,e,r){void 0===r&&(r=[]),r=(0,o.T9)(r);var n=[],a=0;function i(i){var c=te(i.concat((0,o.gv)(t,a+1)),e,r);return n.concat(c)}for(;r.length<e&&a<t.length;){var c=t[a];if(c instanceof Nt)return i(c.definition);if(c instanceof Et)return i(c.definition);if(c instanceof Rt)n=i(c.definition);else{if(c instanceof Tt)return i(s=c.definition.concat([new Mt({definition:c.definition})]));if(c instanceof At)return i(s=[new Nt({definition:c.definition}),new Mt({definition:[new It({terminalType:c.separator})].concat(c.definition)})]);if(c instanceof wt){var s=c.definition.concat([new Mt({definition:[new It({terminalType:c.separator})].concat(c.definition)})]);n=i(s)}else if(c instanceof Mt){s=c.definition.concat([new Mt({definition:c.definition})]);n=i(s)}else{if(c instanceof Ot)return(0,o.jJ)(c.definition,(function(t){!1===(0,o.Im)(t.definition)&&(n=i(t.definition))})),n;if(!(c instanceof It))throw Error("non exhaustive match");r.push(c.terminalType)}}a++}return n.push({partialPath:r,suffixDef:(0,o.gv)(t,a)}),n}function ee(t,e,r,n){var a="EXIT_NONE_TERMINAL",i=[a],c="EXIT_ALTERNATIVE",s=!1,u=e.length,l=u-n-1,f=[],h=[];for(h.push({idx:-1,def:t,ruleStack:[],occurrenceStack:[]});!(0,o.Im)(h);){var p=h.pop();if(p!==c){var d=p.def,m=p.idx,v=p.ruleStack,g=p.occurrenceStack;if(!(0,o.Im)(d)){var E=d[0];if(E===a){var y={idx:m,def:(0,o.gv)(d),ruleStack:(0,o.gc)(v),occurrenceStack:(0,o.gc)(g)};h.push(y)}else if(E instanceof It)if(m<u-1){var N=m+1;if(r(e[N],E.terminalType)){y={idx:N,def:(0,o.gv)(d),ruleStack:v,occurrenceStack:g};h.push(y)}}else{if(m!==u-1)throw Error("non exhaustive match");f.push({nextTokenType:E.terminalType,nextTokenOccurrence:E.idx,ruleStack:v,occurrenceStack:g}),s=!0}else if(E instanceof Et){var R=(0,o.T9)(v);R.push(E.nonTerminalName);var T=(0,o.T9)(g);T.push(E.idx);y={idx:m,def:E.definition.concat(i,(0,o.gv)(d)),ruleStack:R,occurrenceStack:T};h.push(y)}else if(E instanceof Rt){var A={idx:m,def:(0,o.gv)(d),ruleStack:v,occurrenceStack:g};h.push(A),h.push(c);var M={idx:m,def:E.definition.concat((0,o.gv)(d)),ruleStack:v,occurrenceStack:g};h.push(M)}else if(E instanceof Tt){var w=new Mt({definition:E.definition,idx:E.idx});y={idx:m,def:E.definition.concat([w],(0,o.gv)(d)),ruleStack:v,occurrenceStack:g};h.push(y)}else if(E instanceof At){var O=new It({terminalType:E.separator});w=new Mt({definition:[O].concat(E.definition),idx:E.idx}),y={idx:m,def:E.definition.concat([w],(0,o.gv)(d)),ruleStack:v,occurrenceStack:g};h.push(y)}else if(E instanceof wt){A={idx:m,def:(0,o.gv)(d),ruleStack:v,occurrenceStack:g};h.push(A),h.push(c);O=new It({terminalType:E.separator});var I=new Mt({definition:[O].concat(E.definition),idx:E.idx});M={idx:m,def:E.definition.concat([I],(0,o.gv)(d)),ruleStack:v,occurrenceStack:g};h.push(M)}else if(E instanceof Mt){A={idx:m,def:(0,o.gv)(d),ruleStack:v,occurrenceStack:g};h.push(A),h.push(c);I=new Mt({definition:E.definition,idx:E.idx}),M={idx:m,def:E.definition.concat([I],(0,o.gv)(d)),ruleStack:v,occurrenceStack:g};h.push(M)}else if(E instanceof Ot)for(var S=E.definition.length-1;S>=0;S--){var C={idx:m,def:E.definition[S].definition.concat((0,o.gv)(d)),ruleStack:v,occurrenceStack:g};h.push(C),h.push(c)}else if(E instanceof Nt)h.push({idx:m,def:E.definition.concat((0,o.gv)(d)),ruleStack:v,occurrenceStack:g});else{if(!(E instanceof yt))throw Error("non exhaustive match");h.push(re(E,m,v,g))}}}else s&&(0,o.HV)(h).idx<=l&&h.pop()}return f}function re(t,e,r,n){var a=(0,o.T9)(r);a.push(t.name);var i=(0,o.T9)(n);return i.push(1),{idx:e,def:t.definition,ruleStack:a,occurrenceStack:i}}var ne,oe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();!function(t){t[t.OPTION=0]="OPTION",t[t.REPETITION=1]="REPETITION",t[t.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",t[t.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",t[t.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",t[t.ALTERNATION=5]="ALTERNATION"}(ne||(ne={}));var ae=function(t){function e(e,r,n){var o=t.call(this)||this;return o.topProd=e,o.targetOccurrence=r,o.targetProdType=n,o}return oe(e,t),e.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},e.prototype.checkIsTarget=function(t,e,r,n){return t.idx===this.targetOccurrence&&this.targetProdType===e&&(this.restDef=r.concat(n),!0)},e.prototype.walkOption=function(e,r,n){this.checkIsTarget(e,ne.OPTION,r,n)||t.prototype.walkOption.call(this,e,r,n)},e.prototype.walkAtLeastOne=function(e,r,n){this.checkIsTarget(e,ne.REPETITION_MANDATORY,r,n)||t.prototype.walkOption.call(this,e,r,n)},e.prototype.walkAtLeastOneSep=function(e,r,n){this.checkIsTarget(e,ne.REPETITION_MANDATORY_WITH_SEPARATOR,r,n)||t.prototype.walkOption.call(this,e,r,n)},e.prototype.walkMany=function(e,r,n){this.checkIsTarget(e,ne.REPETITION,r,n)||t.prototype.walkOption.call(this,e,r,n)},e.prototype.walkManySep=function(e,r,n){this.checkIsTarget(e,ne.REPETITION_WITH_SEPARATOR,r,n)||t.prototype.walkOption.call(this,e,r,n)},e}(bt),ie=function(t){function e(e,r,n){var o=t.call(this)||this;return o.targetOccurrence=e,o.targetProdType=r,o.targetRef=n,o.result=[],o}return oe(e,t),e.prototype.checkIsTarget=function(t,e){t.idx!==this.targetOccurrence||this.targetProdType!==e||void 0!==this.targetRef&&t!==this.targetRef||(this.result=t.definition)},e.prototype.visitOption=function(t){this.checkIsTarget(t,ne.OPTION)},e.prototype.visitRepetition=function(t){this.checkIsTarget(t,ne.REPETITION)},e.prototype.visitRepetitionMandatory=function(t){this.checkIsTarget(t,ne.REPETITION_MANDATORY)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.checkIsTarget(t,ne.REPETITION_MANDATORY_WITH_SEPARATOR)},e.prototype.visitRepetitionWithSeparator=function(t){this.checkIsTarget(t,ne.REPETITION_WITH_SEPARATOR)},e.prototype.visitAlternation=function(t){this.checkIsTarget(t,ne.ALTERNATION)},e}(xt);function ce(t){for(var e=new Array(t),r=0;r<t;r++)e[r]=[];return e}function se(t){for(var e=[""],r=0;r<t.length;r++){for(var n=t[r],o=[],a=0;a<e.length;a++){var i=e[a];o.push(i+"_"+n.tokenTypeIdx);for(var c=0;c<n.categoryMatches.length;c++){var s="_"+n.categoryMatches[c];o.push(i+s)}}e=o}return e}function ue(t,e,r){for(var n=0;n<t.length;n++)if(n!==r)for(var o=t[n],a=0;a<e.length;a++){if(!0===o[e[a]])return!1}return!0}function le(t,e){for(var r=(0,o.Tj)(t,(function(t){return te([t],1)})),n=ce(r.length),a=(0,o.Tj)(r,(function(t){var e={};return(0,o.jJ)(t,(function(t){var r=se(t.partialPath);(0,o.jJ)(r,(function(t){e[t]=!0}))})),e})),i=r,c=1;c<=e;c++){var s=i;i=ce(s.length);for(var u=function(t){for(var r=s[t],u=0;u<r.length;u++){var l=r[u].partialPath,f=r[u].suffixDef,h=se(l);if(ue(a,h,t)||(0,o.Im)(f)||l.length===e){var p=n[t];if(!1===pe(p,l)){p.push(l);for(var d=0;d<h.length;d++){var m=h[d];a[t][m]=!0}}}else{var v=te(f,c+1,l);i[t]=i[t].concat(v),(0,o.jJ)(v,(function(e){var r=se(e.partialPath);(0,o.jJ)(r,(function(e){a[t][e]=!0}))}))}}},l=0;l<s.length;l++)u(l)}return n}function fe(t,e,r,n){var o=new ie(t,ne.ALTERNATION,n);return e.accept(o),le(o.result,r)}function he(t,e,r,n){var o=new ie(t,r);e.accept(o);var a=o.result,i=new ae(e,t,r).startWalking();return le([new Nt({definition:a}),new Nt({definition:i})],n)}function pe(t,e){t:for(var r=0;r<t.length;r++){var n=t[r];if(n.length===e.length){for(var o=0;o<n.length;o++){var a=e[o],i=n[o];if(!1===(a===i||void 0!==i.categoryMatchesMap[a.tokenTypeIdx]))continue t}return!0}}return!1}function de(t){return(0,o.Si)(t,(function(t){return(0,o.Si)(t,(function(t){return(0,o.Si)(t,(function(t){return(0,o.Im)(t.categoryMatches)}))}))}))}var me=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function ve(t,e,r,n,a){var i=o.Tj(t,(function(t){return function(t,e){var r=new ye;t.accept(r);var n=r.allProductions,a=o.$z(n,ge),i=o.Up(a,(function(t){return t.length>1})),c=o.Tj(o.zu(i),(function(r){var n=o.$1(r),a=e.buildDuplicateFoundError(t,r),i=kt(n),c={message:a,type:Mr.DUPLICATE_PRODUCTIONS,ruleName:t.name,dslName:i,occurrence:n.idx},s=Ee(n);return s&&(c.parameter=s),c}));return c}(t,n)})),c=o.Tj(t,(function(t){return Ne(t,t,n)})),s=[],u=[],l=[];(0,o.Si)(c,o.Im)&&(s=(0,o.Tj)(t,(function(t){return function(t,e){var r=new Te;t.accept(r);var n=r.alternations,a=o.TS(n,(function(r,n){var a=o.gc(n.definition),i=o.Tj(a,(function(r,a){var i=ee([r],[],null,1);return o.Im(i)?{message:e.buildEmptyAlternationError({topLevelRule:t,alternation:n,emptyChoiceIdx:a}),type:Mr.NONE_LAST_EMPTY_ALT,ruleName:t.name,occurrence:n.idx,alternative:a+1}:null}));return r.concat(o.oE(i))}),[]);return a}(t,n)})),u=(0,o.Tj)(t,(function(t){return function(t,e,r){var n=new Te;t.accept(n);var a=n.alternations;a=(0,o.ku)(a,(function(t){return!0===t.ignoreAmbiguities}));var i=o.TS(a,(function(n,a){var i=a.idx,c=a.maxLookahead||e,s=fe(i,t,c,a),u=function(t,e,r,n){var a=[],i=(0,o.TS)(t,(function(r,n,i){return!0===e.definition[i].ignoreAmbiguities||(0,o.jJ)(n,(function(n){var c=[i];(0,o.jJ)(t,(function(t,r){i!==r&&pe(t,n)&&!0!==e.definition[r].ignoreAmbiguities&&c.push(r)})),c.length>1&&!pe(a,n)&&(a.push(n),r.push({alts:c,path:n}))})),r}),[]),c=o.Tj(i,(function(t){var a=(0,o.Tj)(t.alts,(function(t){return t+1}));return{message:n.buildAlternationAmbiguityError({topLevelRule:r,alternation:e,ambiguityIndices:a,prefixPath:t.path}),type:Mr.AMBIGUOUS_ALTS,ruleName:r.name,occurrence:e.idx,alternatives:[t.alts]}}));return c}(s,a,t,r),l=function(t,e,r,n){var a=[],i=(0,o.TS)(t,(function(t,e,r){var n=(0,o.Tj)(e,(function(t){return{idx:r,path:t}}));return t.concat(n)}),[]);return(0,o.jJ)(i,(function(t){if(!0!==e.definition[t.idx].ignoreAmbiguities){var c=t.idx,s=t.path,u=(0,o.JW)(i,(function(t){return!0!==e.definition[t.idx].ignoreAmbiguities&&t.idx<c&&(r=t.path,n=s,r.length<n.length&&(0,o.Si)(r,(function(t,e){var r=n[e];return t===r||r.categoryMatchesMap[t.tokenTypeIdx]})));var r,n})),l=(0,o.Tj)(u,(function(t){var o=[t.idx+1,c+1],a=0===e.idx?"":e.idx;return{message:n.buildAlternationPrefixAmbiguityError({topLevelRule:r,alternation:e,ambiguityIndices:o,prefixPath:t.path}),type:Mr.AMBIGUOUS_PREFIX_ALTS,ruleName:r.name,occurrence:a,alternatives:o}}));a=a.concat(l)}})),a}(s,a,t,r);return n.concat(u,l)}),[]);return i}(t,e,n)})),l=function(t,e,r){var n=[];return(0,o.jJ)(t,(function(t){var a=new Ae;t.accept(a);var i=a.allProductions;(0,o.jJ)(i,(function(a){var i=function(t){if(t instanceof Rt)return ne.OPTION;if(t instanceof Mt)return ne.REPETITION;if(t instanceof Tt)return ne.REPETITION_MANDATORY;if(t instanceof At)return ne.REPETITION_MANDATORY_WITH_SEPARATOR;if(t instanceof wt)return ne.REPETITION_WITH_SEPARATOR;if(t instanceof Ot)return ne.ALTERNATION;throw Error("non exhaustive match")}(a),c=a.maxLookahead||e,s=he(a.idx,t,i,c)[0];if((0,o.Im)((0,o.Bq)(s))){var u=r.buildEmptyRepetitionError({topLevelRule:t,repetition:a});n.push({message:u,type:Mr.NO_NON_EMPTY_LOOKAHEAD,ruleName:t.name})}}))})),n}(t,e,n));var f=function(t,e,r){var n=[],a=(0,o.Tj)(e,(function(t){return t.name}));return(0,o.jJ)(t,(function(t){var e=t.name;if((0,o.gR)(a,e)){var i=r.buildNamespaceConflictError(t);n.push({message:i,type:Mr.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:e})}})),n}(t,r,n),h=(0,o.Tj)(t,(function(t){return function(t,e){var r=new Te;t.accept(r);var n=r.alternations,a=o.TS(n,(function(r,n){return n.definition.length>255&&r.push({message:e.buildTooManyAlternativesError({topLevelRule:t,alternation:n}),type:Mr.TOO_MANY_ALTS,ruleName:t.name,occurrence:n.idx}),r}),[]);return a}(t,n)})),p=(0,o.Tj)(t,(function(e){return function(t,e,r,n){var a=[],i=(0,o.TS)(e,(function(e,r){return r.name===t.name?e+1:e}),0);if(i>1){var c=n.buildDuplicateRuleNameError({topLevelRule:t,grammarName:r});a.push({message:c,type:Mr.DUPLICATE_RULE_NAME,ruleName:t.name})}return a}(e,t,a,n)}));return o.Bq(i.concat(l,c,s,u,f,h,p))}function ge(t){return kt(t)+"_#_"+t.idx+"_#_"+Ee(t)}function Ee(t){return t instanceof It?t.terminalType.name:t instanceof Et?t.nonTerminalName:""}var ye=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.allProductions=[],e}return me(e,t),e.prototype.visitNonTerminal=function(t){this.allProductions.push(t)},e.prototype.visitOption=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e.prototype.visitAlternation=function(t){this.allProductions.push(t)},e.prototype.visitTerminal=function(t){this.allProductions.push(t)},e}(xt);function Ne(t,e,r,n){void 0===n&&(n=[]);var a=[],i=Re(e.definition);if(o.Im(i))return[];var c=t.name;o.gR(i,t)&&a.push({message:r.buildLeftRecursionError({topLevelRule:t,leftRecursionPath:n}),type:Mr.LEFT_RECURSION,ruleName:c});var s=o.iv(i,n.concat([t])),u=o.Tj(s,(function(e){var a=o.T9(n);return a.push(e),Ne(t,e,r,a)}));return a.concat(o.Bq(u))}function Re(t){var e=[];if(o.Im(t))return e;var r=o.$1(t);if(r instanceof Et)e.push(r.referencedRule);else if(r instanceof Nt||r instanceof Rt||r instanceof Tt||r instanceof At||r instanceof wt||r instanceof Mt)e=e.concat(Re(r.definition));else if(r instanceof Ot)e=o.Bq(o.Tj(r.definition,(function(t){return Re(t.definition)})));else if(!(r instanceof It))throw Error("non exhaustive match");var n=_t(r),a=t.length>1;if(n&&a){var i=o.gv(t);return e.concat(Re(i))}return e}var Te=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.alternations=[],e}return me(e,t),e.prototype.visitAlternation=function(t){this.alternations.push(t)},e}(xt);var Ae=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.allProductions=[],e}return me(e,t),e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e}(xt);function Me(t){t=(0,o.NT)(t,{errMsgProvider:zt});var e,r,n,a={};return(0,o.jJ)(t.rules,(function(t){a[t.name]=t})),e=a,r=t.errMsgProvider,(n=new Yt(e,r)).resolveRefs(),n.errors}function we(t){return ve((t=(0,o.NT)(t,{errMsgProvider:Ht})).rules,t.maxLookahead,t.tokenTypes,t.errMsgProvider,t.grammarName)}function Oe(t){(0,o.jJ)(t.rules,(function(t){var e=new Pt;t.accept(e),(0,o.jJ)(e.dslMethods,(function(t){(0,o.jJ)(t,(function(t,e){t.idx=e+1}))}))}))}var Ie=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Se="MismatchedTokenException",Ce="NoViableAltException",be="EarlyExitException",Ue="NotAllInputParsedException",xe=[Se,Ce,be,Ue];function Le(t){return(0,o.gR)(xe,t.name)}Object.freeze(xe);var _e=function(t){function e(e,r){var n=this.constructor,o=t.call(this,e)||this;return o.token=r,o.resyncedTokens=[],Object.setPrototypeOf(o,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,o.constructor),o}return Ie(e,t),e}(Error),ke=function(t){function e(e,r,n){var o=t.call(this,e,r)||this;return o.previousToken=n,o.name=Se,o}return Ie(e,t),e}(_e),Pe=function(t){function e(e,r,n){var o=t.call(this,e,r)||this;return o.previousToken=n,o.name=Ce,o}return Ie(e,t),e}(_e),Be=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.name=Ue,n}return Ie(e,t),e}(_e),De=function(t){function e(e,r,n){var o=t.call(this,e,r)||this;return o.previousToken=n,o.name=be,o}return Ie(e,t),e}(_e),Fe={},je="InRuleRecoveryException";function Ve(t){this.name=je,this.message=t}Ve.prototype=Error.prototype;var Ge=function(){function t(){}return t.prototype.initRecoverable=function(t){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=(0,o.zy)(t,"recoveryEnabled")?t.recoveryEnabled:wr.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=ze)},t.prototype.getTokenToInsert=function(t){var e=dt(t,"",NaN,NaN,NaN,NaN,NaN,NaN);return e.isInsertedInRecovery=!0,e},t.prototype.canTokenTypeBeInsertedInRecovery=function(t){return!0},t.prototype.tryInRepetitionRecovery=function(t,e,r,n){for(var a=this,i=this.findReSyncTokenType(),c=this.exportLexerState(),s=[],u=!1,l=this.LA(1),f=this.LA(1),h=function(){var t=a.LA(0),e=a.errorMessageProvider.buildMismatchTokenMessage({expected:n,actual:l,previous:t,ruleName:a.getCurrRuleFullName()}),r=new ke(e,l,a.LA(0));r.resyncedTokens=(0,o.gc)(s),a.SAVE_ERROR(r)};!u;){if(this.tokenMatcher(f,n))return void h();if(r.call(this))return h(),void t.apply(this,e);this.tokenMatcher(f,i)?u=!0:(f=this.SKIP_TOKEN(),this.addToResyncTokens(f,s))}this.importLexerState(c)},t.prototype.shouldInRepetitionRecoveryBeTried=function(t,e,r){return!1!==r&&(void 0!==t&&void 0!==e&&(!this.tokenMatcher(this.LA(1),t)&&(!this.isBackTracking()&&!this.canPerformInRuleRecovery(t,this.getFollowsForInRuleRecovery(t,e)))))},t.prototype.getFollowsForInRuleRecovery=function(t,e){var r=this.getCurrentGrammarPath(t,e);return this.getNextPossibleTokenTypes(r)},t.prototype.tryInRuleRecovery=function(t,e){if(this.canRecoverWithSingleTokenInsertion(t,e))return this.getTokenToInsert(t);if(this.canRecoverWithSingleTokenDeletion(t)){var r=this.SKIP_TOKEN();return this.consumeToken(),r}throw new Ve("sad sad panda")},t.prototype.canPerformInRuleRecovery=function(t,e){return this.canRecoverWithSingleTokenInsertion(t,e)||this.canRecoverWithSingleTokenDeletion(t)},t.prototype.canRecoverWithSingleTokenInsertion=function(t,e){var r=this;if(!this.canTokenTypeBeInsertedInRecovery(t))return!1;if((0,o.Im)(e))return!1;var n=this.LA(1);return void 0!==(0,o.I6)(e,(function(t){return r.tokenMatcher(n,t)}))},t.prototype.canRecoverWithSingleTokenDeletion=function(t){return this.tokenMatcher(this.LA(2),t)},t.prototype.isInCurrentRuleReSyncSet=function(t){var e=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(e);return(0,o.gR)(r,t)},t.prototype.findReSyncTokenType=function(){for(var t=this.flattenFollowSet(),e=this.LA(1),r=2;;){var n=e.tokenType;if((0,o.gR)(t,n))return n;e=this.LA(r),r++}},t.prototype.getCurrFollowKey=function(){if(1===this.RULE_STACK.length)return Fe;var t=this.getLastExplicitRuleShortName(),e=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(t),idxInCallingRule:e,inRule:this.shortRuleNameToFullName(r)}},t.prototype.buildFullFollowKeyStack=function(){var t=this,e=this.RULE_STACK,r=this.RULE_OCCURRENCE_STACK;return(0,o.Tj)(e,(function(n,o){return 0===o?Fe:{ruleName:t.shortRuleNameToFullName(n),idxInCallingRule:r[o],inRule:t.shortRuleNameToFullName(e[o-1])}}))},t.prototype.flattenFollowSet=function(){var t=this,e=(0,o.Tj)(this.buildFullFollowKeyStack(),(function(e){return t.getFollowSetFromFollowKey(e)}));return(0,o.Bq)(e)},t.prototype.getFollowSetFromFollowKey=function(t){if(t===Fe)return[pt];var e=t.ruleName+t.idxInCallingRule+Ft+t.inRule;return this.resyncFollows[e]},t.prototype.addToResyncTokens=function(t,e){return this.tokenMatcher(t,pt)||e.push(t),e},t.prototype.reSyncTo=function(t){for(var e=[],r=this.LA(1);!1===this.tokenMatcher(r,t);)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,e);return(0,o.gc)(e)},t.prototype.attemptInRepetitionRecovery=function(t,e,r,n,o,a,i){},t.prototype.getCurrentGrammarPath=function(t,e){return{ruleStack:this.getHumanReadableRuleStack(),occurrenceStack:(0,o.T9)(this.RULE_OCCURRENCE_STACK),lastTok:t,lastTokOccurrence:e}},t.prototype.getHumanReadableRuleStack=function(){var t=this;return(0,o.Tj)(this.RULE_STACK,(function(e){return t.shortRuleNameToFullName(e)}))},t}();function ze(t,e,r,n,o,a,i){var c=this.getKeyForAutomaticLookahead(n,o),s=this.firstAfterRepMap[c];if(void 0===s){var u=this.getCurrRuleFullName();s=new a(this.getGAstProductions()[u],o).startWalking(),this.firstAfterRepMap[c]=s}var l=s.token,f=s.occurrence,h=s.isEndOfRule;1===this.RULE_STACK.length&&h&&void 0===l&&(l=pt,f=1),this.shouldInRepetitionRecoveryBeTried(l,f,i)&&this.tryInRepetitionRecovery(t,e,r,l)}var He=1024,We=1280,Ye=1536;function Ke(t,e,r){return r|e|t}var qe=function(){function t(){}return t.prototype.initLooksAhead=function(t){this.dynamicTokensEnabled=(0,o.zy)(t,"dynamicTokensEnabled")?t.dynamicTokensEnabled:wr.dynamicTokensEnabled,this.maxLookahead=(0,o.zy)(t,"maxLookahead")?t.maxLookahead:wr.maxLookahead,this.lookAheadFuncsCache=(0,o.rF)()?new Map:[],(0,o.rF)()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},t.prototype.preComputeLookaheadFunctions=function(t){var e=this;(0,o.jJ)(t,(function(t){e.TRACE_INIT(t.name+" Rule Lookahead",(function(){var r=function(t){Bt.reset(),t.accept(Bt);var e=Bt.dslMethods;return Bt.reset(),e}(t),n=r.alternation,a=r.repetition,i=r.option,c=r.repetitionMandatory,s=r.repetitionMandatoryWithSeparator,u=r.repetitionWithSeparator;(0,o.jJ)(n,(function(r){var n=0===r.idx?"":r.idx;e.TRACE_INIT(""+kt(r)+n,(function(){var n,o,a,i,c,s,u,l=(n=r.idx,o=t,a=r.maxLookahead||e.maxLookahead,i=r.hasPredicates,c=e.dynamicTokensEnabled,s=e.lookAheadBuilderForAlternatives,u=fe(n,o,a),s(u,i,de(u)?G:V,c)),f=Ke(e.fullRuleNameToShort[t.name],256,r.idx);e.setLaFuncCache(f,l)}))})),(0,o.jJ)(a,(function(r){e.computeLookaheadFunc(t,r.idx,768,ne.REPETITION,r.maxLookahead,kt(r))})),(0,o.jJ)(i,(function(r){e.computeLookaheadFunc(t,r.idx,512,ne.OPTION,r.maxLookahead,kt(r))})),(0,o.jJ)(c,(function(r){e.computeLookaheadFunc(t,r.idx,He,ne.REPETITION_MANDATORY,r.maxLookahead,kt(r))})),(0,o.jJ)(s,(function(r){e.computeLookaheadFunc(t,r.idx,Ye,ne.REPETITION_MANDATORY_WITH_SEPARATOR,r.maxLookahead,kt(r))})),(0,o.jJ)(u,(function(r){e.computeLookaheadFunc(t,r.idx,We,ne.REPETITION_WITH_SEPARATOR,r.maxLookahead,kt(r))}))}))}))},t.prototype.computeLookaheadFunc=function(t,e,r,n,o,a){var i=this;this.TRACE_INIT(""+a+(0===e?"":e),(function(){var a=function(t,e,r,n,o,a){var i=he(t,e,o,r),c=de(i)?G:V;return a(i[0],c,n)}(e,t,o||i.maxLookahead,i.dynamicTokensEnabled,n,i.lookAheadBuilderForOptional),c=Ke(i.fullRuleNameToShort[t.name],r,e);i.setLaFuncCache(c,a)}))},t.prototype.lookAheadBuilderForOptional=function(t,e,r){return function(t,e,r){var n=(0,o.Si)(t,(function(t){return 1===t.length})),a=t.length;if(n&&!r){var i=(0,o.Bq)(t);if(1===i.length&&(0,o.Im)(i[0].categoryMatches)){var c=i[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===c}}var s=(0,o.TS)(i,(function(t,e,r){return t[e.tokenTypeIdx]=!0,(0,o.jJ)(e.categoryMatches,(function(e){t[e]=!0})),t}),[]);return function(){var t=this.LA(1);return!0===s[t.tokenTypeIdx]}}return function(){t:for(var r=0;r<a;r++){for(var n=t[r],o=n.length,i=0;i<o;i++){var c=this.LA(i+1);if(!1===e(c,n[i]))continue t}return!0}return!1}}(t,e,r)},t.prototype.lookAheadBuilderForAlternatives=function(t,e,r,n){return function(t,e,r,n){var a=t.length,i=(0,o.Si)(t,(function(t){return(0,o.Si)(t,(function(t){return 1===t.length}))}));if(e)return function(e){for(var n=(0,o.Tj)(e,(function(t){return t.GATE})),i=0;i<a;i++){var c=t[i],s=c.length,u=n[i];if(void 0===u||!1!==u.call(this))t:for(var l=0;l<s;l++){for(var f=c[l],h=f.length,p=0;p<h;p++){var d=this.LA(p+1);if(!1===r(d,f[p]))continue t}return i}}};if(i&&!n){var c=(0,o.Tj)(t,(function(t){return(0,o.Bq)(t)})),s=(0,o.TS)(c,(function(t,e,r){return(0,o.jJ)(e,(function(e){(0,o.zy)(t,e.tokenTypeIdx)||(t[e.tokenTypeIdx]=r),(0,o.jJ)(e.categoryMatches,(function(e){(0,o.zy)(t,e)||(t[e]=r)}))})),t}),[]);return function(){var t=this.LA(1);return s[t.tokenTypeIdx]}}return function(){for(var e=0;e<a;e++){var n=t[e],o=n.length;t:for(var i=0;i<o;i++){for(var c=n[i],s=c.length,u=0;u<s;u++){var l=this.LA(u+1);if(!1===r(l,c[u]))continue t}return e}}}}(t,e,r,n)},t.prototype.getKeyForAutomaticLookahead=function(t,e){return Ke(this.getLastExplicitRuleShortName(),t,e)},t.prototype.getLaFuncFromCache=function(t){},t.prototype.getLaFuncFromMap=function(t){return this.lookAheadFuncsCache.get(t)},t.prototype.getLaFuncFromObj=function(t){return this.lookAheadFuncsCache[t]},t.prototype.setLaFuncCache=function(t,e){},t.prototype.setLaFuncCacheUsingMap=function(t,e){this.lookAheadFuncsCache.set(t,e)},t.prototype.setLaFuncUsingObj=function(t,e){this.lookAheadFuncsCache[t]=e},t}();function $e(t,e){!0===isNaN(t.startOffset)?(t.startOffset=e.startOffset,t.endOffset=e.endOffset):t.endOffset<e.endOffset==!0&&(t.endOffset=e.endOffset)}function Xe(t,e){!0===isNaN(t.startOffset)?(t.startOffset=e.startOffset,t.startColumn=e.startColumn,t.startLine=e.startLine,t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine):t.endOffset<e.endOffset==!0&&(t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine)}var Je,Qe="name";function Ze(t){var e=t.name;return e||"anonymous"}function tr(t,e){var r=Object.getOwnPropertyDescriptor(t,Qe);return!(!(0,o.b0)(r)&&!r.configurable)&&(Object.defineProperty(t,Qe,{enumerable:!1,configurable:!0,writable:!1,value:e}),!0)}function er(t,e){for(var r=(0,o.HP)(t),n=r.length,a=0;a<n;a++)for(var i=t[r[a]],c=i.length,s=0;s<c;s++){var u=i[s];void 0===u.tokenTypeIdx&&this[u.name](u.children,e)}}function rr(t,e){var r=function(){};tr(r,t+"BaseSemantics");var n={visit:function(t,e){if((0,o.cy)(t)&&(t=t[0]),!(0,o.b0)(t))return this[t.name](t.children,e)},validateVisitor:function(){var t=function(t,e){var r=function(t,e){var r=(0,o.Tj)(e,(function(e){if(!(0,o.Tn)(t[e]))return{msg:"Missing visitor method: <"+e+"> on "+Ze(t.constructor)+" CST Visitor.",type:Je.MISSING_METHOD,methodName:e}}));return(0,o.oE)(r)}(t,e),n=function(t,e){var r=[];for(var n in t)!(0,o.Tn)(t[n])||(0,o.gR)(nr,n)||(0,o.gR)(e,n)||r.push({msg:"Redundant visitor method: <"+n+"> on "+Ze(t.constructor)+" CST Visitor\nThere is no Grammar Rule corresponding to this method's name.\n",type:Je.REDUNDANT_METHOD,methodName:n});return r}(t,e);return r.concat(n)}(this,e);if(!(0,o.Im)(t)){var r=(0,o.Tj)(t,(function(t){return t.msg}));throw Error("Errors Detected in CST Visitor <"+Ze(this.constructor)+">:\n\t"+r.join("\n\n").replace(/\n/g,"\n\t"))}}};return(r.prototype=n).constructor=r,r._RULE_NAMES=e,r}!function(t){t[t.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",t[t.MISSING_METHOD=1]="MISSING_METHOD"}(Je||(Je={}));var nr=["constructor","visit","validateVisitor"];var or=function(){function t(){}return t.prototype.initTreeBuilder=function(t){if(this.CST_STACK=[],this.outputCst=t.outputCst,this.nodeLocationTracking=(0,o.zy)(t,"nodeLocationTracking")?t.nodeLocationTracking:wr.nodeLocationTracking,this.outputCst)if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Xe,this.setNodeLocationFromNode=Xe,this.cstPostRule=o.tE,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=o.tE,this.setNodeLocationFromNode=o.tE,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=$e,this.setNodeLocationFromNode=$e,this.cstPostRule=o.tE,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=o.tE,this.setNodeLocationFromNode=o.tE,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else{if(!/none/i.test(this.nodeLocationTracking))throw Error('Invalid <nodeLocationTracking> config option: "'+t.nodeLocationTracking+'"');this.setNodeLocationFromToken=o.tE,this.setNodeLocationFromNode=o.tE,this.cstPostRule=o.tE,this.setInitialNodeLocation=o.tE}else this.cstInvocationStateUpdate=o.tE,this.cstFinallyStateUpdate=o.tE,this.cstPostTerminal=o.tE,this.cstPostNonTerminal=o.tE,this.cstPostRule=o.tE},t.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(t){t.location={startOffset:NaN,endOffset:NaN}},t.prototype.setInitialNodeLocationOnlyOffsetRegular=function(t){t.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},t.prototype.setInitialNodeLocationFullRecovery=function(t){t.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},t.prototype.setInitialNodeLocationFullRegular=function(t){var e=this.LA(1);t.location={startOffset:e.startOffset,startLine:e.startLine,startColumn:e.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},t.prototype.cstInvocationStateUpdate=function(t,e){var r={name:t,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},t.prototype.cstFinallyStateUpdate=function(){this.CST_STACK.pop()},t.prototype.cstPostRuleFull=function(t){var e=this.LA(0),r=t.location;r.startOffset<=e.startOffset==!0?(r.endOffset=e.endOffset,r.endLine=e.endLine,r.endColumn=e.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)},t.prototype.cstPostRuleOnlyOffset=function(t){var e=this.LA(0),r=t.location;r.startOffset<=e.startOffset==!0?r.endOffset=e.endOffset:r.startOffset=NaN},t.prototype.cstPostTerminal=function(t,e){var r,n,o,a=this.CST_STACK[this.CST_STACK.length-1];n=e,o=t,void 0===(r=a).children[o]?r.children[o]=[n]:r.children[o].push(n),this.setNodeLocationFromToken(a.location,e)},t.prototype.cstPostNonTerminal=function(t,e){var r=this.CST_STACK[this.CST_STACK.length-1];!function(t,e,r){void 0===t.children[e]?t.children[e]=[r]:t.children[e].push(r)}(r,e,t),this.setNodeLocationFromNode(r.location,t.location)},t.prototype.getBaseCstVisitorConstructor=function(){if((0,o.b0)(this.baseCstVisitorConstructor)){var t=rr(this.className,(0,o.HP)(this.gastProductionsCache));return this.baseCstVisitorConstructor=t,t}return this.baseCstVisitorConstructor},t.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if((0,o.b0)(this.baseCstVisitorWithDefaultsConstructor)){var t=function(t,e,r){var n=function(){};tr(n,t+"BaseSemanticsWithDefaults");var a=Object.create(r.prototype);return(0,o.jJ)(e,(function(t){a[t]=er})),(n.prototype=a).constructor=n,n}(this.className,(0,o.HP)(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=t,t}return this.baseCstVisitorWithDefaultsConstructor},t.prototype.getLastExplicitRuleShortName=function(){var t=this.RULE_STACK;return t[t.length-1]},t.prototype.getPreviousExplicitRuleShortName=function(){var t=this.RULE_STACK;return t[t.length-2]},t.prototype.getLastExplicitRuleOccurrenceIndex=function(){var t=this.RULE_OCCURRENCE_STACK;return t[t.length-1]},t}(),ar=function(){function t(){}return t.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(t.prototype,"input",{get:function(){return this.tokVector},set:function(t){if(!0!==this.selfAnalysisDone)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=t,this.tokVectorLength=t.length},enumerable:!1,configurable:!0}),t.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):Ar},t.prototype.LA=function(t){var e=this.currIdx+t;return e<0||this.tokVectorLength<=e?Ar:this.tokVector[e]},t.prototype.consumeToken=function(){this.currIdx++},t.prototype.exportLexerState=function(){return this.currIdx},t.prototype.importLexerState=function(t){this.currIdx=t},t.prototype.resetLexerState=function(){this.currIdx=-1},t.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},t.prototype.getLexerPosition=function(){return this.exportLexerState()},t}(),ir=function(){function t(){}return t.prototype.ACTION=function(t){return t.call(this)},t.prototype.consume=function(t,e,r){return this.consumeInternal(e,t,r)},t.prototype.subrule=function(t,e,r){return this.subruleInternal(e,t,r)},t.prototype.option=function(t,e){return this.optionInternal(e,t)},t.prototype.or=function(t,e){return this.orInternal(e,t)},t.prototype.many=function(t,e){return this.manyInternal(t,e)},t.prototype.atLeastOne=function(t,e){return this.atLeastOneInternal(t,e)},t.prototype.CONSUME=function(t,e){return this.consumeInternal(t,0,e)},t.prototype.CONSUME1=function(t,e){return this.consumeInternal(t,1,e)},t.prototype.CONSUME2=function(t,e){return this.consumeInternal(t,2,e)},t.prototype.CONSUME3=function(t,e){return this.consumeInternal(t,3,e)},t.prototype.CONSUME4=function(t,e){return this.consumeInternal(t,4,e)},t.prototype.CONSUME5=function(t,e){return this.consumeInternal(t,5,e)},t.prototype.CONSUME6=function(t,e){return this.consumeInternal(t,6,e)},t.prototype.CONSUME7=function(t,e){return this.consumeInternal(t,7,e)},t.prototype.CONSUME8=function(t,e){return this.consumeInternal(t,8,e)},t.prototype.CONSUME9=function(t,e){return this.consumeInternal(t,9,e)},t.prototype.SUBRULE=function(t,e){return this.subruleInternal(t,0,e)},t.prototype.SUBRULE1=function(t,e){return this.subruleInternal(t,1,e)},t.prototype.SUBRULE2=function(t,e){return this.subruleInternal(t,2,e)},t.prototype.SUBRULE3=function(t,e){return this.subruleInternal(t,3,e)},t.prototype.SUBRULE4=function(t,e){return this.subruleInternal(t,4,e)},t.prototype.SUBRULE5=function(t,e){return this.subruleInternal(t,5,e)},t.prototype.SUBRULE6=function(t,e){return this.subruleInternal(t,6,e)},t.prototype.SUBRULE7=function(t,e){return this.subruleInternal(t,7,e)},t.prototype.SUBRULE8=function(t,e){return this.subruleInternal(t,8,e)},t.prototype.SUBRULE9=function(t,e){return this.subruleInternal(t,9,e)},t.prototype.OPTION=function(t){return this.optionInternal(t,0)},t.prototype.OPTION1=function(t){return this.optionInternal(t,1)},t.prototype.OPTION2=function(t){return this.optionInternal(t,2)},t.prototype.OPTION3=function(t){return this.optionInternal(t,3)},t.prototype.OPTION4=function(t){return this.optionInternal(t,4)},t.prototype.OPTION5=function(t){return this.optionInternal(t,5)},t.prototype.OPTION6=function(t){return this.optionInternal(t,6)},t.prototype.OPTION7=function(t){return this.optionInternal(t,7)},t.prototype.OPTION8=function(t){return this.optionInternal(t,8)},t.prototype.OPTION9=function(t){return this.optionInternal(t,9)},t.prototype.OR=function(t){return this.orInternal(t,0)},t.prototype.OR1=function(t){return this.orInternal(t,1)},t.prototype.OR2=function(t){return this.orInternal(t,2)},t.prototype.OR3=function(t){return this.orInternal(t,3)},t.prototype.OR4=function(t){return this.orInternal(t,4)},t.prototype.OR5=function(t){return this.orInternal(t,5)},t.prototype.OR6=function(t){return this.orInternal(t,6)},t.prototype.OR7=function(t){return this.orInternal(t,7)},t.prototype.OR8=function(t){return this.orInternal(t,8)},t.prototype.OR9=function(t){return this.orInternal(t,9)},t.prototype.MANY=function(t){this.manyInternal(0,t)},t.prototype.MANY1=function(t){this.manyInternal(1,t)},t.prototype.MANY2=function(t){this.manyInternal(2,t)},t.prototype.MANY3=function(t){this.manyInternal(3,t)},t.prototype.MANY4=function(t){this.manyInternal(4,t)},t.prototype.MANY5=function(t){this.manyInternal(5,t)},t.prototype.MANY6=function(t){this.manyInternal(6,t)},t.prototype.MANY7=function(t){this.manyInternal(7,t)},t.prototype.MANY8=function(t){this.manyInternal(8,t)},t.prototype.MANY9=function(t){this.manyInternal(9,t)},t.prototype.MANY_SEP=function(t){this.manySepFirstInternal(0,t)},t.prototype.MANY_SEP1=function(t){this.manySepFirstInternal(1,t)},t.prototype.MANY_SEP2=function(t){this.manySepFirstInternal(2,t)},t.prototype.MANY_SEP3=function(t){this.manySepFirstInternal(3,t)},t.prototype.MANY_SEP4=function(t){this.manySepFirstInternal(4,t)},t.prototype.MANY_SEP5=function(t){this.manySepFirstInternal(5,t)},t.prototype.MANY_SEP6=function(t){this.manySepFirstInternal(6,t)},t.prototype.MANY_SEP7=function(t){this.manySepFirstInternal(7,t)},t.prototype.MANY_SEP8=function(t){this.manySepFirstInternal(8,t)},t.prototype.MANY_SEP9=function(t){this.manySepFirstInternal(9,t)},t.prototype.AT_LEAST_ONE=function(t){this.atLeastOneInternal(0,t)},t.prototype.AT_LEAST_ONE1=function(t){return this.atLeastOneInternal(1,t)},t.prototype.AT_LEAST_ONE2=function(t){this.atLeastOneInternal(2,t)},t.prototype.AT_LEAST_ONE3=function(t){this.atLeastOneInternal(3,t)},t.prototype.AT_LEAST_ONE4=function(t){this.atLeastOneInternal(4,t)},t.prototype.AT_LEAST_ONE5=function(t){this.atLeastOneInternal(5,t)},t.prototype.AT_LEAST_ONE6=function(t){this.atLeastOneInternal(6,t)},t.prototype.AT_LEAST_ONE7=function(t){this.atLeastOneInternal(7,t)},t.prototype.AT_LEAST_ONE8=function(t){this.atLeastOneInternal(8,t)},t.prototype.AT_LEAST_ONE9=function(t){this.atLeastOneInternal(9,t)},t.prototype.AT_LEAST_ONE_SEP=function(t){this.atLeastOneSepFirstInternal(0,t)},t.prototype.AT_LEAST_ONE_SEP1=function(t){this.atLeastOneSepFirstInternal(1,t)},t.prototype.AT_LEAST_ONE_SEP2=function(t){this.atLeastOneSepFirstInternal(2,t)},t.prototype.AT_LEAST_ONE_SEP3=function(t){this.atLeastOneSepFirstInternal(3,t)},t.prototype.AT_LEAST_ONE_SEP4=function(t){this.atLeastOneSepFirstInternal(4,t)},t.prototype.AT_LEAST_ONE_SEP5=function(t){this.atLeastOneSepFirstInternal(5,t)},t.prototype.AT_LEAST_ONE_SEP6=function(t){this.atLeastOneSepFirstInternal(6,t)},t.prototype.AT_LEAST_ONE_SEP7=function(t){this.atLeastOneSepFirstInternal(7,t)},t.prototype.AT_LEAST_ONE_SEP8=function(t){this.atLeastOneSepFirstInternal(8,t)},t.prototype.AT_LEAST_ONE_SEP9=function(t){this.atLeastOneSepFirstInternal(9,t)},t.prototype.RULE=function(t,e,r){if(void 0===r&&(r=Or),(0,o.gR)(this.definedRulesNames,t)){var n={message:Ht.buildDuplicateRuleNameError({topLevelRule:t,grammarName:this.className}),type:Mr.DUPLICATE_RULE_NAME,ruleName:t};this.definitionErrors.push(n)}this.definedRulesNames.push(t);var a=this.defineRule(t,e,r);return this[t]=a,a},t.prototype.OVERRIDE_RULE=function(t,e,r){void 0===r&&(r=Or);var n,a,i,c,s,u=[];u=u.concat((n=t,a=this.definedRulesNames,i=this.className,s=[],o.gR(a,n)||(c="Invalid rule override, rule: ->"+n+"<- cannot be overridden in the grammar: ->"+i+"<-as it is not defined in any of the super grammars ",s.push({message:c,type:Mr.INVALID_RULE_OVERRIDE,ruleName:n})),s)),this.definitionErrors.push.apply(this.definitionErrors,u);var l=this.defineRule(t,e,r);return this[t]=l,l},t.prototype.BACKTRACK=function(t,e){return function(){this.isBackTrackingStack.push(1);var r=this.saveRecogState();try{return t.apply(this,e),!0}catch(n){if(Le(n))return!1;throw n}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}},t.prototype.getGAstProductions=function(){return this.gastProductionsCache},t.prototype.getSerializedGastProductions=function(){return St((0,o.zu)(this.gastProductionsCache))},t}(),cr=function(){function t(){}return t.prototype.initRecognizerEngine=function(t,e){if(this.className=Ze(this.constructor),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=G,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},(0,o.zy)(e,"serializedGrammar"))throw Error("The Parser's configuration can no longer contain a <serializedGrammar> property.\n\tSee: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0\n\tFor Further details.");if((0,o.cy)(t)){if((0,o.Im)(t))throw Error("A Token Vocabulary cannot be empty.\n\tNote that the first argument for the parser constructor\n\tis no longer a Token vector (since v4.0).");if("number"==typeof t[0].startOffset)throw Error("The Parser constructor no longer accepts a token vector as the first argument.\n\tSee: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0\n\tFor Further details.")}if((0,o.cy)(t))this.tokensMap=(0,o.TS)(t,(function(t,e){return t[e.name]=e,t}),{});else if((0,o.zy)(t,"modes")&&(0,o.Si)((0,o.Bq)((0,o.zu)(t.modes)),$)){var r=(0,o.Bq)((0,o.zu)(t.modes)),n=(0,o.sb)(r);this.tokensMap=(0,o.TS)(n,(function(t,e){return t[e.name]=e,t}),{})}else{if(!(0,o.Gv)(t))throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap=(0,o.lR)(t)}this.tokensMap.EOF=pt;var a=(0,o.Si)((0,o.zu)(t),(function(t){return(0,o.Im)(t.categoryMatches)}));this.tokenMatcher=a?G:V,W((0,o.zu)(this.tokensMap))},t.prototype.defineRule=function(t,e,r){if(this.selfAnalysisDone)throw Error("Grammar rule <"+t+"> may not be defined after the 'performSelfAnalysis' method has been called'\nMake sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.");var n,a=(0,o.zy)(r,"resyncEnabled")?r.resyncEnabled:Or.resyncEnabled,i=(0,o.zy)(r,"recoveryValueFunc")?r.recoveryValueFunc:Or.recoveryValueFunc,c=this.ruleShortNameIdx<<12;function s(t){try{if(!0===this.outputCst){e.apply(this,t);var r=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(r),r}return e.apply(this,t)}catch(n){return this.invokeRuleCatch(n,a,i)}finally{this.ruleFinallyStateUpdate()}}this.ruleShortNameIdx++,this.shortRuleNameToFull[c]=t,this.fullRuleNameToShort[t]=c;return(n=function(e,r){return void 0===e&&(e=0),this.ruleInvocationStateUpdate(c,t,e),s.call(this,r)}).ruleName=t,n.originalGrammarAction=e,n},t.prototype.invokeRuleCatch=function(t,e,r){var n=1===this.RULE_STACK.length,o=e&&!this.isBackTracking()&&this.recoveryEnabled;if(Le(t)){var a=t;if(o){var i,c=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(c))return a.resyncedTokens=this.reSyncTo(c),this.outputCst?((i=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,i):r();throw this.outputCst&&((i=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,a.partialCstResult=i),a}if(n)return this.moveToTerminatedState(),r();throw a}throw t},t.prototype.optionInternal=function(t,e){var r=this.getKeyForAutomaticLookahead(512,e);return this.optionInternalLogic(t,e,r)},t.prototype.optionInternalLogic=function(t,e,r){var n,o,a=this,i=this.getLaFuncFromCache(r);if(void 0!==t.DEF){if(n=t.DEF,void 0!==(o=t.GATE)){var c=i;i=function(){return o.call(a)&&c.call(a)}}}else n=t;if(!0===i.call(this))return n.call(this)},t.prototype.atLeastOneInternal=function(t,e){var r=this.getKeyForAutomaticLookahead(He,t);return this.atLeastOneInternalLogic(t,e,r)},t.prototype.atLeastOneInternalLogic=function(t,e,r){var n,o,a=this,i=this.getLaFuncFromCache(r);if(void 0!==e.DEF){if(n=e.DEF,void 0!==(o=e.GATE)){var c=i;i=function(){return o.call(a)&&c.call(a)}}}else n=e;if(!0!==i.call(this))throw this.raiseEarlyExitException(t,ne.REPETITION_MANDATORY,e.ERR_MSG);for(var s=this.doSingleRepetition(n);!0===i.call(this)&&!0===s;)s=this.doSingleRepetition(n);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[t,e],i,He,t,Qt)},t.prototype.atLeastOneSepFirstInternal=function(t,e){var r=this.getKeyForAutomaticLookahead(Ye,t);this.atLeastOneSepFirstInternalLogic(t,e,r)},t.prototype.atLeastOneSepFirstInternalLogic=function(t,e,r){var n=this,o=e.DEF,a=e.SEP;if(!0!==this.getLaFuncFromCache(r).call(this))throw this.raiseEarlyExitException(t,ne.REPETITION_MANDATORY_WITH_SEPARATOR,e.ERR_MSG);o.call(this);for(var i=function(){return n.tokenMatcher(n.LA(1),a)};!0===this.tokenMatcher(this.LA(1),a);)this.CONSUME(a),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,a,i,o,Zt],i,Ye,t,Zt)},t.prototype.manyInternal=function(t,e){var r=this.getKeyForAutomaticLookahead(768,t);return this.manyInternalLogic(t,e,r)},t.prototype.manyInternalLogic=function(t,e,r){var n,o,a=this,i=this.getLaFuncFromCache(r);if(void 0!==e.DEF){if(n=e.DEF,void 0!==(o=e.GATE)){var c=i;i=function(){return o.call(a)&&c.call(a)}}}else n=e;for(var s=!0;!0===i.call(this)&&!0===s;)s=this.doSingleRepetition(n);this.attemptInRepetitionRecovery(this.manyInternal,[t,e],i,768,t,Xt,s)},t.prototype.manySepFirstInternal=function(t,e){var r=this.getKeyForAutomaticLookahead(We,t);this.manySepFirstInternalLogic(t,e,r)},t.prototype.manySepFirstInternalLogic=function(t,e,r){var n=this,o=e.DEF,a=e.SEP;if(!0===this.getLaFuncFromCache(r).call(this)){o.call(this);for(var i=function(){return n.tokenMatcher(n.LA(1),a)};!0===this.tokenMatcher(this.LA(1),a);)this.CONSUME(a),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,a,i,o,Jt],i,We,t,Jt)}},t.prototype.repetitionSepSecondInternal=function(t,e,r,n,o){for(;r();)this.CONSUME(e),n.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,e,r,n,o],r,Ye,t,o)},t.prototype.doSingleRepetition=function(t){var e=this.getLexerPosition();return t.call(this),this.getLexerPosition()>e},t.prototype.orInternal=function(t,e){var r=this.getKeyForAutomaticLookahead(256,e),n=(0,o.cy)(t)?t:t.DEF,a=this.getLaFuncFromCache(r).call(this,n);if(void 0!==a)return n[a].ALT.call(this);this.raiseNoAltException(e,t.ERR_MSG)},t.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),0===this.RULE_STACK.length&&!1===this.isAtEndOfInput()){var t=this.LA(1),e=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:t,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new Be(e,t))}},t.prototype.subruleInternal=function(t,e,r){var n;try{var o=void 0!==r?r.ARGS:void 0;return n=t.call(this,e,o),this.cstPostNonTerminal(n,void 0!==r&&void 0!==r.LABEL?r.LABEL:t.ruleName),n}catch(a){this.subruleInternalError(a,r,t.ruleName)}},t.prototype.subruleInternalError=function(t,e,r){throw Le(t)&&void 0!==t.partialCstResult&&(this.cstPostNonTerminal(t.partialCstResult,void 0!==e&&void 0!==e.LABEL?e.LABEL:r),delete t.partialCstResult),t},t.prototype.consumeInternal=function(t,e,r){var n;try{var o=this.LA(1);!0===this.tokenMatcher(o,t)?(this.consumeToken(),n=o):this.consumeInternalError(t,o,r)}catch(a){n=this.consumeInternalRecovery(t,e,a)}return this.cstPostTerminal(void 0!==r&&void 0!==r.LABEL?r.LABEL:t.name,n),n},t.prototype.consumeInternalError=function(t,e,r){var n,o=this.LA(0);throw n=void 0!==r&&r.ERR_MSG?r.ERR_MSG:this.errorMessageProvider.buildMismatchTokenMessage({expected:t,actual:e,previous:o,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new ke(n,e,o))},t.prototype.consumeInternalRecovery=function(t,e,r){if(!this.recoveryEnabled||"MismatchedTokenException"!==r.name||this.isBackTracking())throw r;var n=this.getFollowsForInRuleRecovery(t,e);try{return this.tryInRuleRecovery(t,n)}catch(o){throw o.name===je?r:o}},t.prototype.saveRecogState=function(){var t=this.errors,e=(0,o.T9)(this.RULE_STACK);return{errors:t,lexerState:this.exportLexerState(),RULE_STACK:e,CST_STACK:this.CST_STACK}},t.prototype.reloadRecogState=function(t){this.errors=t.errors,this.importLexerState(t.lexerState),this.RULE_STACK=t.RULE_STACK},t.prototype.ruleInvocationStateUpdate=function(t,e,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(t),this.cstInvocationStateUpdate(e,t)},t.prototype.isBackTracking=function(){return 0!==this.isBackTrackingStack.length},t.prototype.getCurrRuleFullName=function(){var t=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[t]},t.prototype.shortRuleNameToFullName=function(t){return this.shortRuleNameToFull[t]},t.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),pt)},t.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},t}(),sr=function(){function t(){}return t.prototype.initErrorHandler=function(t){this._errors=[],this.errorMessageProvider=(0,o.zy)(t,"errorMessageProvider")?t.errorMessageProvider:wr.errorMessageProvider},t.prototype.SAVE_ERROR=function(t){if(Le(t))return t.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:(0,o.T9)(this.RULE_OCCURRENCE_STACK)},this._errors.push(t),t;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(t.prototype,"errors",{get:function(){return(0,o.T9)(this._errors)},set:function(t){this._errors=t},enumerable:!1,configurable:!0}),t.prototype.raiseEarlyExitException=function(t,e,r){for(var n=this.getCurrRuleFullName(),o=he(t,this.getGAstProductions()[n],e,this.maxLookahead)[0],a=[],i=1;i<=this.maxLookahead;i++)a.push(this.LA(i));var c=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:o,actual:a,previous:this.LA(0),customUserDescription:r,ruleName:n});throw this.SAVE_ERROR(new De(c,this.LA(1),this.LA(0)))},t.prototype.raiseNoAltException=function(t,e){for(var r=this.getCurrRuleFullName(),n=fe(t,this.getGAstProductions()[r],this.maxLookahead),o=[],a=1;a<=this.maxLookahead;a++)o.push(this.LA(a));var i=this.LA(0),c=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:n,actual:o,previous:i,customUserDescription:e,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new Pe(c,this.LA(1),i))},t}(),ur=function(){function t(){}return t.prototype.initContentAssist=function(){},t.prototype.computeContentAssist=function(t,e){var r=this.gastProductionsCache[t];if((0,o.b0)(r))throw Error("Rule ->"+t+"<- does not exist in this grammar.");return ee([r],e,this.tokenMatcher,this.maxLookahead)},t.prototype.getNextPossibleTokenTypes=function(t){var e=(0,o.$1)(t.ruleStack),r=this.getGAstProductions()[e];return new qt(r,t).startWalking()},t}(),lr={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(lr);var fr=!0,hr=Math.pow(2,8)-1,pr=ht({name:"RECORDING_PHASE_TOKEN",pattern:Z.NA});W([pr]);var dr=dt(pr,"This IToken indicates the Parser is in Recording Phase\n\tSee: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details",-1,-1,-1,-1,-1,-1);Object.freeze(dr);var mr={name:"This CSTNode indicates the Parser is in Recording Phase\n\tSee: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details",children:{}},vr=function(){function t(){}return t.prototype.initGastRecorder=function(t){this.recordingProdStack=[],this.RECORDING_PHASE=!1},t.prototype.enableRecording=function(){var t=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",(function(){for(var e=function(e){var r=e>0?e:"";t["CONSUME"+r]=function(t,r){return this.consumeInternalRecord(t,e,r)},t["SUBRULE"+r]=function(t,r){return this.subruleInternalRecord(t,e,r)},t["OPTION"+r]=function(t){return this.optionInternalRecord(t,e)},t["OR"+r]=function(t){return this.orInternalRecord(t,e)},t["MANY"+r]=function(t){this.manyInternalRecord(e,t)},t["MANY_SEP"+r]=function(t){this.manySepFirstInternalRecord(e,t)},t["AT_LEAST_ONE"+r]=function(t){this.atLeastOneInternalRecord(e,t)},t["AT_LEAST_ONE_SEP"+r]=function(t){this.atLeastOneSepFirstInternalRecord(e,t)}},r=0;r<10;r++)e(r);t.consume=function(t,e,r){return this.consumeInternalRecord(e,t,r)},t.subrule=function(t,e,r){return this.subruleInternalRecord(e,t,r)},t.option=function(t,e){return this.optionInternalRecord(e,t)},t.or=function(t,e){return this.orInternalRecord(e,t)},t.many=function(t,e){this.manyInternalRecord(t,e)},t.atLeastOne=function(t,e){this.atLeastOneInternalRecord(t,e)},t.ACTION=t.ACTION_RECORD,t.BACKTRACK=t.BACKTRACK_RECORD,t.LA=t.LA_RECORD}))},t.prototype.disableRecording=function(){var t=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",(function(){for(var e=0;e<10;e++){var r=e>0?e:"";delete t["CONSUME"+r],delete t["SUBRULE"+r],delete t["OPTION"+r],delete t["OR"+r],delete t["MANY"+r],delete t["MANY_SEP"+r],delete t["AT_LEAST_ONE"+r],delete t["AT_LEAST_ONE_SEP"+r]}delete t.consume,delete t.subrule,delete t.option,delete t.or,delete t.many,delete t.atLeastOne,delete t.ACTION,delete t.BACKTRACK,delete t.LA}))},t.prototype.ACTION_RECORD=function(t){},t.prototype.BACKTRACK_RECORD=function(t,e){return function(){return!0}},t.prototype.LA_RECORD=function(t){return Ar},t.prototype.topLevelRuleRecord=function(t,e){try{var r=new yt({definition:[],name:t});return r.name=t,this.recordingProdStack.push(r),e.call(this),this.recordingProdStack.pop(),r}catch(n){if(!0!==n.KNOWN_RECORDER_ERROR)try{n.message=n.message+'\n\t This error was thrown during the "grammar recording phase" For more info see:\n\thttps://chevrotain.io/docs/guide/internals.html#grammar-recording'}catch(o){throw n}throw n}},t.prototype.optionInternalRecord=function(t,e){return gr.call(this,Rt,t,e)},t.prototype.atLeastOneInternalRecord=function(t,e){gr.call(this,Tt,e,t)},t.prototype.atLeastOneSepFirstInternalRecord=function(t,e){gr.call(this,At,e,t,fr)},t.prototype.manyInternalRecord=function(t,e){gr.call(this,Mt,e,t)},t.prototype.manySepFirstInternalRecord=function(t,e){gr.call(this,wt,e,t,fr)},t.prototype.orInternalRecord=function(t,e){return Er.call(this,t,e)},t.prototype.subruleInternalRecord=function(t,e,r){if(Nr(e),!t||!1===(0,o.zy)(t,"ruleName")){var n=new Error("<SUBRULE"+yr(e)+"> argument is invalid expecting a Parser method reference but got: <"+JSON.stringify(t)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw n.KNOWN_RECORDER_ERROR=!0,n}var a=(0,o.se)(this.recordingProdStack),i=t.ruleName,c=new Et({idx:e,nonTerminalName:i,referencedRule:void 0});return a.definition.push(c),this.outputCst?mr:lr},t.prototype.consumeInternalRecord=function(t,e,r){if(Nr(e),!K(t)){var n=new Error("<CONSUME"+yr(e)+"> argument is invalid expecting a TokenType reference but got: <"+JSON.stringify(t)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw n.KNOWN_RECORDER_ERROR=!0,n}var a=(0,o.se)(this.recordingProdStack),i=new It({idx:e,terminalType:t});return a.definition.push(i),dr},t}();function gr(t,e,r,n){void 0===n&&(n=!1),Nr(r);var a=(0,o.se)(this.recordingProdStack),i=(0,o.Tn)(e)?e:e.DEF,c=new t({definition:[],idx:r});return n&&(c.separator=e.SEP),(0,o.zy)(e,"MAX_LOOKAHEAD")&&(c.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(c),i.call(this),a.definition.push(c),this.recordingProdStack.pop(),lr}function Er(t,e){var r=this;Nr(e);var n=(0,o.se)(this.recordingProdStack),a=!1===(0,o.cy)(t),i=!1===a?t:t.DEF,c=new Ot({definition:[],idx:e,ignoreAmbiguities:a&&!0===t.IGNORE_AMBIGUITIES});(0,o.zy)(t,"MAX_LOOKAHEAD")&&(c.maxLookahead=t.MAX_LOOKAHEAD);var s=(0,o.zN)(i,(function(t){return(0,o.Tn)(t.GATE)}));return c.hasPredicates=s,n.definition.push(c),(0,o.jJ)(i,(function(t){var e=new Nt({definition:[]});c.definition.push(e),(0,o.zy)(t,"IGNORE_AMBIGUITIES")?e.ignoreAmbiguities=t.IGNORE_AMBIGUITIES:(0,o.zy)(t,"GATE")&&(e.ignoreAmbiguities=!0),r.recordingProdStack.push(e),t.ALT.call(r),r.recordingProdStack.pop()})),lr}function yr(t){return 0===t?"":""+t}function Nr(t){if(t<0||t>hr){var e=new Error("Invalid DSL Method idx value: <"+t+">\n\tIdx value must be a none negative value smaller than "+(hr+1));throw e.KNOWN_RECORDER_ERROR=!0,e}}var Rr=function(){function t(){}return t.prototype.initPerformanceTracer=function(t){if((0,o.zy)(t,"traceInitPerf")){var e=t.traceInitPerf,r="number"==typeof e;this.traceInitMaxIdent=r?e:1/0,this.traceInitPerf=r?e>0:e}else this.traceInitMaxIdent=0,this.traceInitPerf=wr.traceInitPerf;this.traceInitIndent=-1},t.prototype.TRACE_INIT=function(t,e){if(!0===this.traceInitPerf){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--\x3e <"+t+">");var n=(0,o.O1)(e),a=n.time,i=n.value,c=a>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&c(r+"<-- <"+t+"> time: "+a+"ms"),this.traceInitIndent--,i}return e()},t}(),Tr=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ar=dt(pt,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(Ar);var Mr,wr=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:Gt,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),Or=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0});function Ir(t){return void 0===t&&(t=void 0),function(){return t}}!function(t){t[t.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",t[t.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",t[t.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",t[t.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",t[t.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",t[t.LEFT_RECURSION=5]="LEFT_RECURSION",t[t.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",t[t.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",t[t.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",t[t.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",t[t.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",t[t.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",t[t.TOO_MANY_ALTS=12]="TOO_MANY_ALTS"}(Mr||(Mr={}));var Sr=function(){function t(t,e){this.definitionErrors=[],this.selfAnalysisDone=!1;var r=this;if(r.initErrorHandler(e),r.initLexerAdapter(),r.initLooksAhead(e),r.initRecognizerEngine(t,e),r.initRecoverable(e),r.initTreeBuilder(e),r.initContentAssist(),r.initGastRecorder(e),r.initPerformanceTracer(e),(0,o.zy)(e,"ignoredIssues"))throw new Error("The <ignoredIssues> IParserConfig property has been deprecated.\n\tPlease use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.\n\tSee: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES\n\tFor further details.");this.skipValidations=(0,o.zy)(e,"skipValidations")?e.skipValidations:wr.skipValidations}return t.performSelfAnalysis=function(t){throw Error("The **static** `performSelfAnalysis` method has been deprecated.\t\nUse the **instance** method with the same name instead.")},t.prototype.performSelfAnalysis=function(){var e=this;this.TRACE_INIT("performSelfAnalysis",(function(){var r;e.selfAnalysisDone=!0;var n=e.className;e.TRACE_INIT("toFastProps",(function(){(0,o.Bl)(e)})),e.TRACE_INIT("Grammar Recording",(function(){try{e.enableRecording(),(0,o.jJ)(e.definedRulesNames,(function(t){var r=e[t].originalGrammarAction,n=void 0;e.TRACE_INIT(t+" Rule",(function(){n=e.topLevelRuleRecord(t,r)})),e.gastProductionsCache[t]=n}))}finally{e.disableRecording()}}));var a=[];if(e.TRACE_INIT("Grammar Resolving",(function(){a=Me({rules:(0,o.zu)(e.gastProductionsCache)}),e.definitionErrors.push.apply(e.definitionErrors,a)})),e.TRACE_INIT("Grammar Validations",(function(){if((0,o.Im)(a)&&!1===e.skipValidations){var t=we({rules:(0,o.zu)(e.gastProductionsCache),maxLookahead:e.maxLookahead,tokenTypes:(0,o.zu)(e.tokensMap),errMsgProvider:Ht,grammarName:n});e.definitionErrors.push.apply(e.definitionErrors,t)}})),(0,o.Im)(e.definitionErrors)&&(e.recoveryEnabled&&e.TRACE_INIT("computeAllProdsFollows",(function(){var t,r,n=(t=(0,o.zu)(e.gastProductionsCache),r={},(0,o.jJ)(t,(function(t){var e=new Vt(t).startWalking();(0,o.kp)(r,e)})),r);e.resyncFollows=n})),e.TRACE_INIT("ComputeLookaheadFunctions",(function(){e.preComputeLookaheadFunctions((0,o.zu)(e.gastProductionsCache))}))),!t.DEFER_DEFINITION_ERRORS_HANDLING&&!(0,o.Im)(e.definitionErrors))throw r=(0,o.Tj)(e.definitionErrors,(function(t){return t.message})),new Error("Parser Definition Errors detected:\n "+r.join("\n-------------------------------\n"))}))},t.DEFER_DEFINITION_ERRORS_HANDLING=!1,t}();(0,o.XJ)(Sr,[Ge,qe,or,ar,cr,ir,sr,ur,vr,Rr]);var Cr=function(t){function e(e,r){void 0===r&&(r=wr);var n=(0,o.lR)(r);return n.outputCst=!0,t.call(this,e,n)||this}return Tr(e,t),e}(Sr),br=function(t){function e(e,r){void 0===r&&(r=wr);var n=(0,o.lR)(r);return n.outputCst=!1,t.call(this,e,n)||this}return Tr(e,t),e}(Sr);function Ur(t,e){var r=void 0===e?{}:e,o=r.resourceBase,a=void 0===o?"https://unpkg.com/chevrotain@"+n+"/diagrams/":o,i=r.css;return'\n\x3c!-- This is a generated file --\x3e\n<!DOCTYPE html>\n<meta charset="utf-8">\n<style>\n  body {\n    background-color: hsl(30, 20%, 95%)\n  }\n</style>\n\n'+("\n<link rel='stylesheet' href='"+(void 0===i?"https://unpkg.com/chevrotain@"+n+"/diagrams/diagrams.css":i)+"'>\n")+("\n<script src='"+a+"vendor/railroad-diagrams.js'><\/script>\n<script src='"+a+"src/diagrams_builder.js'><\/script>\n<script src='"+a+"src/diagrams_behavior.js'><\/script>\n<script src='"+a+"src/main.js'><\/script>\n")+'\n<div id="diagrams" align="center"></div>    \n'+("\n<script>\n    window.serializedGrammar = "+JSON.stringify(t,null,"  ")+";\n<\/script>\n")+'\n<script>\n    var diagramsDiv = document.getElementById("diagrams");\n    main.drawDiagramsFromSerializedGrammar(serializedGrammar, diagramsDiv);\n<\/script>\n'}var xr="\n";function Lr(t){var e;return"\nfunction "+t.name+"(tokenVocabulary, config) {\n    // invoke super constructor\n    // No support for embedded actions currently, so we can 'hardcode'\n    // The use of CstParser.\n    chevrotain.CstParser.call(this, tokenVocabulary, config)\n\n    const $ = this\n\n    "+(e=t.rules,(0,o.Tj)(e,(function(t){return function(t,e){var r=Fr(e,'$.RULE("'+t.name+'", function() {')+xr;return r+=Dr(t.definition,e+1),r+=Fr(e+1,"})")+xr}(t,1)})).join("\n")+"\n\n    // very important to call this after all the rules have been defined.\n    // otherwise the parser may not work correctly as it will lack information\n    // derived during the self analysis phase.\n    this.performSelfAnalysis(this)\n}\n\n// inheritance as implemented in javascript in the previous decade... :(\n")+t.name+".prototype = Object.create(chevrotain.CstParser.prototype)\n"+t.name+".prototype.constructor = "+t.name+"    \n    "}function _r(t,e){var r=Fr(e,"$.OR"+t.idx+"([")+xr,n=(0,o.Tj)(t.definition,(function(t){return function(t,e){var r=Fr(e,"{")+xr;return r+=Fr(e+1,"ALT: function() {")+xr,r+=Dr(t.definition,e+1),r+=Fr(e+1,"}")+xr,r+=Fr(e,"}"),r}(t,e+1)}));return r+=n.join(","+xr),r+=xr+Fr(e,"])"+xr)}function kr(t,e){if(t instanceof Et)return function(t,e){return Fr(e,"$.SUBRULE"+t.idx+"($."+t.nonTerminalName+")"+xr)}(t,e);if(t instanceof Rt)return Pr("OPTION",t,e);if(t instanceof Tt)return Pr("AT_LEAST_ONE",t,e);if(t instanceof At)return Pr("AT_LEAST_ONE_SEP",t,e);if(t instanceof wt)return Pr("MANY_SEP",t,e);if(t instanceof Mt)return Pr("MANY",t,e);if(t instanceof Ot)return _r(t,e);if(t instanceof It)return function(t,e){var r=t.terminalType.name;return Fr(e,"$.CONSUME"+t.idx+"(this.tokensMap."+r+")"+xr)}(t,e);if(t instanceof Nt)return Dr(t.definition,e);throw Error("non exhaustive match")}function Pr(t,e,r){var n=Fr(r,"$."+(t+e.idx)+"(");return e.separator?(n+="{"+xr,n+=Fr(r+1,"SEP: this.tokensMap."+e.separator.name)+","+xr,n+="DEF: "+Br(e.definition,r+2)+xr,n+=Fr(r,"}")+xr):n+=Br(e.definition,r+1),n+=Fr(r,")")+xr}function Br(t,e){var r="function() {"+xr;return r+=Dr(t,e),r+=Fr(e,"}")+xr}function Dr(t,e){var r="";return(0,o.jJ)(t,(function(t){r+=kr(t,e+1)})),r}function Fr(t,e){return Array(4*t+1).join(" ")+e}function jr(t){var e=function(t){return"    \n"+Lr(t)+"\nreturn new "+t.name+"(tokenVocabulary, config)    \n"}({name:t.name,rules:t.rules}),n=new Function("tokenVocabulary","config","chevrotain",e);return function(e){return n(t.tokenVocabulary,e,r(5949))}}function Vr(t){return function(t){return"\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(['chevrotain'], factory);\n    } else if (typeof module === 'object' && module.exports) {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory(require('chevrotain'));\n    } else {\n        // Browser globals (root is window)\n        root.returnExports = factory(root.b);\n    }\n}(typeof self !== 'undefined' ? self : this, function (chevrotain) {\n\n"+Lr(t)+"\n    \nreturn {\n    "+t.name+": "+t.name+" \n}\n}));\n"}({name:t.name,rules:t.rules})}function Gr(){console.warn("The clearCache function was 'soft' removed from the Chevrotain API.\n\t It performs no action other than printing this message.\n\t Please avoid using it as it will be completely removed in the future")}var zr=function(){throw new Error("The Parser class has been deprecated, use CstParser or EmbeddedActionsParser instead.\t\nSee: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_7-0-0")}},1632:(t,e,r)=>{"use strict";function n(t){return t&&0===t.length}function o(t){return null==t?[]:Object.keys(t)}function a(t){for(var e=[],r=Object.keys(t),n=0;n<r.length;n++)e.push(t[r[n]]);return e}function i(t,e){for(var r=[],n=o(t),a=0;a<n.length;a++){var i=n[a];r.push(e.call(null,t[i],i))}return r}function c(t,e){for(var r=[],n=0;n<t.length;n++)r.push(e.call(null,t[n],n));return r}function s(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];Array.isArray(n)?e=e.concat(s(n)):e.push(n)}return e}function u(t){return n(t)?void 0:t[0]}function l(t){var e=t&&t.length;return e?t[e-1]:void 0}function f(t,e){if(Array.isArray(t))for(var r=0;r<t.length;r++)e.call(null,t[r],r);else{if(!x(t))throw Error("non exhaustive match");var n=o(t);for(r=0;r<n.length;r++){var a=n[r],i=t[a];e.call(null,i,a)}}}function h(t){return"string"==typeof t}function p(t){return void 0===t}function d(t){return t instanceof Function}function m(t,e){return void 0===e&&(e=1),t.slice(e,t.length)}function v(t,e){return void 0===e&&(e=1),t.slice(0,t.length-e)}function g(t,e){var r=[];if(Array.isArray(t))for(var n=0;n<t.length;n++){var o=t[n];e.call(null,o)&&r.push(o)}return r}function E(t,e){return g(t,(function(t){return!e(t)}))}function y(t,e){for(var r=Object.keys(t),n={},o=0;o<r.length;o++){var a=r[o],i=t[a];e(i)&&(n[a]=i)}return n}function N(t,e){return!!x(t)&&t.hasOwnProperty(e)}function R(t,e){return void 0!==M(t,(function(t){return t===e}))}function T(t){for(var e=[],r=0;r<t.length;r++)e.push(t[r]);return e}function A(t){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}function M(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(e.call(null,n))return n}}function w(t,e){for(var r=[],n=0;n<t.length;n++){var o=t[n];e.call(null,o)&&r.push(o)}return r}function O(t,e,r){for(var n=Array.isArray(t),i=n?t:a(t),c=n?[]:o(t),s=r,u=0;u<i.length;u++)s=e.call(null,s,i[u],n?u:c[u]);return s}function I(t){return E(t,(function(t){return null==t}))}function S(t,e){void 0===e&&(e=function(t){return t});var r=[];return O(t,(function(t,n){var o=e(n);return R(r,o)?t:(r.push(o),t.concat(n))}),[])}function C(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=[null].concat(e);return Function.bind.apply(t,n)}function b(t){return Array.isArray(t)}function U(t){return t instanceof RegExp}function x(t){return t instanceof Object}function L(t,e){for(var r=0;r<t.length;r++)if(!e(t[r],r))return!1;return!0}function _(t,e){return E(t,(function(t){return R(e,t)}))}function k(t,e){for(var r=0;r<t.length;r++)if(e(t[r]))return!0;return!1}function P(t,e){for(var r=0;r<t.length;r++)if(t[r]===e)return r;return-1}function B(t,e){var r=T(t);return r.sort((function(t,r){return e(t)-e(r)})),r}function D(t,e){if(t.length!==e.length)throw Error("can't zipObject with different number of keys and values!");for(var r={},n=0;n<t.length;n++)r[t[n]]=e[n];return r}function F(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var n=0;n<e.length;n++)for(var a=e[n],i=o(a),c=0;c<i.length;c++){var s=i[c];t[s]=a[s]}return t}function j(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var n=0;n<e.length;n++)for(var a=e[n],i=o(a),c=0;c<i.length;c++){var s=i[c];N(t,s)||(t[s]=a[s])}return t}function V(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return j.apply(null,[{}].concat(t))}function G(t,e){var r={};return f(t,(function(t){var n=e(t),o=r[n];o?o.push(t):r[n]=[t]})),r}function z(t,e){for(var r=A(t),n=o(e),a=0;a<n.length;a++){var i=n[a],c=e[i];r[i]=c}return r}function H(){}function W(t){return t}function Y(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];e.push(void 0!==n?n:void 0)}return e}function K(t){console&&console.error&&console.error("Error: "+t)}function q(t){console&&console.warn&&console.warn("Warning: "+t)}function $(){return"function"==typeof Map}function X(t,e){e.forEach((function(e){var r=e.prototype;Object.getOwnPropertyNames(r).forEach((function(n){if("constructor"!==n){var o=Object.getOwnPropertyDescriptor(r,n);o&&(o.get||o.set)?Object.defineProperty(t.prototype,n,o):t.prototype[n]=e.prototype[n]}}))}))}function J(t){function e(){}e.prototype=t;var r=new e;function n(){return typeof r.bar}return n(),n(),t}function Q(t){return t[t.length-1]}function Z(t){var e=(new Date).getTime(),r=t();return{time:(new Date).getTime()-e,value:r}}r.d(e,{$1:()=>u,$z:()=>G,Bl:()=>J,Bq:()=>s,Gv:()=>x,HP:()=>o,HV:()=>l,I6:()=>M,Im:()=>n,JW:()=>w,Kg:()=>h,LG:()=>i,NT:()=>V,O1:()=>Z,Si:()=>L,T9:()=>T,TS:()=>O,Tj:()=>c,Tn:()=>d,Up:()=>y,VS:()=>Y,XJ:()=>X,Zi:()=>K,b0:()=>p,cy:()=>b,gR:()=>R,gc:()=>v,gd:()=>U,gv:()=>m,h1:()=>z,iv:()=>_,jJ:()=>f,kp:()=>F,ku:()=>E,lR:()=>A,oE:()=>I,pb:()=>g,qh:()=>P,rF:()=>$,sb:()=>S,se:()=>Q,tE:()=>H,x5:()=>q,zK:()=>W,zN:()=>k,zu:()=>a,zy:()=>N})},2485:(t,e)=>{var r;!function(){"use strict";var n={}.hasOwnProperty;function o(){for(var t=[],e=0;e<arguments.length;e++){var r=arguments[e];if(r){var a=typeof r;if("string"===a||"number"===a)t.push(r);else if(Array.isArray(r)){if(r.length){var i=o.apply(null,r);i&&t.push(i)}}else if("object"===a)if(r.toString===Object.prototype.toString)for(var c in r)n.call(r,c)&&r[c]&&t.push(c);else t.push(r.toString())}}return t.join(" ")}t.exports?(o.default=o,t.exports=o):void 0===(r=function(){return o}.apply(e,[]))||(t.exports=r)}()},53:(t,e,r)=>{"use strict";function n(t){var e,r,o="";if("string"==typeof t||"number"==typeof t)o+=t;else if("object"==typeof t)if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(r=n(t[e]))&&(o&&(o+=" "),o+=r);else for(e in t)t[e]&&(o&&(o+=" "),o+=e);return o}function o(){for(var t,e,r=0,o="";r<arguments.length;)(t=arguments[r++])&&(e=n(t))&&(o&&(o+=" "),o+=e);return o}r.d(e,{A:()=>o})},5908:(t,e,r)=>{class n extends Error{constructor(t,e,r){if(super(e),null==e&&null==r&&n.errorMap.has(t))return n.errorMap.get(t);null==e&&null==r?(this._error=t,n.errorMap.set(t,this)):this._error=t,this.details=r}get error(){return this._error}get name(){return this._error}equals(t){return t instanceof n&&t._error===this._error}toString(){return this._error}}n.errorMap=new Map,n.DIV0=new n("#DIV/0!"),n.NA=new n("#N/A"),n.NAME=new n("#NAME?"),n.NULL=new n("#NULL!"),n.NUM=new n("#NUM!"),n.REF=new n("#REF!"),n.VALUE=new n("#VALUE!"),n.NOT_IMPLEMENTED=t=>new n("#NAME?",`Function ${t} is not implemented.`),n.TOO_MANY_ARGS=t=>new n("#N/A",`Function ${t} has too many arguments.`),n.ARG_MISSING=t=>{const{Types:e}=r(3060);return new n("#N/A",`Argument type ${t.map((t=>e[t])).join(", ")} is missing.`)},n.ERROR=(t,e)=>new n("#ERROR!",t,e),t.exports=n},1518:(t,e,r)=>{const n=r(5908),{FormulaHelpers:o,Types:a}=r(3060),i=o,c=864e5,s=new Date(Date.UTC(1900,0,1)),u=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],l=[void 0,[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],void 0,void 0,void 0,void 0,void 0,void 0,void 0,[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],f=[void 0,[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0],[1],[2],[3],[4],[5],[6]],h=/^\s*(\d\d?)\s*(:\s*\d\d?)?\s*(:\s*\d\d?)?\s*(pm|am)?\s*$/i,p=/^\s*((\d\d?)\s*([-\/])\s*(\d\d?))([\d:.apm\s]*)$/i,d=/^\s*((\d\d?)\s*([-/])\s*(jan\w*|feb\w*|mar\w*|apr\w*|may\w*|jun\w*|jul\w*|aug\w*|sep\w*|oct\w*|nov\w*|dec\w*))([\d:.apm\s]*)$/i,m=/^\s*((jan\w*|feb\w*|mar\w*|apr\w*|may\w*|jun\w*|jul\w*|aug\w*|sep\w*|oct\w*|nov\w*|dec\w*)\s*([-/])\s*(\d\d?))([\d:.apm\s]*)$/i;function v(t){const e=t>-22038912e5?2:1;return Math.floor((t-s)/864e5)+e}function g(t){if(t instanceof Date)return{date:t};t=i.accept(t);let e,r=!0;return isNaN(t)?(e=function(t){const e=t.match(h);if(!e)return;const r=e[2]?e[2]:":00",n=e[3]?e[3]:":00",o=e[4]?" "+e[4]:"",a=new Date(Date.parse(`1/1/1900 ${e[1]+r+n+o} UTC`));let i=new Date;return i=new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds())),new Date(Date.UTC(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()))}(t),e?r=!1:e=function(t){const e=t.match(p),r=t.match(d),n=t.match(m);return e?t=e[1]+e[3]+(new Date).getFullYear()+e[5]:r?t=r[1]+r[3]+(new Date).getFullYear()+r[5]:n&&(t=n[1]+n[3]+(new Date).getFullYear()+n[5]),new Date(Date.parse(`${t} UTC`))}(t)):e=function(t){if(t<0)throw n.VALUE;return t<=60?new Date(s.getTime()+864e5*(t-1)):new Date(s.getTime()+864e5*(t-2))}(t=Number(t)),{date:e,isDateGiven:r}}function E(t){return g(t).date}function y(t,e){return t.getUTCFullYear()===e.getUTCFullYear()&&t.getUTCMonth()===e.getUTCMonth()&&t.getUTCDate()===e.getUTCDate()}const N={DATE:(t,e,r)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),r=i.accept(r,a.NUMBER),t<0||t>=1e4)throw n.NUM;return t<1900&&(t+=1900),v(Date.UTC(t,e-1,r))},DATEDIF:(t,e,r)=>{if(t=E(t),e=E(e),r=i.accept(r,a.STRING).toLowerCase(),t>e)throw n.NUM;const o=e.getUTCFullYear()-t.getUTCFullYear(),s=e.getUTCMonth()-t.getUTCMonth(),u=e.getUTCDate()-t.getUTCDate();let l;switch(r){case"y":return l=s<0||0===s&&u<0?-1:0,l+o;case"m":return l=u<0?-1:0,12*o+s+l;case"d":return Math.floor(e-t)/c;case"md":return t.setUTCFullYear(e.getUTCFullYear()),u<0?t.setUTCMonth(e.getUTCMonth()-1):t.setUTCMonth(e.getUTCMonth()),Math.floor(e-t)/c;case"ym":return l=u<0?-1:0,(l+12*o+s)%12;case"yd":return s<0||0===s&&u<0?t.setUTCFullYear(e.getUTCFullYear()-1):t.setUTCFullYear(e.getUTCFullYear()),Math.floor(e-t)/c}},DATEVALUE:t=>{t=i.accept(t,a.STRING);const{date:e,isDateGiven:r}=g(t);if(!r)return 0;const o=v(e);if(o<0||o>2958465)throw n.VALUE;return o},DAY:t=>E(t).getUTCDate(),DAYS:(t,e)=>{t=E(t);let r=0;return(e=E(e))<-22038912e5&&-22038912e5<t&&(r=1),Math.floor(t-e)/c+r},DAYS360:(t,e,r)=>{t=E(t),e=E(e),r=i.accept(r,a.BOOLEAN,!1),31===t.getUTCDate()&&t.setUTCDate(30),!r&&t.getUTCDate()<30&&e.getUTCDate()>30?e.setUTCMonth(e.getUTCMonth()+1,1):31===e.getUTCDate()&&e.setUTCDate(30);const n=e.getUTCFullYear()-t.getUTCFullYear();return 30*(e.getUTCMonth()-t.getUTCMonth())+(e.getUTCDate()-t.getUTCDate())+12*n*30},EDATE:(t,e)=>(t=E(t),e=i.accept(e,a.NUMBER),t.setUTCMonth(t.getUTCMonth()+e),v(t)),EOMONTH:(t,e)=>(t=E(t),e=i.accept(e,a.NUMBER),t.setUTCMonth(t.getUTCMonth()+e+1,0),v(t)),HOUR:t=>E(t).getUTCHours(),ISOWEEKNUM:t=>{const e=E(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),n=r.getUTCDay();r.setUTCDate(r.getUTCDate()+4-n);const o=new Date(Date.UTC(r.getUTCFullYear(),0,1));return Math.ceil(((r-o)/864e5+1)/7)},MINUTE:t=>E(t).getUTCMinutes(),MONTH:t=>E(t).getUTCMonth()+1,NETWORKDAYS:(t,e,r)=>{let n=1;if((t=E(t))>(e=E(e))){n=-1;const r=t;t=e,e=r}const o=[];null!=r&&i.flattenParams([r],a.NUMBER,!1,(t=>{o.push(E(t))}));let c=0;for(;t<=e;){if(0!==t.getUTCDay()&&6!==t.getUTCDay()){let e=!1;for(let r=0;r<o.length;r++)if(y(t,o[r])){e=!0;break}e||c++}t.setUTCDate(t.getUTCDate()+1)}return n*c},"NETWORKDAYS.INTL":(t,e,r,o)=>{let c=1;if((t=E(t))>(e=E(e))){c=-1;const r=t;t=e,e=r}if("1111111"===(r=i.accept(r,null,1)))return 0;if("string"==typeof r&&Number(r).toString()!==r){if(7!==r.length)throw n.VALUE;r=r.charAt(6)+r.slice(0,6);const t=[];for(let e=0;e<r.length;e++)"1"===r.charAt(e)&&t.push(e);r=t}else{if("number"!=typeof r)throw n.VALUE;r=f[r]}const s=[];null!=o&&i.flattenParams([o],a.NUMBER,!1,(t=>{s.push(E(t))}));let u=0;for(;t<=e;){let e=!1;for(let n=0;n<r.length;n++)if(r[n]===t.getUTCDay()){e=!0;break}if(!e){let e=!1;for(let r=0;r<s.length;r++)if(y(t,s[r])){e=!0;break}e||u++}t.setUTCDate(t.getUTCDate()+1)}return c*u},NOW:()=>{const t=new Date;return v(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()))+(3600*t.getHours()+60*t.getMinutes()+t.getSeconds())/86400},SECOND:t=>E(t).getUTCSeconds(),TIME:(t,e,r)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),r=i.accept(r,a.NUMBER),t<0||t>32767||e<0||e>32767||r<0||r>32767)throw n.NUM;return(3600*t+60*e+r)/86400},TIMEVALUE:t=>(3600*(t=E(t)).getUTCHours()+60*t.getUTCMinutes()+t.getUTCSeconds())/86400,TODAY:()=>{const t=new Date;return v(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()))},WEEKDAY:(t,e)=>{const r=E(t);e=i.accept(e,a.NUMBER,1);const o=r.getUTCDay(),c=l[e];if(!c)throw n.NUM;return c[o]},WEEKNUM:(t,e)=>{const r=E(t);if(21===(e=i.accept(e,a.NUMBER,1)))return N.ISOWEEKNUM(t);const n=u[e],o=new Date(Date.UTC(r.getUTCFullYear(),0,1)),c=o.getUTCDay()<n?1:0;return Math.ceil(((r-o)/864e5+1)/7)+c},WORKDAY:(t,e,r)=>N["WORKDAY.INTL"](t,e,1,r),"WORKDAY.INTL":(t,e,r,o)=>{if(t=E(t),e=i.accept(e,a.NUMBER),"1111111"===(r=i.accept(r,null,1)))throw n.VALUE;if("string"==typeof r&&Number(r).toString()!==r){if(7!==r.length)throw n.VALUE;r=r.charAt(6)+r.slice(0,6);const t=[];for(let e=0;e<r.length;e++)"1"===r.charAt(e)&&t.push(e);r=t}else{if("number"!=typeof r)throw n.VALUE;if(null==(r=f[r]))throw n.NUM}const c=[];null!=o&&i.flattenParams([o],a.NUMBER,!1,(t=>{c.push(E(t))})),t.setUTCDate(t.getUTCDate()+1);let s=0;for(;s<e;){let e=!1;for(let n=0;n<r.length;n++)if(r[n]===t.getUTCDay()){e=!0;break}if(!e){let e=!1;for(let r=0;r<c.length;r++)if(y(t,c[r])){e=!0;break}e||s++}t.setUTCDate(t.getUTCDate()+1)}return v(t)-1},YEAR:t=>E(t).getUTCFullYear(),YEARFRAC:(t,e,r)=>{if((t=E(t))>(e=E(e))){const r=t;t=e,e=r}if(r=i.accept(r,a.NUMBER,0),(r=Math.trunc(r))<0||r>4)throw n.VALUE;let o=t.getUTCDate();const c=t.getUTCMonth()+1,s=t.getUTCFullYear();let u=e.getUTCDate();const l=e.getUTCMonth()+1,f=e.getUTCFullYear();switch(r){case 0:return 31===o&&31===u?(o=30,u=30):31===o?o=30:30===o&&31===u&&(u=30),Math.abs(u+30*l+360*f-(o+30*c+360*s))/360;case 1:if(f-s<2){const r=1900!==(h=s)&&1!==new Date(h,1,29).getMonth()||1900===s?365:366;return N.DAYS(e,t)/r}{const r=f-s+1,n=(new Date(f+1,0,1)-new Date(s,0,1))/1e3/60/60/24/r;return N.DAYS(e,t)/n}case 2:return Math.abs(N.DAYS(e,t)/360);case 3:return Math.abs(N.DAYS(e,t)/365);case 4:return Math.abs(u+30*l+360*f-(o+30*c+360*s))/360}var h}};t.exports=N},5788:(t,e,r)=>{const n=r(5908),{FormulaHelpers:o,Types:a}=r(3060),i=o,c=r(6572),s=r(3928),u={"BETA.DIST":(t,e,r,o,s,u)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),r=i.accept(r,a.NUMBER),o=i.accept(o,a.BOOLEAN),s=i.accept(s,a.NUMBER,0),u=i.accept(u,a.NUMBER,1),e<=0||r<=0||t<s||t>u||s===u)throw n.NUM;return t=(t-s)/(u-s),o?c.beta.cdf(t,e,r):c.beta.pdf(t,e,r)/(u-s)},"BETA.INV":(t,e,r,o,s)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),r=i.accept(r,a.NUMBER),o=i.accept(o,a.NUMBER,0),s=i.accept(s,a.NUMBER,1),e<=0||r<=0||t<=0||t>1)throw n.NUM;return c.beta.inv(t,e,r)*(s-o)+o},"BINOM.DIST":(t,e,r,o)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),r=i.accept(r,a.NUMBER),o=i.accept(o,a.BOOLEAN),e<0||r<0||r>1||t<0||t>e)throw n.NUM;return o?c.binomial.cdf(t,e,r):c.binomial.pdf(t,e,r)},"BINOM.DIST.RANGE":(t,e,r,o)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),r=i.accept(r,a.NUMBER),o=i.accept(o,a.NUMBER,r),t<0||e<0||e>1||r<0||r>t||o<r||o>t)throw n.NUM;let c=0;for(let n=r;n<=o;n++)c+=s.COMBIN(t,n)*Math.pow(e,n)*Math.pow(1-e,t-n);return c},"BINOM.INV":(t,e,r)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),r=i.accept(r,a.NUMBER),t<0||e<0||e>1||r<0||r>1)throw n.NUM;let o=0;for(;o<=t;){if(c.binomial.cdf(o,t,e)>=r)return o;o++}},"CHISQ.DIST":(t,e,r)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),r=i.accept(r,a.NUMBER),e=Math.trunc(e),t<0||e<1||e>10**10)throw n.NUM;return r?c.chisquare.cdf(t,e):c.chisquare.pdf(t,e)},"CHISQ.DIST.RT":(t,e)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),e=Math.trunc(e),t<0||e<1||e>10**10)throw n.NUM;return 1-c.chisquare.cdf(t,e)},"CHISQ.INV":(t,e)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),e=Math.trunc(e),t<0||t>1||e<1||e>10**10)throw n.NUM;return c.chisquare.inv(t,e)},"CHISQ.INV.RT":(t,e)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),e=Math.trunc(e),t<0||t>1||e<1||e>10**10)throw n.NUM;return c.chisquare.inv(1-t,e)},"CHISQ.TEST":(t,e)=>{const r=i.accept(t,a.ARRAY,void 0,!1,!1),o=i.accept(e,a.ARRAY,void 0,!1,!1);if(r.length!==o.length||r[0].length!==o[0].length||1===r.length&&1===r[0].length)throw n.NA;const c=r.length,s=r[0].length;let u=(c-1)*(s-1);u=1===c?s-1:c-1;let l=0;for(let a=0;a<c;a++)for(let t=0;t<s;t++)if("number"==typeof r[a][t]&&"number"==typeof o[a][t]){if(0===o[a][t])throw n.DIV0;l+=Math.pow(r[a][t]-o[a][t],2)/o[a][t]}let f=Math.exp(-.5*l);u%2==1&&(f*=Math.sqrt(2*l/Math.PI));let h=u;for(;h>=2;)f=f*l/h,h-=2;let p=f,d=u;for(;p>1e-15*f;)d+=2,p=p*l/d,f+=p;return 1-f},"CONFIDENCE.NORM":(t,e,r)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),r=i.accept(r,a.NUMBER),r=Math.trunc(r),t<=0||t>=1||e<=0||r<1)throw n.NUM;return c.normalci(1,t,e,r)[1]-1},"CONFIDENCE.T":(t,e,r)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),r=i.accept(r,a.NUMBER),r=Math.trunc(r),t<=0||t>=1||e<=0||r<1)throw n.NUM;if(1===r)throw n.DIV0;return c.tci(1,t,e,r)[1]-1},CORREL:(t,e)=>{if(t=i.accept(t,a.ARRAY,void 0,!0,!0),e=i.accept(e,a.ARRAY,void 0,!0,!0),t.length!==e.length)throw n.NA;const r=[],o=[];for(let n=0;n<t.length;n++)"number"==typeof t[n]&&"number"==typeof e[n]&&(r.push(t[n]),o.push(e[n]));if(r.length<=1)throw n.DIV0;return c.corrcoeff(r,o)},"COVARIANCE.P":(t,e)=>{if(t=i.accept(t,a.ARRAY,void 0,!0,!0),e=i.accept(e,a.ARRAY,void 0,!0,!0),t.length!==e.length)throw n.NA;const r=[],o=[];for(let n=0;n<t.length;n++)"number"==typeof t[n]&&"number"==typeof e[n]&&(r.push(t[n]),o.push(e[n]));const s=c.mean(r),u=c.mean(o);let l=0;for(let n=0;n<r.length;n++)l+=(r[n]-s)*(o[n]-u);return l/r.length},"COVARIANCE.S":(t,e)=>{if(t=i.accept(t,a.ARRAY,void 0,!0,!0),e=i.accept(e,a.ARRAY,void 0,!0,!0),t.length!==e.length)throw n.NA;const r=[],o=[];for(let n=0;n<t.length;n++)"number"==typeof t[n]&&"number"==typeof e[n]&&(r.push(t[n]),o.push(e[n]));if(r.length<=1)throw n.DIV0;return c.covariance(r,o)},DEVSQ:(...t)=>{let e=0,r=[];i.flattenParams(t,a.NUMBER,!0,((t,n)=>{"number"==typeof t&&(e+=t,r.push(t))}));const n=e/r.length;e=0;for(let o=0;o<r.length;o++)e+=(r[o]-n)**2;return e},"EXPON.DIST":(t,e,r)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),r=i.accept(r,a.BOOLEAN),t<0||e<=0)throw n.NUM;return r?c.exponential.cdf(t,e):c.exponential.pdf(t,e)},"F.DIST":(t,e,r,o)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),r=i.accept(r,a.NUMBER),o=i.accept(o,a.BOOLEAN),t<0||e<1||r<1)throw n.NUM;return e=Math.trunc(e),r=Math.trunc(r),o?c.centralF.cdf(t,e,r):c.centralF.pdf(t,e,r)},"F.DIST.RT":(t,e,r)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),r=i.accept(r,a.NUMBER),t<0||e<1||r<1)throw n.NUM;return e=Math.trunc(e),r=Math.trunc(r),1-c.centralF.cdf(t,e,r)},"F.INV":(t,e,r)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),r=i.accept(r,a.NUMBER),t<0||t>1)throw n.NUM;if(e<1||r<1)throw n.NUM;return e=Math.trunc(e),r=Math.trunc(r),c.centralF.inv(t,e,r)},"F.INV.RT":(t,e,r)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),r=i.accept(r,a.NUMBER),t<0||t>1)throw n.NUM;if(e<1||e>=Math.pow(10,10))throw n.NUM;if(r<1||r>=Math.pow(10,10))throw n.NUM;return e=Math.trunc(e),r=Math.trunc(r),c.centralF.inv(1-t,e,r)},"F.TEST":(t,e)=>{t=i.accept(t,a.ARRAY,void 0,!0,!0),e=i.accept(e,a.ARRAY,void 0,!0,!0);const r=[],o=[];let s=0,u=0;for(let n=0;n<Math.max(t.length,e.length);n++)"number"==typeof t[n]&&(r.push(t[n]),s+=t[n]),"number"==typeof e[n]&&(o.push(e[n]),u+=e[n]);if(r.length<=1||o.length<=1)throw n.DIV0;s/=r.length,u/=o.length;let l=0,f=0;for(let n=0;n<r.length;n++)l+=(s-r[n])**2;l/=r.length-1;for(let n=0;n<o.length;n++)f+=(u-o[n])**2;return f/=o.length-1,2*c.centralF.cdf(l/f,r.length-1,o.length-1)},FISHER:t=>{if((t=i.accept(t,a.NUMBER))<=-1||t>=1)throw n.NUM;return Math.log((1+t)/(1-t))/2},FISHERINV:t=>{t=i.accept(t,a.NUMBER);let e=Math.exp(2*t);return(e-1)/(e+1)},FORECAST:(t,e,r)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.ARRAY,void 0,!0,!0),(r=i.accept(r,a.ARRAY,void 0,!0,!0)).length!==e.length)throw n.NA;const o=[],s=[];let u=!0;for(let n=0;n<e.length;n++)"number"==typeof e[n]&&"number"==typeof r[n]&&(o.push(e[n]),s.push(r[n]),r[n]!==r[0]&&(u=!1));if(u)throw n.DIV0;const l=c.mean(o),f=c.mean(s);let h=0,p=0;for(let n=0;n<o.length;n++)h+=(s[n]-f)*(o[n]-l),p+=(s[n]-f)**2;const d=h/p;return l-d*f+d*t},"FORECAST.ETS":()=>{},"FORECAST.ETS.CONFINT":()=>{},"FORECAST.ETS.SEASONALITY":()=>{},"FORECAST.ETS.STAT":()=>{},"FORECAST.LINEAR":(...t)=>u.FORECAST(...t),FREQUENCY:(t,e)=>{t=i.accept(t,a.ARRAY,void 0,!0,!0),e=i.accept(e,a.ARRAY,void 0,!0,!0);const r=[];for(let o=0;o<e.length;o++)"number"==typeof e[o]&&r.push(e[o]);r.sort(),r.push(1/0);const n=[];for(let o=0;o<r.length;o++){n[o]=[],n[o][0]=0;for(let e=0;e<t.length;e++){if("number"!=typeof t[e])continue;t[e]<=r[o]&&(n[o][0]++,t[e]=null)}}return n},GAMMA:t=>{if(0===(t=i.accept(t,a.NUMBER))||t<0&&t===Math.trunc(t))throw n.NUM;return c.gammafn(t)},"GAMMA.DIST":(t,e,r,o)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),r=i.accept(r,a.NUMBER),o=i.accept(o,a.BOOLEAN),t<0||e<=0||r<=0)throw n.NUM;return o?c.gamma.cdf(t,e,r,!0):c.gamma.pdf(t,e,r,!1)},"GAMMA.INV":(t,e,r)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),r=i.accept(r,a.NUMBER),t<0||t>1||e<=0||r<=0)throw n.NUM;return c.gamma.inv(t,e,r)},GAMMALN:t=>{if((t=i.accept(t,a.NUMBER))<=0)throw n.NUM;return c.gammaln(t)},"GAMMALN.PRECISE":t=>{if((t=i.accept(t,a.NUMBER))<=0)throw n.NUM;return c.gammaln(t)},GAUSS:t=>(t=i.accept(t,a.NUMBER),c.normal.cdf(t,0,1)-.5),GEOMEAN:(...t)=>{const e=[];return i.flattenParams(t,a.NUMBER,!0,((t,r)=>{"number"==typeof t&&e.push(t)})),c.geomean(e)},GROWTH:(t,e,r,o)=>{t=i.accept(t,a.ARRAY,void 0,!0,!0);for(let a=0;a<t.length;a++)if("number"!=typeof t[a])throw n.VALUE;const c=null==(e=i.accept(e,a.ARRAY,null,!0,!0));if(null==e){e=[];for(let r=1;r<=t.length;r++)e.push(r)}else{if(e.length!==t.length)throw n.REF;for(let t=0;t<e.length;t++)if("number"!=typeof e[t])throw n.VALUE}if(null==(r=i.accept(r,a.ARRAY,null,!1,!0))&&c){r=[];for(let e=1;e<=t.length;e++)r.push(e);r=[r]}else null==r&&(r=Array.isArray(e[0])?e:[e]);o=i.accept(o,a.BOOLEAN,!0);const s=t.length;let u,l,f=0,h=0,p=0,d=0;for(let n=0;n<s;n++){const r=e[n],o=Math.log(t[n]);f+=r,h+=o,p+=r*o,d+=r*r}f/=s,h/=s,p/=s,d/=s,o?(u=(p-f*h)/(d-f*f),l=h-u*f):(u=p/d,l=0);const m=[];for(let a=0;a<r.length;a++){m[a]=[];for(let t=0;t<r[0].length;t++){if("number"!=typeof r[a][t])throw n.VALUE;m[a][t]=Math.exp(l+u*r[a][t])}}return m},HARMEAN:(...t)=>{let e=0,r=0;return i.flattenParams(t,a.NUMBER,!0,((t,n)=>{"number"==typeof t&&(r+=1/t,e++)})),e/r},"HYPGEOM.DIST":(t,e,r,o,c)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),r=i.accept(r,a.NUMBER),o=i.accept(o,a.NUMBER),c=i.accept(c,a.BOOLEAN),t=Math.trunc(t),e=Math.trunc(e),r=Math.trunc(r),(o=Math.trunc(o))<=0||t<0||e<=0||r<=0)throw n.NUM;if(e>o)throw n.NUM;if(r>o)throw n.NUM;if(e<t||r<t)throw n.NUM;if(t<e-o+r)throw n.NUM;function u(t,e,r,n){return s.COMBIN(r,t)*s.COMBIN(n-r,e-t)/s.COMBIN(n,e)}return c?function(t,e,r,n){let o=0;for(let a=0;a<=t;a++)o+=u(a,e,r,n);return o}(t,e,r,o):u(t,e,r,o)},INTERCEPT:(t,e)=>{if(t=i.accept(t,a.ARRAY,void 0,!0,!0),(e=i.accept(e,a.ARRAY,void 0,!0,!0)).length!==t.length)throw n.NA;const r=[],o=[];for(let n=0;n<t.length;n++)"number"==typeof t[n]&&"number"==typeof e[n]&&(r.push(t[n]),o.push(e[n]));if(r.length<=1)throw n.DIV0;const s=c.mean(r),u=c.mean(o);let l=0,f=0;for(let n=0;n<r.length;n++)l+=(o[n]-u)*(r[n]-s),f+=(o[n]-u)**2;return s-l/f*u},KURT:(...t)=>{let e=0,r=[];i.flattenParams(t,a.NUMBER,!0,((t,n)=>{"number"==typeof t&&(e+=t,r.push(t))}));const n=r.length;e/=n;let o=0;for(let a=0;a<n;a++)o+=Math.pow(r[a]-e,4);return o/=Math.pow(c.stdev(r,!0),4),n*(n+1)/((n-1)*(n-2)*(n-3))*o-3*(n-1)*(n-1)/((n-2)*(n-3))},LINEST:()=>{},LOGEST:()=>{},"LOGNORM.DIST":(t,e,r,o)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),r=i.accept(r,a.NUMBER),o=i.accept(o,a.BOOLEAN),t<=0||r<=0)throw n.NUM;return o?c.lognormal.cdf(t,e,r):c.lognormal.pdf(t,e,r)},"LOGNORM.INV":(t,e,r)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),r=i.accept(r,a.NUMBER),t<=0||t>=1)throw n.NUM;if(r<=0)throw n.NUM;return c.lognormal.inv(t,e,r)},"MODE.MULT":()=>{},"MODE.SNGL":()=>{},"NEGBINOM.DIST":(t,e,r,o)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),r=i.accept(r,a.NUMBER),o=i.accept(o,a.BOOLEAN),t=Math.trunc(t),e=Math.trunc(e),r<0||r>1)throw n.NUM;if(t<0||e<1)throw n.NUM;return o?c.negbin.cdf(t,e,r):c.negbin.pdf(t,e,r)},"NORM.DIST":(t,e,r,o)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),r=i.accept(r,a.NUMBER),o=i.accept(o,a.BOOLEAN),r<=0)throw n.NUM;return o?c.normal.cdf(t,e,r):c.normal.pdf(t,e,r)},"NORM.INV":(t,e,r)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),r=i.accept(r,a.NUMBER),t<=0||t>=1)throw n.NUM;if(r<=0)throw n.NUM;return c.normal.inv(t,e,r)},"NORM.S.DIST":(t,e)=>(t=i.accept(t,a.NUMBER),(e=i.accept(e,a.BOOLEAN))?c.normal.cdf(t,0,1):c.normal.pdf(t,0,1)),"NORM.S.INV":t=>{if((t=i.accept(t,a.NUMBER))<=0||t>=1)throw n.NUM;return c.normal.inv(t,0,1)},PEARSON:()=>{},"PERCENTILE.EXC":()=>{},"PERCENTILE.INC":()=>{},"PERCENTRANK.EXC":()=>{},"PERCENTRANK.INC":()=>{},PERMUTATIONA:()=>{},PHI:t=>(t=i.accept(t,a.NUMBER),Math.exp(-.5*t*t)/2.5066282746310002),"POISSON.DIST":(t,e,r)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),r=i.accept(r,a.BOOLEAN),t<0||e<0)throw n.NUM;return t=Math.trunc(t),r?c.poisson.cdf(t,e):c.poisson.pdf(t,e)},PROB:()=>{},"QUARTILE.EXC":()=>{},"QUARTILE.INC":()=>{},"RANK.AVG":()=>{},"RANK.EQ":()=>{},RSQ:()=>{},SKEW:()=>{},"SKEW.P":()=>{},SLOPE:()=>{},STANDARDIZE:(t,e,r)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),(r=i.accept(r,a.NUMBER))<=0)throw n.NUM;return(t-e)/r},"STDEV.P":()=>{},"STDEV.S":()=>{},STDEVA:()=>{},STDEVPA:()=>{},STEYX:()=>{},"T.DIST":(t,e,r)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),r=i.accept(r,a.BOOLEAN),e<1)throw n.NUM;return r?c.studentt.cdf(t,e):c.studentt.pdf(t,e)},"T.DIST.2T":(t,e)=>{if(t=i.accept(t,a.NUMBER),(e=i.accept(e,a.NUMBER))<1||t<0)throw n.NUM;return 2*(1-c.studentt.cdf(t,e))},"T.DIST.RT":(t,e)=>{if(t=i.accept(t,a.NUMBER),(e=i.accept(e,a.NUMBER))<1)throw n.NUM;return 1-c.studentt.cdf(t,e)},"T.INV":(t,e)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),t<=0||t>1||e<1)throw n.NUM;return e=e%1==0?e:Math.trunc(e),c.studentt.inv(t,e)},"T.INV.2T":(t,e)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),t<=0||t>1||e<1)throw n.NUM;return e=e%1==0?e:Math.trunc(e),Math.abs(c.studentt.inv(t/2,e))},"T.TEST":()=>{},TREND:()=>{},TRIMMEAN:()=>{},"VAR.P":()=>{},"VAR.S":()=>{},VARA:()=>{},VARPA:()=>{},"WEIBULL.DIST":(t,e,r,o)=>{if(t=i.accept(t,a.NUMBER),e=i.accept(e,a.NUMBER),r=i.accept(r,a.NUMBER),o=i.accept(o,a.BOOLEAN),t<0||e<=0||r<=0)throw n.NUM;return o?1-Math.exp(-Math.pow(t/r,e)):Math.pow(t,e-1)*Math.exp(-Math.pow(t/r,e))*e/Math.pow(r,e)},"Z.TEST":()=>{}};t.exports={DistributionFunctions:u}},2987:(t,e,r)=>{const n=r(5908),o=r(6693),{FormulaHelpers:a,Types:i}=r(3060),c=a,s=r(4809),u=r(6572),l=-512,f=/^\s?[+-]?\s?[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?\s?$/,h=/^\s?([+-]?\s?([0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)?)\s?[ij]\s?$/,p=/^\s?([+-]?\s?[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)\s?([+-]?\s?([0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)?)\s?[ij]\s?$/;function d(t){let e=0,r=0,o="i";if("number"==typeof(t=c.accept(t)))return{real:t,im:r,unit:o};if("boolean"==typeof t)throw n.VALUE;let a=t.match(f);if(a)return e=Number(a[0]),{real:e,im:r,unit:o};if(a=t.match(h),a)return r=Number(/^\s?[+-]?\s?$/.test(a[1])?a[1]+"1":a[1]),o=a[0].slice(-1),{real:e,im:r,unit:o};if(a=t.match(p),a)return e=Number(a[1]),r=Number(/^\s?[+-]?\s?$/.test(a[3])?a[3]+"1":a[3]),o=a[0].slice(-1),{real:e,im:r,unit:o};throw n.NUM}const m={BESSELI:(t,e)=>{if(t=c.accept(t,i.NUMBER_NO_BOOLEAN),e=c.accept(e,i.NUMBER_NO_BOOLEAN),(e=Math.trunc(e))<0)throw n.NUM;return s.besseli(t,e)},BESSELJ:(t,e)=>{if(t=c.accept(t,i.NUMBER_NO_BOOLEAN),e=c.accept(e,i.NUMBER_NO_BOOLEAN),(e=Math.trunc(e))<0)throw n.NUM;return s.besselj(t,e)},BESSELK:(t,e)=>{if(t=c.accept(t,i.NUMBER_NO_BOOLEAN),e=c.accept(e,i.NUMBER_NO_BOOLEAN),(e=Math.trunc(e))<0)throw n.NUM;return s.besselk(t,e)},BESSELY:(t,e)=>{if(t=c.accept(t,i.NUMBER_NO_BOOLEAN),e=c.accept(e,i.NUMBER_NO_BOOLEAN),(e=Math.trunc(e))<0)throw n.NUM;return s.bessely(t,e)},BIN2DEC:t=>{let e=(t=c.accept(t,i.NUMBER_NO_BOOLEAN)).toString();if(e.length>10)throw n.NUM;return 10===e.length&&"1"===e.substring(0,1)?parseInt(e.substring(1),2)+l:parseInt(e,2)},BIN2HEX:(t,e)=>{t=c.accept(t,i.NUMBER_NO_BOOLEAN),e=c.accept(e,i.NUMBER_NO_BOOLEAN,null);const r=t.toString();if(r.length>10)throw n.NUM;if(10===r.length&&"1"===r.substring(0,1))return(parseInt(r.substring(1),2)+0xfffffffe00).toString(16).toUpperCase();const a=parseInt(t,2).toString(16);if(null==e)return a.toUpperCase();if(e<0)throw n.NUM;if((e=Math.trunc(e))>=a.length)return(o.REPT("0",e-a.length)+a).toUpperCase();throw n.NUM},BIN2OCT:(t,e)=>{t=c.accept(t,i.NUMBER_NO_BOOLEAN),e=c.accept(e,i.NUMBER,null);let r=t.toString();if(r.length>10)throw n.NUM;if(10===r.length&&"1"===r.substr(0,1))return(parseInt(r.substr(1),2)+1073741312).toString(8);let a=parseInt(t,2).toString(8);if(null==e)return a.toUpperCase();if(e<0)throw n.NUM;if((e=Math.trunc(e))>=a.length)return o.REPT("0",e-a.length)+a;throw n.NUM},BITAND:(t,e)=>{if(t=c.accept(t,i.NUMBER),e=c.accept(e,i.NUMBER),t<0||e<0)throw n.NUM;if(Math.floor(t)!==t||Math.floor(e)!==e)throw n.NUM;if(t>0xffffffffffff||e>0xffffffffffff)throw n.NUM;return t&e},BITLSHIFT:(t,e)=>{if(t=c.accept(t,i.NUMBER),e=c.accept(e,i.NUMBER),e=Math.trunc(e),Math.abs(e)>53)throw n.NUM;if(t<0||Math.floor(t)!==t||t>0xffffffffffff)throw n.NUM;const r=e>=0?t*2**e:Math.trunc(t/2**-e);if(r>0xffffffffffff)throw n.NUM;return r},BITOR:(t,e)=>{if(t=c.accept(t,i.NUMBER),e=c.accept(e,i.NUMBER),t<0||e<0)throw n.NUM;if(Math.floor(t)!==t||Math.floor(e)!==e)throw n.NUM;if(t>0xffffffffffff||e>0xffffffffffff)throw n.NUM;return t|e},BITRSHIFT:(t,e)=>(t=c.accept(t,i.NUMBER),e=c.accept(e,i.NUMBER),m.BITLSHIFT(t,-e)),BITXOR:(t,e)=>{if(t=c.accept(t,i.NUMBER),e=c.accept(e,i.NUMBER),t<0||t>0xffffffffffff||Math.floor(t)!==t)throw n.NUM;if(e<0||e>0xffffffffffff||Math.floor(e)!==e)throw n.NUM;return t^e},COMPLEX:(t,e,r)=>{if(t=c.accept(t,i.NUMBER_NO_BOOLEAN),e=c.accept(e,i.NUMBER_NO_BOOLEAN),"i"!==(r=c.accept(r,i.STRING,"i"))&&"j"!==r)throw n.VALUE;if(0===t&&0===e)return 0;if(0===t)return 1===e?r:-1===e?"-"+r:e.toString()+r;if(0===e)return t.toString();{let n=e>0?"+":"";return 1===e?t.toString()+n+r:-1===e?t.toString()+n+"-"+r:t.toString()+n+e.toString()+r}},DEC2BIN:(t,e)=>{if(t=c.accept(t,i.NUMBER),e=c.accept(e,i.NUMBER,null),t<l||t>511)throw n.NUM;if(t<0)return"1"+o.REPT("0",9-(512+t).toString(2).length)+(512+t).toString(2);let r=parseInt(t,10).toString(2);if(null==e)return r;if((e=Math.trunc(e))<=0)throw n.NUM;if(e<r.length)throw n.NUM;return o.REPT("0",e-r.length)+r},DEC2HEX:(t,e)=>{if(t=c.accept(t,i.NUMBER),e=c.accept(e,i.NUMBER,null),t<-549755813888||t>549755813888)throw n.NUM;if(t<0)return(1099511627776+t).toString(16).toUpperCase();let r=parseInt(t,10).toString(16);if(null==e)return r.toUpperCase();if((e=Math.trunc(e))<=0)throw n.NUM;if(e<r.length)throw n.NUM;return o.REPT("0",e-r.length)+r.toUpperCase()},DEC2OCT:(t,e)=>{if(t=c.accept(t,i.NUMBER),e=c.accept(e,i.NUMBER,null),t<-536870912||t>536870912)throw n.NUM;if(t<0)return(t+1073741824).toString(8);let r=parseInt(t,10).toString(8);if(null==e)return r.toUpperCase();if((e=Math.trunc(e))<=0)throw n.NUM;if(e<r.length)throw n.NUM;return o.REPT("0",e-r.length)+r},DELTA:(t,e)=>(t=c.accept(t,i.NUMBER_NO_BOOLEAN))===(e=c.accept(e,i.NUMBER_NO_BOOLEAN,0))?1:0,ERF:(t,e)=>(t=c.accept(t,i.NUMBER_NO_BOOLEAN),e=c.accept(e,i.NUMBER_NO_BOOLEAN,0),u.erf(t)),ERFC:t=>(t=c.accept(t,i.NUMBER_NO_BOOLEAN),u.erfc(t)),GESTEP:(t,e)=>(t=c.accept(t,i.NUMBER_NO_BOOLEAN))>=(e=c.accept(e,i.NUMBER_NO_BOOLEAN,0))?1:0,HEX2BIN:(t,e)=>{if(t=c.accept(t,i.STRING),e=c.accept(e,i.NUMBER,null),t.length>10||!/^[0-9a-fA-F]*$/.test(t))throw n.NUM;let r=10===t.length&&"f"===t.substr(0,1).toLowerCase(),a=r?parseInt(t,16)-1099511627776:parseInt(t,16);if(a<l||a>511)throw n.NUM;if(r)return"1"+o.REPT("0",9-(a+512).toString(2).length)+(a+512).toString(2);let s=a.toString(2);if(null==e)return s;if((e=Math.trunc(e))<=0||e<s.length)throw n.NUM;return o.REPT("0",e-s.length)+s},HEX2DEC:t=>{if((t=c.accept(t,i.STRING)).length>10||!/^[0-9a-fA-F]*$/.test(t))throw n.NUM;let e=parseInt(t,16);return e>=549755813888?e-1099511627776:e},HEX2OCT:(t,e)=>{if((t=c.accept(t,i.STRING)).length>10||!/^[0-9a-fA-F]*$/.test(t))throw n.NUM;let r=m.HEX2DEC(t);if(r>536870911||r<-536870912)throw n.NUM;return m.DEC2OCT(r,e)},IMABS:t=>{const{real:e,im:r}=d(t);return Math.sqrt(Math.pow(e,2)+Math.pow(r,2))},IMAGINARY:t=>d(t).im,IMARGUMENT:t=>{const{real:e,im:r}=d(t);if(0===e&&0===r)throw n.DIV0;return 0===e&&r>0?Math.PI/2:0===e&&r<0?-Math.PI/2:e<0&&0===r?Math.PI:e>0&&0===r?0:e>0?Math.atan(r/e):e<0&&r>0?Math.atan(r/e)+Math.PI:Math.atan(r/e)-Math.PI},IMCONJUGATE:t=>{const{real:e,im:r,unit:n}=d(t);return 0!==r?m.COMPLEX(e,-r,n):""+e},IMCOS:t=>{const{real:e,im:r,unit:n}=d(t);let o=Math.cos(e)*(Math.exp(r)+Math.exp(-r))/2,a=-Math.sin(e)*(Math.exp(r)-Math.exp(-r))/2;return m.COMPLEX(o,a,n)},IMCOSH:t=>{const{real:e,im:r,unit:n}=d(t);let o=Math.cos(r)*(Math.exp(e)+Math.exp(-e))/2,a=-Math.sin(r)*(Math.exp(e)-Math.exp(-e))/2;return m.COMPLEX(o,-a,n)},IMCOT:t=>{t=c.accept(t);let e=m.IMCOS(t),r=m.IMSIN(t);return m.IMDIV(e,r)},IMCSC:t=>(t=c.accept(t),m.IMDIV("1",m.IMSIN(t))),IMCSCH:t=>(t=c.accept(t),m.IMDIV("1",m.IMSINH(t))),IMDIV:(t,e)=>{const r=d(t),o=r.real,a=r.im,i=r.unit,c=d(e),s=c.real,u=c.im,l=c.unit;if(0===s&&0===u||i!==l)throw n.NUM;let f=i,h=Math.pow(s,2)+Math.pow(u,2);return m.COMPLEX((o*s+a*u)/h,(a*s-o*u)/h,f)},IMEXP:t=>{const{real:e,im:r,unit:n}=d(t);let o=Math.exp(e);return m.COMPLEX(o*Math.cos(r),o*Math.sin(r),n)},IMLN:t=>{const{real:e,im:r,unit:n}=d(t);return m.COMPLEX(Math.log(Math.sqrt(Math.pow(e,2)+Math.pow(r,2))),Math.atan(r/e),n)},IMLOG10:t=>{const{real:e,im:r,unit:n}=d(t);let o=Math.log(Math.sqrt(Math.pow(e,2)+Math.pow(r,2)))/Math.log(10),a=Math.atan(r/e)/Math.log(10);return m.COMPLEX(o,a,n)},IMLOG2:t=>{const{real:e,im:r,unit:n}=d(t);let o=Math.log(Math.sqrt(Math.pow(e,2)+Math.pow(r,2)))/Math.log(2),a=Math.atan(r/e)/Math.log(2);return m.COMPLEX(o,a,n)},IMPOWER:(t,e)=>{let{unit:r}=d(t);e=c.accept(e,i.NUMBER_NO_BOOLEAN);let n=Math.pow(m.IMABS(t),e),o=m.IMARGUMENT(t),a=n*Math.cos(e*o),s=n*Math.sin(e*o);return m.COMPLEX(a,s,r)},IMPRODUCT:(...t)=>{let e,r=0;return c.flattenParams(t,null,!1,(t=>{if(0===r)e=c.accept(t),d(e);else{const r=d(e),o=r.real,a=r.im,i=r.unit,c=d(t),s=c.real,u=c.im;if(i!==c.unit)throw n.VALUE;e=m.COMPLEX(o*s-a*u,o*u+a*s)}r++}),1),e},IMREAL:t=>d(t).real,IMSEC:t=>m.IMDIV("1",m.IMCOS(t)),IMSECH:t=>m.IMDIV("1",m.IMCOSH(t)),IMSIN:t=>{const{real:e,im:r,unit:n}=d(t);let o=Math.sin(e)*(Math.exp(r)+Math.exp(-r))/2,a=Math.cos(e)*(Math.exp(r)-Math.exp(-r))/2;return m.COMPLEX(o,a,n)},IMSINH:t=>{const{real:e,im:r,unit:n}=d(t);let o=Math.cos(r)*(Math.exp(e)-Math.exp(-e))/2,a=Math.sin(r)*(Math.exp(e)+Math.exp(-e))/2;return m.COMPLEX(o,a,n)},IMSQRT:t=>{const{unit:e}=d(t);let r=Math.sqrt(m.IMABS(t)),n=m.IMARGUMENT(t);return m.COMPLEX(r*Math.cos(n/2),r*Math.sin(n/2),e)},IMSUB:(t,e)=>{const r=d(t),o=r.real,a=r.im,i=r.unit,c=d(e),s=c.real,u=c.im;if(i!==c.unit)throw n.VALUE;return m.COMPLEX(o-s,a-u,i)},IMSUM:(...t)=>{let e,r=0,o=0;return c.flattenParams(t,null,!1,(t=>{const{real:a,im:i,unit:c}=d(t);if(e||(e=c),e!==c)throw n.VALUE;r+=a,o+=i})),m.COMPLEX(r,o,e)},IMTAN:t=>{const{unit:e}=d(t);return m.IMDIV(m.IMSIN(t),m.IMCOS(t),e)},OCT2BIN:(t,e)=>{if(t=c.accept(t,i.STRING),e=c.accept(e,i.NUMBER,null),t.length>10)throw n.NUM;if(e>10)throw n.NUM;if(null!==e&&e<0)throw n.NUM;e=Math.trunc(e);let r=10===t.length&&"7"===t.substring(0,1),a=m.OCT2DEC(t);if(a<l||a>511)return n.NUM;if(r)return"1"+o.REPT("0",9-(512+a).toString(2).length)+(512+a).toString(2);let s=a.toString(2);if(0===e)return s;if(e<s.length)throw n.NUM;return o.REPT("0",e-s.length)+s},OCT2DEC:t=>{if((t=c.accept(t,i.STRING)).length>10)throw n.NUM;for(const r of t)if(r<"0"||r>"7")throw n.NUM;let e=parseInt(t,8);return e>=536870912?e-1073741824:e},OCT2HEX:(t,e)=>{if(t=c.accept(t,i.STRING),e=c.accept(e,i.NUMBER_NO_BOOLEAN,null),t.length>10)throw n.NUM;for(const o of t)if(o<"0"||o>"7")throw n.NUM;if((e=Math.trunc(e))<0||e>10)throw n.NUM;let r=m.OCT2DEC(t),a=m.DEC2HEX(r);if(0===e)return a;if(e<a.length)throw n.NUM;return o.REPT("0",e-a.length)+a}};t.exports=m},5714:(t,e,r)=>{const n=r(5908),{FormulaHelpers:o,Types:a}=r(3060),i=o,c={"#NULL!":1,"#DIV/0!":2,"#VALUE!":3,"#REF!":4,"#NAME?":5,"#NUM!":6,"#N/A":7},s={CELL:(t,e)=>{},"ERROR.TYPE":t=>{if((t=i.accept(t))instanceof n)return c[t.toString()];throw n.NA},INFO:()=>{},ISBLANK:t=>!!t.ref&&(null==t.value||""===t.value),ISERR:t=>(t=i.accept(t))instanceof n&&"#N/A"!==t.toString(),ISERROR:t=>(t=i.accept(t))instanceof n,ISEVEN:t=>(t=i.accept(t,a.NUMBER),(t=Math.trunc(t))%2==0),ISLOGICAL:t=>"boolean"==typeof(t=i.accept(t)),ISNA:t=>(t=i.accept(t))instanceof n&&"#N/A"===t.toString(),ISNONTEXT:t=>"string"!=typeof(t=i.accept(t)),ISNUMBER:t=>"number"==typeof(t=i.accept(t)),ISREF:t=>!!t.ref&&((!i.isCellRef(t)||!(t.ref.row>1048576||t.ref.col>16384))&&((!i.isRangeRef(t)||!(t.ref.from.row>1048576||t.ref.from.col>16384||t.ref.to.row>1048576||t.ref.to.col>16384))&&!((t=i.accept(t))instanceof n&&"#REF!"===t.toString()))),ISTEXT:t=>"string"==typeof(t=i.accept(t)),N:t=>{const e=typeof(t=i.accept(t));if("number"===e)return t;if("boolean"===e)return Number(t);if(t instanceof n)throw t;return 0},NA:()=>{throw n.NA},TYPE:t=>{if(t.ref){if(i.isRangeRef(t))return 16;if(i.isCellRef(t)&&"string"==typeof(t=i.accept(t))&&0===t.length)return 1}const e=typeof(t=i.accept(t));return"number"===e?1:"string"===e?2:"boolean"===e?4:t instanceof n?16:Array.isArray(t)?64:void 0}};t.exports=s},3703:(t,e,r)=>{const n=r(5908),{FormulaHelpers:o,Types:a}=r(3060),i=o;function c(t){let e=0,r=0;return i.flattenParams(t,null,!0,(t=>{const n=typeof t;"string"===n?"TRUE"===t?t=!0:"FALSE"===t&&(t=!1):"number"===n&&(t=Boolean(t)),"boolean"==typeof t&&(!0===t?e++:r++)})),[e,r]}const s={AND:(...t)=>{const[e,r]=c(t);return 0===e&&0===r?n.VALUE:e>0&&0===r},FALSE:()=>!1,IF:(t,e,r,n)=>(e=i.accept(e,a.BOOLEAN),r=i.accept(r),n=i.accept(n,null,!1),e?r:n),IFERROR:(t,e)=>t.value instanceof n?i.accept(e):i.accept(t),IFNA:function(t,e){if(arguments.length>2)throw n.TOO_MANY_ARGS("IFNA");return n.NA.equals(t.value)?i.accept(e):i.accept(t)},IFS:(...t)=>{if(t.length%2!=0)return new n("#N/A","IFS expects all arguments after position 0 to be in pairs.");for(let e=0;e<t.length/2;e++){const r=i.accept(t[2*e],a.BOOLEAN),n=i.accept(t[2*e+1]);if(r)return n}return n.NA},NOT:t=>!(t=i.accept(t,a.BOOLEAN)),OR:(...t)=>{const[e,r]=c(t);return 0===e&&0===r?n.VALUE:e>0},SWITCH:(...t)=>{},TRUE:()=>!0,XOR:(...t)=>{const[e,r]=c(t);return 0===e&&0===r?n.VALUE:e%2==1}};t.exports=s},3928:(t,e,r)=>{const n=r(5908),{FormulaHelpers:o,Types:a,Factorials:i,Criteria:c}=r(3060),{Infix:s}=r(227),u=o,l=[],f=[];function h(t){return t<=100?i[t]:l[t]>0?l[t]:l[t]=h(t-1)*t}function p(t){return 1===t||0===t?1:2===t?2:f[t]>0?f[t]:f[t]=p(t-2)*t}const d={ABS:t=>(t=u.accept(t,a.NUMBER),Math.abs(t)),AGGREGATE:(t,e,r,...n)=>{},ARABIC:t=>{if(t=u.accept(t,a.STRING).toUpperCase(),!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(t))throw new n("#VALUE!","Invalid roman numeral in ARABIC evaluation.");let e=0;return t.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,(function(t){e+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[t]})),e},BASE:(t,e,r)=>{if((t=u.accept(t,a.NUMBER))<0||t>=2**53)throw n.NUM;if((e=u.accept(e,a.NUMBER))<2||e>36)throw n.NUM;if((r=u.accept(r,a.NUMBER,0))<0)throw n.NUM;const o=t.toString(e).toUpperCase();return new Array(Math.max(r+1-o.length,0)).join("0")+o},CEILING:(t,e)=>{if(t=u.accept(t,a.NUMBER),0===(e=u.accept(e,a.NUMBER)))return 0;if(t/e%1==0)return t;const r=Math.abs(e),n=Math.floor(Math.abs(t)/r);if(t<0){return e<0?-r*(n+1):-r*n}return(n+1)*r},"CEILING.MATH":(t,e,r)=>{if(t=u.accept(t,a.NUMBER),e=u.accept(e,a.NUMBER,t>0?1:-1),r=u.accept(r,a.NUMBER,0),t>=0)return d.CEILING(t,e);const n=r?e:0;return d.CEILING(t,e)-n},"CEILING.PRECISE":(t,e)=>(t=u.accept(t,a.NUMBER),e=u.accept(e,a.NUMBER,1),d.CEILING(t,Math.abs(e))),COMBIN:(t,e)=>{if(t=u.accept(t,a.NUMBER),e=u.accept(e,a.NUMBER),t<0||e<0||t<e)throw n.NUM;return d.FACT(t)/d.FACT(e)/d.FACT(t-e)},COMBINA:(t,e)=>{if(t=u.accept(t,a.NUMBER),e=u.accept(e,a.NUMBER),(0===t||1===t)&&0===e)return 1;if(t<0||e<0)throw n.NUM;return d.COMBIN(t+e-1,t-1)},DECIMAL:(t,e)=>{if(t=u.accept(t,a.STRING),e=u.accept(e,a.NUMBER),(e=Math.trunc(e))<2||e>36)throw n.NUM;const r=parseInt(t,e);if(isNaN(r))throw n.NUM;return r},DEGREES:t=>(t=u.accept(t,a.NUMBER))*(180/Math.PI),EVEN:t=>d.CEILING(t,-2),EXP:t=>(t=u.accept(t,a.NUMBER),Math.exp(t)),FACT:t=>{if(t=u.accept(t,a.NUMBER),(t=Math.trunc(t))>170||t<0)throw n.NUM;return t<=100?i[t]:h(t)},FACTDOUBLE:t=>{if(t=u.accept(t,a.NUMBER),(t=Math.trunc(t))<-1)throw n.NUM;return-1===t?1:p(t)},FLOOR:(t,e)=>{if(t=u.accept(t,a.NUMBER),0===(e=u.accept(e,a.NUMBER)))return 0;if(t>0&&e<0)throw n.NUM;if(t/e%1==0)return t;const r=Math.abs(e),o=Math.floor(Math.abs(t)/r);if(t<0){return e<0?-r*o:-r*(o+1)}return o*r},"FLOOR.MATH":(t,e,r)=>(t=u.accept(t,a.NUMBER),e=u.accept(e,a.NUMBER,t>0?1:-1),0===(r=u.accept(r,a.NUMBER,0))||t>=0?d.FLOOR(t,Math.abs(e)):d.FLOOR(t,e)+e),"FLOOR.PRECISE":(t,e)=>(t=u.accept(t,a.NUMBER),e=u.accept(e,a.NUMBER,1),d.FLOOR(t,Math.abs(e))),GCD:(...t)=>{const e=[];u.flattenParams(t,null,!1,(t=>{if(t="boolean"==typeof t?NaN:Number(t),isNaN(t))throw n.VALUE;if(t<0||t>9007199254740990)throw n.NUM;e.push(Math.trunc(t))}),0);let r,o,a=t.length,i=Math.abs(e[0]);for(r=1;r<a;r++){for(o=Math.abs(e[r]);i&&o;)i>o?i%=o:o%=i;i+=o}return i},INT:t=>(t=u.accept(t,a.NUMBER),Math.floor(t)),"ISO.CEILING":(...t)=>d["CEILING.PRECISE"](...t),LCM:(...t)=>{const e=[];u.flattenParams(t,null,!1,(t=>{if(t="boolean"==typeof t?NaN:Number(t),isNaN(t))throw n.VALUE;if(t<0||t>9007199254740990)throw n.NUM;e.push(Math.trunc(t))}),1);let r=e.length,o=Math.abs(e[0]);for(let n=1;n<r;n++){let t=Math.abs(e[n]),r=o;for(;o&&t;)o>t?o%=t:t%=o;o=Math.abs(r*e[n])/(o+t)}return o},LN:t=>(t=u.accept(t,a.NUMBER),Math.log(t)),LOG:(t,e)=>(t=u.accept(t,a.NUMBER),e=u.accept(e,a.NUMBER,10),Math.log(t)/Math.log(e)),LOG10:t=>(t=u.accept(t,a.NUMBER),Math.log10(t)),MDETERM:t=>{if((t=u.accept(t,a.ARRAY,void 0,!1,!0))[0].length!==t.length)throw n.VALUE;const e=t.length,r=t[0].length;let o,i,c=0;if(1===e)return t[0][0];if(2===e)return t[0][0]*t[1][1]-t[0][1]*t[1][0];for(let n=0;n<r;n++){o=t[0][n],i=t[0][n];for(let a=1;a<e;a++)i*=t[a][((n+a)%r+r)%r],o*=t[a][((n-a)%r+r)%r];c+=i-o}return c},MINVERSE:t=>{},MMULT:(t,e)=>{t=u.accept(t,a.ARRAY,void 0,!1,!0),e=u.accept(e,a.ARRAY,void 0,!1,!0);const r=t.length,o=t[0].length,i=e.length,c=e[0].length,s=new Array(r);if(o!==i)throw n.VALUE;for(let a=0;a<r;a++){s[a]=new Array(c);for(let r=0;r<c;r++){s[a][r]=0;for(let i=0;i<o;i++){const o=t[a][i],c=e[i][r];if("number"!=typeof o||"number"!=typeof c)throw n.VALUE;s[a][r]+=t[a][i]*e[i][r]}}}return s},MOD:(t,e)=>{if(t=u.accept(t,a.NUMBER),0===(e=u.accept(e,a.NUMBER)))throw n.DIV0;return t-e*d.INT(t/e)},MROUND:(t,e)=>{if(t=u.accept(t,a.NUMBER),0===(e=u.accept(e,a.NUMBER)))return 0;if(t>0&&e<0||t<0&&e>0)throw n.NUM;return t/e%1==0?t:Math.round(t/e)*e},MULTINOMIAL:(...t)=>{let e=0,r=1;return u.flattenParams(t,a.NUMBER,!1,(t=>{if(t<0)throw n.NUM;e+=t,r*=h(t)})),h(e)/r},MUNIT:t=>{t=u.accept(t,a.NUMBER);const e=[];for(let r=0;r<t;r++){const n=[];for(let e=0;e<t;e++)r===e?n.push(1):n.push(0);e.push(n)}return e},ODD:t=>{if(0===(t=u.accept(t,a.NUMBER)))return 1;let e=Math.ceil(Math.abs(t));return e=1&e?e:e+1,t>0?e:-e},PI:()=>Math.PI,POWER:(t,e)=>(t=u.accept(t,a.NUMBER))**(e=u.accept(e,a.NUMBER)),PRODUCT:(...t)=>{let e=1;return u.flattenParams(t,null,!0,((t,r)=>{const n=Number(t);r.isLiteral&&!isNaN(n)?e*=n:"number"==typeof t&&(e*=t)}),1),e},QUOTIENT:(t,e)=>(t=u.accept(t,a.NUMBER),e=u.accept(e,a.NUMBER),Math.trunc(t/e)),RADIANS:t=>(t=u.accept(t,a.NUMBER))/180*Math.PI,RAND:()=>Math.random(),RANDBETWEEN:(t,e)=>(t=u.accept(t,a.NUMBER),e=u.accept(e,a.NUMBER),Math.floor(Math.random()*(e-t+1)+t)),ROMAN:(t,e)=>{if(t=u.accept(t,a.NUMBER),0!==(e=u.accept(e,a.NUMBER,0)))throw Error("ROMAN: only allows form=0 (classic form).");const r=String(t).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let o="",i=3;for(;i--;)o=(n[+r.pop()+10*i]||"")+o;return new Array(+r.join("")+1).join("M")+o},ROUND:(t,e)=>{t=u.accept(t,a.NUMBER),e=u.accept(e,a.NUMBER);const r=Math.pow(10,Math.abs(e)),n=t>0?1:-1;return e>0?n*Math.round(Math.abs(t)*r)/r:0===e?n*Math.round(Math.abs(t)):n*Math.round(Math.abs(t)/r)*r},ROUNDDOWN:(t,e)=>{t=u.accept(t,a.NUMBER),e=u.accept(e,a.NUMBER);const r=Math.pow(10,Math.abs(e)),n=t>0?1:-1;if(e>0){const e=1/r*.5;return n*Math.round((Math.abs(t)-e)*r)/r}if(0===e){const e=.5;return n*Math.round(Math.abs(t)-e)}{const e=.5*r;return n*Math.round((Math.abs(t)-e)/r)*r}},ROUNDUP:(t,e)=>{t=u.accept(t,a.NUMBER),e=u.accept(e,a.NUMBER);const r=Math.pow(10,Math.abs(e)),n=t>0?1:-1;if(e>0){const e=1/r*.5;return n*Math.round((Math.abs(t)+e)*r)/r}if(0===e){const e=.5;return n*Math.round(Math.abs(t)+e)}{const e=.5*r;return n*Math.round((Math.abs(t)+e)/r)*r}},SERIESSUM:(t,e,r,o)=>{t=u.accept(t,a.NUMBER),e=u.accept(e,a.NUMBER),r=u.accept(r,a.NUMBER);let i,c=0;return u.flattenParams([o],a.NUMBER,!1,(o=>{if("number"!=typeof o)throw n.VALUE;0===c?i=o*Math.pow(t,e):i+=o*Math.pow(t,e+c*r),c++})),i},SIGN:t=>(t=u.accept(t,a.NUMBER))>0?1:0===t?0:-1,SQRT:t=>{if((t=u.accept(t,a.NUMBER))<0)throw n.NUM;return Math.sqrt(t)},SQRTPI:t=>{if((t=u.accept(t,a.NUMBER))<0)throw n.NUM;return Math.sqrt(t*Math.PI)},SUBTOTAL:()=>{},SUM:(...t)=>{let e=0;return u.flattenParams(t,a.NUMBER,!0,((t,r)=>{(r.isLiteral||"number"==typeof t)&&(e+=t)})),e},SUMIF:(t,e,r,n)=>{const o=u.retrieveRanges(t,e,n);e=o[0],n=o[1];const a=(r=u.retrieveArg(t,r)).isArray;r=c.parse(u.accept(r));let i=0;return e.forEach(((t,e)=>{t.forEach(((t,o)=>{const c=n[e][o];"number"==typeof c&&("wc"===r.op?r.match===r.value.test(t)&&(i+=c):s.compareOp(t,r.op,r.value,Array.isArray(t),a)&&(i+=c))}))})),i},SUMIFS:()=>{},SUMPRODUCT:(t,...e)=>{t=u.accept(t,a.ARRAY,void 0,!1,!0),e.forEach((e=>{if(e=u.accept(e,a.ARRAY,void 0,!1,!0),t[0].length!==e[0].length||t.length!==e.length)throw n.VALUE;for(let r=0;r<t.length;r++)for(let n=0;n<t[0].length;n++)"number"!=typeof t[r][n]&&(t[r][n]=0),"number"!=typeof e[r][n]&&(e[r][n]=0),t[r][n]*=e[r][n]}));let r=0;return t.forEach((t=>{t.forEach((t=>{r+=t}))})),r},SUMSQ:(...t)=>{let e=0;return u.flattenParams(t,a.NUMBER,!0,((t,r)=>{(r.isLiteral||"number"==typeof t)&&(e+=t**2)})),e},SUMX2MY2:(t,e)=>{const r=[],o=[];let a=0;if(u.flattenParams([t],null,!1,((t,e)=>{r.push(t)})),u.flattenParams([e],null,!1,((t,e)=>{o.push(t)})),r.length!==o.length)throw n.NA;for(let n=0;n<r.length;n++)"number"==typeof r[n]&&"number"==typeof o[n]&&(a+=r[n]**2-o[n]**2);return a},SUMX2PY2:(t,e)=>{const r=[],o=[];let a=0;if(u.flattenParams([t],null,!1,((t,e)=>{r.push(t)})),u.flattenParams([e],null,!1,((t,e)=>{o.push(t)})),r.length!==o.length)throw n.NA;for(let n=0;n<r.length;n++)"number"==typeof r[n]&&"number"==typeof o[n]&&(a+=r[n]**2+o[n]**2);return a},SUMXMY2:(t,e)=>{const r=[],o=[];let a=0;if(u.flattenParams([t],null,!1,((t,e)=>{r.push(t)})),u.flattenParams([e],null,!1,((t,e)=>{o.push(t)})),r.length!==o.length)throw n.NA;for(let n=0;n<r.length;n++)"number"==typeof r[n]&&"number"==typeof o[n]&&(a+=(r[n]-o[n])**2);return a},TRUNC:t=>(t=u.accept(t,a.NUMBER),Math.trunc(t))};t.exports=d},9369:(t,e,r)=>{const n=r(5908),{FormulaHelpers:o,Types:a,WildCard:i,Address:c}=r(3060),s=r(8239),u=o,l={ADDRESS:(t,e,r,o,i)=>{if(t=u.accept(t,a.NUMBER),e=u.accept(e,a.NUMBER),r=u.accept(r,a.NUMBER,1),o=u.accept(o,a.BOOLEAN,!0),i=u.accept(i,a.STRING,""),t<1||e<1||r<1||r>4)throw n.VALUE;let s="";return i.length>0&&(/[^A-Za-z_.\d\u007F-\uFFFF]/.test(i)?s+=`'${i}'!`:s+=i+"!"),o?(s+=1===r||3===r?"$":"",s+=c.columnNumberToName(e),s+=1===r||2===r?"$":"",s+=t):(s+="R",s+=4===r||3===r?`[${t}]`:t,s+="C",s+=4===r||2===r?`[${e}]`:e),s},AREAS:t=>(t=u.accept(t))instanceof s?t.length:1,CHOOSE:(t,...e)=>{},COLUMN:(t,e)=>{if(null==e){if(null!=t.position.col)return t.position.col;throw Error("FormulaParser.parse is called without position parameter.")}if("object"!=typeof e||Array.isArray(e))throw n.VALUE;if(u.isCellRef(e))return e.ref.col;if(u.isRangeRef(e))return e.ref.from.col;throw Error("ReferenceFunctions.COLUMN should not reach here.")},COLUMNS:(t,e)=>{if(null==e)throw Error("COLUMNS requires one argument");if("object"!=typeof e||Array.isArray(e))throw n.VALUE;if(u.isCellRef(e))return 1;if(u.isRangeRef(e))return Math.abs(e.ref.from.col-e.ref.to.col)+1;throw Error("ReferenceFunctions.COLUMNS should not reach here.")},HLOOKUP:(t,e,r,o)=>{t=u.accept(t);try{e=u.accept(e,a.ARRAY,void 0,!1)}catch(s){if(s instanceof n)throw n.NA;throw s}if(r=u.accept(r,a.NUMBER),o=u.accept(o,a.BOOLEAN,!0),r<1)throw n.VALUE;if(void 0===e[r-1])throw n.REF;const c=typeof t;if(o){let o=c===typeof e[0][0]?e[0][0]:null;for(let a=1;a<e[0].length;a++){const i=e[0][a];if(typeof i===c){if(o>t&&i>t)throw n.NA;if(i===t)return e[r-1][a];if(null!=o&&i>t&&o<=t)return e[r-1][a-1];o=i}}if(null==o)throw n.NA;return o}{let o=-1;if(o=i.isWildCard(t)?e[0].findIndex((e=>i.toRegex(t,"i").test(e))):e[0].findIndex((e=>e===t)),-1===o)throw n.NA;return e[r-1][o]}},INDEX:(t,e,r,o,i)=>{r={value:(r=t.utils.extractRefValue(r)).val,isArray:r.isArray},r=u.accept(r,a.NUMBER),r=Math.trunc(r),null==o?o=1:(o={value:(o=t.utils.extractRefValue(o)).val,isArray:o.isArray},o=u.accept(o,a.NUMBER,1),o=Math.trunc(o)),null==i?i=1:(i={value:(i=t.utils.extractRefValue(i)).val,isArray:i.isArray},i=u.accept(i,a.NUMBER,1),i=Math.trunc(i));let c=e;if(e instanceof s)c=e.refs[i-1];else if(i>1)throw n.REF;if(0===r&&0===o)return c;if(0===r){if(u.isRangeRef(c)){if(c.ref.to.col-c.ref.from.col<o-1)throw n.REF;return c.ref.from.col+=o-1,c.ref.to.col=c.ref.from.col,c}if(Array.isArray(c)){const t=[];return c.forEach((e=>t.push([e[o-1]]))),t}}if(0===o){if(u.isRangeRef(c)){if(c.ref.to.row-c.ref.from.row<r-1)throw n.REF;return c.ref.from.row+=r-1,c.ref.to.row=c.ref.from.row,c}if(Array.isArray(c))return c[o-1]}if(0!==r&&0!==o){if(u.isRangeRef(c)){if(c=c.ref,c.to.row-c.from.row<r-1||c.to.col-c.from.col<o-1)throw n.REF;return{ref:{row:c.from.row+r-1,col:c.from.col+o-1}}}if(u.isCellRef(c)){if(c=c.ref,r>1||o>1)throw n.REF;return{ref:{row:c.row+r-1,col:c.col+o-1}}}if(Array.isArray(c)){if(c.length<r||c[0].length<o)throw n.REF;return c[r-1][o-1]}}},MATCH:()=>{},ROW:(t,e)=>{if(null==e){if(null!=t.position.row)return t.position.row;throw Error("FormulaParser.parse is called without position parameter.")}if("object"!=typeof e||Array.isArray(e))throw n.VALUE;if(u.isCellRef(e))return e.ref.row;if(u.isRangeRef(e))return e.ref.from.row;throw Error("ReferenceFunctions.ROW should not reach here.")},ROWS:(t,e)=>{if(null==e)throw Error("ROWS requires one argument");if("object"!=typeof e||Array.isArray(e))throw n.VALUE;if(u.isCellRef(e))return 1;if(u.isRangeRef(e))return Math.abs(e.ref.from.row-e.ref.to.row)+1;throw Error("ReferenceFunctions.ROWS should not reach here.")},TRANSPOSE:t=>{t=u.accept(t,a.ARRAY,void 0,!1);const e=[];for(let r=0;r<t[0].length;r++){e[r]=[];for(let n=0;n<t.length;n++)e[r][n]=t[n][r]}return e},VLOOKUP:(t,e,r,o)=>{t=u.accept(t);try{e=u.accept(e,a.ARRAY,void 0,!1)}catch(s){if(s instanceof n)throw n.NA;throw s}if(r=u.accept(r,a.NUMBER),o=u.accept(o,a.BOOLEAN,!0),r<1)throw n.VALUE;if(void 0===e[0][r-1])throw n.REF;const c=typeof t;if(o){let o=c===typeof e[0][0]?e[0][0]:null;for(let a=1;a<e.length;a++){const i=e[a],s=e[a][0];if(typeof s===c){if(o>t&&s>t)throw n.NA;if(s===t)return i[r-1];if(null!=o&&s>t&&o<=t)return e[a-1][r-1];o=s}}if(null==o)throw n.NA;return o}{let o=-1;if(o=i.isWildCard(t)?e.findIndex((e=>i.toRegex(t,"i").test(e[0]))):e.findIndex((e=>e[0]===t)),-1===o)throw n.NA;return e[o][r-1]}}};t.exports=l},4003:(t,e,r)=>{const n=r(5908),{FormulaHelpers:o,Types:a,Criteria:i,Address:c}=r(3060),{Infix:s}=r(227),u=o,{DistributionFunctions:l}=r(5788),f={AVEDEV:(...t)=>{let e=0;const r=[];u.flattenParams(t,a.NUMBER,!0,((t,n)=>{"number"==typeof t&&(e+=t,r.push(t))}));const n=e/r.length;e=0;for(let o=0;o<r.length;o++)e+=Math.abs(r[o]-n);return e/r.length},AVERAGE:(...t)=>{let e=0,r=0;return u.flattenParams(t,a.NUMBER,!0,((t,n)=>{"number"==typeof t&&(e+=t,r++)})),e/r},AVERAGEA:(...t)=>{let e=0,r=0;return u.flattenParams(t,a.NUMBER,!0,((t,n)=>{const o=typeof t;"number"===o?(e+=t,r++):"string"===o&&r++})),e/r},AVERAGEIF:(t,e,r,o)=>{const a=u.retrieveRanges(t,e,o);e=a[0],o=a[1];const c=(r=u.retrieveArg(t,r)).isArray;r=i.parse(u.accept(r));let l=0,f=0;if(e.forEach(((t,e)=>{t.forEach(((t,n)=>{const a=o[e][n];"number"==typeof a&&("wc"===r.op?r.match===r.value.test(t)&&(l+=a,f++):s.compareOp(t,r.op,r.value,Array.isArray(t),c)&&(l+=a,f++))}))})),0===f)throw n.DIV0;return l/f},AVERAGEIFS:()=>{},COUNT:(...t)=>{let e=0;return u.flattenParams(t,null,!0,((t,r)=>{(r.isLiteral&&!isNaN(t)||"number"==typeof t)&&e++})),e},COUNTIF:(t,e)=>{t=u.accept(t,a.ARRAY,void 0,!1,!0);const r=e.isArray;e=u.accept(e);let n=0;return e=i.parse(e),t.forEach((t=>{t.forEach((t=>{"wc"===e.op?e.match===e.value.test(t)&&n++:s.compareOp(t,e.op,e.value,Array.isArray(t),r)&&n++}))})),n},LARGE:()=>{},MAX:()=>{},MAXA:()=>{},MAXIFS:()=>{},MEDIAN:()=>{},MIN:()=>{},MINA:()=>{},MINIFS:()=>{},PERMUT:()=>{},PERMUTATIONA:()=>{},SMALL:()=>{}};t.exports=Object.assign(f,l)},6693:(t,e,r)=>{const n=r(5908),{FormulaHelpers:o,Types:a,WildCard:i}=r(3060),c=o,s=r(6751),u=r(7370),l={latin:{halfRE:/[!-~]/g,fullRE:/[\uff01-\uff5e]/g,delta:65248},hangul1:{halfRE:/[\uffa1-\uffbe]/g,fullRE:/[\u11a8-\u11c2]/g,delta:-60921},hangul2:{halfRE:/[\uffc2-\uffdc]/g,fullRE:/[\u1161-\u1175]/g,delta:-61025},kana:{delta:0,half:"\uff61\uff62\uff63\uff64\uff65\uff66\uff67\uff68\uff69\uff6a\uff6b\uff6c\uff6d\uff6e\uff6f\uff70\uff71\uff72\uff73\uff74\uff75\uff76\uff77\uff78\uff79\uff7a\uff7b\uff7c\uff7d\uff7e\uff7f\uff80\uff81\uff82\uff83\uff84\uff85\uff86\uff87\uff88\uff89\uff8a\uff8b\uff8c\uff8d\uff8e\uff8f\uff90\uff91\uff92\uff93\uff94\uff95\uff96\uff97\uff98\uff99\uff9a\uff9b\uff9c\uff9d\uff9e\uff9f",full:"\u3002\u300c\u300d\u3001\u30fb\u30f2\u30a1\u30a3\u30a5\u30a7\u30a9\u30e3\u30e5\u30e7\u30c3\u30fc\u30a2\u30a4\u30a6\u30a8\u30aa\u30ab\u30ad\u30af\u30b1\u30b3\u30b5\u30b7\u30b9\u30bb\u30bd\u30bf\u30c1\u30c4\u30c6\u30c8\u30ca\u30cb\u30cc\u30cd\u30ce\u30cf\u30d2\u30d5\u30d8\u30db\u30de\u30df\u30e0\u30e1\u30e2\u30e4\u30e6\u30e8\u30e9\u30ea\u30eb\u30ec\u30ed\u30ef\u30f3\u309b\u309c"},extras:{delta:0,half:"\xa2\xa3\xac\xaf\xa6\xa5\u20a9 |\u2190\u2191\u2192\u2193\u25a0\xb0",full:"\uffe0\uffe1\uffe2\uffe3\uffe4\uffe5\uffe6\u3000\uffe8\uffe9\uffea\uffeb\uffec\uffed\uffee"}},f=(t,e)=>t[e+"RE"]||new RegExp("["+t[e]+"]","g"),h=Object.keys(l).map((t=>l[t])),p=t=>h.reduce(((t,e)=>t.replace(f(e,"half"),(t=>e=>t.delta?String.fromCharCode(e.charCodeAt(0)+t.delta):[...t.full][[...t.half].indexOf(e)])(e))),t),d=t=>h.reduce(((t,e)=>t.replace(f(e,"full"),(t=>e=>t.delta?String.fromCharCode(e.charCodeAt(0)-t.delta):[...t.half][[...t.full].indexOf(e)])(e))),t),m={ASC:t=>(t=c.accept(t,a.STRING),d(t)),BAHTTEXT:t=>{t=c.accept(t,a.NUMBER);try{return u(t)}catch(e){throw Error(`Error in https://github.com/jojoee/bahttext \n${e.toString()}`)}},CHAR:t=>{if((t=c.accept(t,a.NUMBER))>255||t<1)throw n.VALUE;return String.fromCharCode(t)},CLEAN:t=>(t=c.accept(t,a.STRING)).replace(/[\x00-\x1F]/g,""),CODE:t=>{if(0===(t=c.accept(t,a.STRING)).length)throw n.VALUE;return t.charCodeAt(0)},CONCAT:(...t)=>{let e="";return c.flattenParams(t,a.STRING,!1,(t=>{t=c.accept(t,a.STRING),e+=t})),e},CONCATENATE:(...t)=>{let e="";if(0===t.length)throw Error("CONCATENATE need at least one argument.");return t.forEach((t=>{t=c.accept(t,a.STRING),e+=t})),e},DBCS:t=>(t=c.accept(t,a.STRING),p(t)),DOLLAR:(t,e)=>{t=c.accept(t,a.NUMBER),e=c.accept(e,a.NUMBER,2);const r=Array(e).fill("0").join("");return s.format(`$#,##0.${r}_);($#,##0.${r})`,t).trim()},EXACT:(t,e)=>(t=c.accept(t,[a.STRING]))===(e=c.accept(e,[a.STRING])),FIND:(t,e,r)=>{if(t=c.accept(t,a.STRING),e=c.accept(e,a.STRING),(r=c.accept(r,a.NUMBER,1))<1||r>e.length)throw n.VALUE;const o=e.indexOf(t,r-1);if(-1===o)throw n.VALUE;return o+1},FINDB:(...t)=>m.FIND(...t),FIXED:(t,e,r)=>{t=c.accept(t,a.NUMBER),e=c.accept(e,a.NUMBER,2),r=c.accept(r,a.BOOLEAN,!1);const n=Array(e).fill("0").join(""),o=r?"":"#,";return s.format(`${o}##0.${n}_);(${o}##0.${n})`,t).trim()},LEFT:(t,e)=>{if(t=c.accept(t,a.STRING),(e=c.accept(e,a.NUMBER,1))<0)throw n.VALUE;return e>t.length?t:t.slice(0,e)},LEFTB:(...t)=>m.LEFT(...t),LEN:t=>(t=c.accept(t,a.STRING)).length,LENB:(...t)=>m.LEN(...t),LOWER:t=>(t=c.accept(t,a.STRING)).toLowerCase(),MID:(t,e,r)=>{if(t=c.accept(t,a.STRING),e=c.accept(e,a.NUMBER),r=c.accept(r,a.NUMBER),e>t.length)return"";if(e<1||r<1)throw n.VALUE;return t.slice(e-1,e+r-1)},MIDB:(...t)=>m.MID(...t),NUMBERVALUE:(t,e,r)=>{if(t=c.accept(t,a.STRING),e=c.accept(e,a.STRING,"."),r=c.accept(r,a.STRING,","),0===t.length)return 0;if(0===e.length||0===r.length)throw n.VALUE;if((e=e[0])===(r=r[0])||t.indexOf(e)<t.lastIndexOf(r))throw n.VALUE;const o=t.replace(r,"").replace(e,".").replace(/[^\-0-9.%()]/g,"").match(/([(-]*)([0-9]*[.]*[0-9]+)([)]?)([%]*)/);if(!o)throw n.VALUE;const i=o[1].length,s=o[3].length,u=o[4].length;let l=Number(o[2]);if(i>1||i&&!s||!i&&s||isNaN(l))throw n.VALUE;return l/=100**u,i?-l:l},PHONETIC:()=>{},PROPER:t=>(t=(t=(t=c.accept(t,[a.STRING])).toLowerCase()).charAt(0).toUpperCase()+t.slice(1)).replace(/(?:[^a-zA-Z])([a-zA-Z])/g,(t=>t.toUpperCase())),REPLACE:(t,e,r,n)=>{t=c.accept(t,[a.STRING]),e=c.accept(e,[a.NUMBER]),r=c.accept(r,[a.NUMBER]),n=c.accept(n,[a.STRING]);let o=t.split("");return o.splice(e-1,r,n),o.join("")},REPLACEB:(...t)=>m.REPLACE(...t),REPT:(t,e)=>{t=c.accept(t,a.STRING),e=c.accept(e,a.NUMBER);let r="";for(let n=0;n<e;n++)r+=t;return r},RIGHT:(t,e)=>{if(t=c.accept(t,a.STRING),(e=c.accept(e,a.NUMBER,1))<0)throw n.VALUE;const r=t.length;return e>r?t:t.slice(r-e)},RIGHTB:(...t)=>m.RIGHT(...t),SEARCH:(t,e,r)=>{if(t=c.accept(t,a.STRING),e=c.accept(e,a.STRING),(r=c.accept(r,a.NUMBER,1))<1||r>e.length)throw n.VALUE;let o=i.isWildCard(t)?i.toRegex(t,"i"):t;const s=e.slice(r-1).search(o);if(-1===s)throw n.VALUE;return s+r},SEARCHB:(...t)=>m.SEARCH(...t),SUBSTITUTE:(...t)=>{},T:t=>"string"==typeof(t=c.accept(t))?t:"",TEXT:(t,e)=>{t=c.accept(t,a.NUMBER),e=c.accept(e,a.STRING);try{return s.format(e,t)}catch(r){throw console.error(r),n.VALUE}},TEXTJOIN:(...t)=>{},TRIM:t=>(t=c.accept(t,[a.STRING])).replace(/^\s+|\s+$/g,""),UNICHAR:t=>{if((t=c.accept(t,[a.NUMBER]))<=0)throw n.VALUE;return String.fromCharCode(t)},UNICODE:t=>m.CODE(t)};t.exports=m},3730:(t,e,r)=>{const n=r(5908),{FormulaHelpers:o,Types:a}=r(3060),i=o,c=2**27-1,s={ACOS:t=>{if((t=i.accept(t,a.NUMBER))>1||t<-1)throw n.NUM;return Math.acos(t)},ACOSH:t=>{if((t=i.accept(t,a.NUMBER))<1)throw n.NUM;return Math.acosh(t)},ACOT:t=>(t=i.accept(t,a.NUMBER),Math.PI/2-Math.atan(t)),ACOTH:t=>{if(t=i.accept(t,a.NUMBER),Math.abs(t)<=1)throw n.NUM;return Math.atanh(1/t)},ASIN:t=>{if((t=i.accept(t,a.NUMBER))>1||t<-1)throw n.NUM;return Math.asin(t)},ASINH:t=>(t=i.accept(t,a.NUMBER),Math.asinh(t)),ATAN:t=>(t=i.accept(t,a.NUMBER),Math.atan(t)),ATAN2:(t,e)=>{if(t=i.accept(t,a.NUMBER),0===(e=i.accept(e,a.NUMBER))&&0===t)throw n.DIV0;return Math.atan2(e,t)},ATANH:t=>{if(t=i.accept(t,a.NUMBER),Math.abs(t)>1)throw n.NUM;return Math.atanh(t)},COS:t=>{if(t=i.accept(t,a.NUMBER),Math.abs(t)>c)throw n.NUM;return Math.cos(t)},COSH:t=>(t=i.accept(t,a.NUMBER),Math.cosh(t)),COT:t=>{if(t=i.accept(t,a.NUMBER),Math.abs(t)>c)throw n.NUM;if(0===t)throw n.DIV0;return 1/Math.tan(t)},COTH:t=>{if(0===(t=i.accept(t,a.NUMBER)))throw n.DIV0;return 1/Math.tanh(t)},CSC:t=>{if(t=i.accept(t,a.NUMBER),Math.abs(t)>c)throw n.NUM;return 1/Math.sin(t)},CSCH:t=>{if(0===(t=i.accept(t,a.NUMBER)))throw n.DIV0;return 1/Math.sinh(t)},SEC:t=>{if(t=i.accept(t,a.NUMBER),Math.abs(t)>c)throw n.NUM;return 1/Math.cos(t)},SECH:t=>(t=i.accept(t,a.NUMBER),1/Math.cosh(t)),SIN:t=>{if(t=i.accept(t,a.NUMBER),Math.abs(t)>c)throw n.NUM;return Math.sin(t)},SINH:t=>(t=i.accept(t,a.NUMBER),Math.sinh(t)),TAN:t=>{if(t=i.accept(t,a.NUMBER),Math.abs(t)>c)throw n.NUM;return Math.tan(t)},TANH:t=>(t=i.accept(t,a.NUMBER),Math.tanh(t))};t.exports=s},1766:(t,e,r)=>{const n=r(5908),{FormulaHelpers:o,Types:a}=r(3060),i=o,c={ENCODEURL:t=>encodeURIComponent(i.accept(t,a.STRING)),FILTERXML:()=>{},WEBSERVICE:(t,e)=>{throw n.ERROR("WEBSERVICE is not supported in sync mode.")}};t.exports=c},3060:(t,e,r)=>{const n=r(5908),o=r(8239),a={NUMBER:0,ARRAY:1,BOOLEAN:2,STRING:3,RANGE_REF:4,CELL_REF:5,COLLECTIONS:6,NUMBER_NO_BOOLEAN:10},i={};Object.keys(a).forEach((t=>{i[a[t]]=t}));const c=new class{constructor(){this.Types=a,this.type2Number={number:a.NUMBER,boolean:a.BOOLEAN,string:a.STRING,object:-1}}checkFunctionResult(t){if("number"===typeof t){if(isNaN(t))return n.VALUE;if(!isFinite(t))return n.NUM}return null==t?n.NULL:t}flattenDeep(t){return t.reduce(((t,e)=>Array.isArray(e)?t.concat(this.flattenDeep(e)):t.concat(e)),[])}acceptNumber(t,e=!0,r=!0){if(t instanceof n)return t;let o;if("number"==typeof t)o=t;else if("boolean"==typeof t){if(!r)throw n.VALUE;o=Number(t)}else if("string"==typeof t){if(0===t.length)throw n.VALUE;if(o=Number(t),o!=o)throw n.VALUE}else{if(!Array.isArray(t))throw Error("Unknown type in FormulaHelpers.acceptNumber");if(e)o=this.acceptNumber(t[0][0]);else{if(1!==t[0].length)throw n.VALUE;o=this.acceptNumber(t[0][0])}}return o}flattenParams(t,e,r,i,c=null,s=1){if(t.length<s)throw n.ARG_MISSING([e]);null==c&&(c=e===a.NUMBER?0:null==e?null:""),t.forEach((t=>{const{isCellRef:a,isRangeRef:s,isArray:u}=t,l=t.value instanceof o,f=!(a||s||u||l),h={isLiteral:f,isCellRef:a,isRangeRef:s,isArray:u,isUnion:l};if(f)t=t.omitted?c:this.accept(t,e,c),i(t,h);else if(a)i(t.value,h);else if(l){if(!r)throw n.VALUE;t=t.value.data,(t=this.flattenDeep(t)).forEach((t=>{i(t,h)}))}else(s||u)&&(t=this.flattenDeep(t.value)).forEach((t=>{i(t,h)}))}))}accept(t,e=null,r,i=!0,c=!1){if(Array.isArray(e)&&(e=e[0]),null==t&&void 0===r)throw n.ARG_MISSING([e]);if(null==t)return r;if("object"!=typeof t||Array.isArray(t))return t;const s=t.isArray;if(null!=t.value&&(t=t.value),null==e)return t;if(t instanceof n)throw t;if(e===a.ARRAY){if(Array.isArray(t))return i?this.flattenDeep(t):t;if(t instanceof o)throw n.VALUE;if(c)return i?[t]:[[t]];throw n.VALUE}if(e===a.COLLECTIONS)return t;s&&(t=t[0][0]);const u=this.type(t);if(e===a.STRING)t=u===a.BOOLEAN?t?"TRUE":"FALSE":`${t}`;else if(e===a.BOOLEAN){if(u===a.STRING)throw n.VALUE;u===a.NUMBER&&(t=Boolean(t))}else if(e===a.NUMBER)t=this.acceptNumber(t,!1);else{if(e!==a.NUMBER_NO_BOOLEAN)throw n.VALUE;t=this.acceptNumber(t,!1,!1)}return t}type(t){let e=this.type2Number[typeof t];return-1===e&&(Array.isArray(t)?e=a.ARRAY:t.ref?e=t.ref.from?a.RANGE_REF:a.CELL_REF:t instanceof o&&(e=a.COLLECTIONS)),e}isRangeRef(t){return t.ref&&t.ref.from}isCellRef(t){return t.ref&&!t.ref.from}retrieveRanges(t,e,r){return r=l.extend(e,r),e=this.retrieveArg(t,e),r!==(e=c.accept(e,a.ARRAY,void 0,!1,!0))?(r=this.retrieveArg(t,r),r=c.accept(r,a.ARRAY,void 0,!1,!0)):r=e,[e,r]}retrieveArg(t,e){if(null===e)return{value:0,isArray:!1,omitted:!0};const r=t.utils.extractRefValue(e);return{value:r.val,isArray:r.isArray,ref:e.ref}}},s={isWildCard:t=>"string"==typeof t&&/[*?]/.test(t),toRegex:(t,e)=>RegExp(t.replace(/[.+^${}()|[\]\\]/g,"\\$&").replace(/([^~]??)[?]/g,"$1.").replace(/([^~]??)[*]/g,"$1.*").replace(/~([?*])/g,"$1"),e)},u={parse:t=>{const e=typeof t;if("string"===e){const e=t.toUpperCase();if("TRUE"===e||"FALSE"===e)return{op:"=",value:"TRUE"===e};const r=t.match(/(<>|>=|<=|>|<|=)(.*)/);if(r){let t,e=r[1];if(isNaN(r[2])){const o=r[2].toUpperCase();if("TRUE"===o||"FALSE"===o)t="TRUE"===o;else if(/#NULL!|#DIV\/0!|#VALUE!|#NAME\?|#NUM!|#N\/A|#REF!/.test(r[2]))t=new n(r[2]);else if(t=r[2],s.isWildCard(t))return{op:"wc",value:s.toRegex(t),match:"="===e}}else t=Number(r[2]);return{op:e,value:t}}return s.isWildCard(t)?{op:"wc",value:s.toRegex(t),match:!0}:{op:"=",value:t}}if("boolean"===e||"number"===e||Array.isArray(t)||t instanceof n)return{op:"=",value:t};throw Error(`Criteria.parse: type ${typeof t} not support`)}},l={columnNumberToName:t=>{let e=t,r="",n=0;for(;e>0;)n=(e-1)%26,r=String.fromCharCode("A".charCodeAt(0)+n)+r,e=Math.floor((e-n)/26);return r},columnNameToNumber:t=>{const e=(t=t.toUpperCase()).length;let r=0;for(let n=0;n<e;n++){const o=t.charCodeAt(n);isNaN(o)||(r+=(o-64)*26**(e-n-1))}return r},extend:(t,e)=>{if(null==e)return t;let r,n;if(c.isCellRef(t))r=0,n=0;else{if(!c.isRangeRef(t))throw Error("Address.extend should not reach here.");r=t.ref.to.row-t.ref.from.row,n=t.ref.to.col-t.ref.from.col}return c.isCellRef(e)?(r>0||n>0)&&(e={ref:{from:{col:e.ref.col,row:e.ref.row},to:{row:e.ref.row+r,col:e.ref.col+n}}}):(e.ref.to.row=e.ref.from.row+r,e.ref.to.col=e.ref.from.col+n),e}};t.exports={FormulaHelpers:c,Types:a,ReversedTypes:i,Factorials:[1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600,6227020800,87178291200,1307674368e3,20922789888e3,355687428096e3,6402373705728e3,0x1b02b9306890000,243290200817664e4,5109094217170944e4,11240007277776077e5,2585201673888498e7,6204484017332394e8,15511210043330986e9,40329146112660565e10,10888869450418352e12,30488834461171387e13,8.841761993739702e30,26525285981219107e16,8222838654177922e18,2631308369336935e20,8683317618811886e21,29523279903960416e22,1.0333147966386145e40,37199332678990125e25,13763753091226346e27,5230226174666011e29,20397882081197444e30,8159152832478977e32,3345252661316381e34,140500611775288e37,6041526306337383e37,2658271574788449e39,11962222086548019e40,5502622159812089e42,25862324151116818e43,12413915592536073e45,6082818640342675e47,30414093201713376e48,15511187532873822e50,8065817517094388e52,42748832840600255e53,2308436973392414e56,12696403353658276e57,7109985878048635e59,40526919504877214e60,23505613312828785e62,1.3868311854568984e80,832098711274139e67,5075802138772248e68,3146997326038794e70,198260831540444e73,12688693218588417e73,8.247650592082472e90,5443449390774431e77,3647111091818868e79,24800355424368305e80,1711224524281413e83,1.1978571669969892e100,8504785885678623e86,61234458376886085e87,44701154615126844e89,3307885441519386e92,248091408113954e95,18854947016660504e95,14518309202828587e97,11324281178206297e99,8946182130782976e101,7156945704626381e103,5.797126020747368e120,4753643337012842e107,3945523969720659e109,3314240134565353e111,281710411438055e114,2.4227095383672734e130,2107757298379528e117,18548264225739844e118,1650795516090846e121,14857159644817615e122,1.352001527678403e140,12438414054641308e126,11567725070816416e128,1087366156656743e131,1032997848823906e133,9916779348709496e134,9619275968248212e136,9426890448883248e138,9332621544394415e140,9332621544394415e142],WildCard:s,Criteria:u,Address:l}},227:(t,e,r)=>{const n=r(5908),{FormulaHelpers:o}=r(3060),a={unaryOp:(t,e,r)=>{let a=1;if(t.forEach((t=>{if("+"===t);else{if("-"!==t)throw new Error(`Unrecognized prefix: ${t}`);a=-a}})),null==e&&(e=0),1===a)return e;try{e=o.acceptNumber(e,r)}catch(i){if(!(i instanceof n))throw i;Array.isArray(e)&&(e=e[0][0])}return"number"==typeof e&&isNaN(e)?n.VALUE:-e}},i={percentOp:(t,e,r)=>{try{t=o.acceptNumber(t,r)}catch(a){if(a instanceof n)return a;throw a}if("%"===e)return t/100;throw new Error(`Unrecognized postfix: ${e}`)}},c={boolean:3,string:2,number:1},s={compareOp:(t,e,r,n,o)=>{null==t&&(t=0),null==r&&(r=0),n&&(t=t[0][0]),o&&(r=r[0][0]);const a=typeof t,i=typeof r;if(a===i)switch(e){case"=":return t===r;case">":return t>r;case"<":return t<r;case"<>":return t!==r;case"<=":return t<=r;case">=":return t>=r}else switch(e){case"=":return!1;case">":return c[a]>c[i];case"<":return c[a]<c[i];case"<>":return!0;case"<=":return c[a]<=c[i];case">=":return c[a]>=c[i]}throw Error("Infix.compareOp: Should not reach here.")},concatOp:(t,e,r,n,o)=>{null==t&&(t=""),null==r&&(r=""),n&&(t=t[0][0]),o&&(r=r[0][0]);return"boolean"===typeof t&&(t=t?"TRUE":"FALSE"),"boolean"===typeof r&&(r=r?"TRUE":"FALSE"),""+t+r},mathOp:(t,e,r,a,i)=>{null==t&&(t=0),null==r&&(r=0);try{t=o.acceptNumber(t,a),r=o.acceptNumber(r,i)}catch(c){if(c instanceof n)return c;throw c}switch(e){case"+":return t+r;case"-":return t-r;case"*":return t*r;case"/":return 0===r?n.DIV0:t/r;case"^":return t**r}throw Error("Infix.mathOp: Should not reach here.")}};t.exports={Prefix:a,Postfix:i,Infix:s,Operators:{compareOp:["<",">","=","<>","<=",">="],concatOp:["&"],mathOp:["+","-","*","/","^"]}}},4750:(t,e,r)=>{const n=r(5908),{FormulaHelpers:o}=r(3060),{Parser:a}=r(2250),i=r(4511),c=r(6203),{formatChevrotainError:s}=r(4043);t.exports={DepParser:class{constructor(t){this.data=[],this.utils=new c(this),t=Object.assign({onVariable:()=>null},t),this.utils=new c(this),this.onVariable=t.onVariable,this.functions={},this.parser=new a(this,this.utils)}getCell(t){if(null!=t.row){null==t.sheet&&(t.sheet=this.position?this.position.sheet:void 0);-1===this.data.findIndex((e=>e.from&&e.from.row<=t.row&&e.to.row>=t.row&&e.from.col<=t.col&&e.to.col>=t.col||e.row===t.row&&e.col===t.col&&e.sheet===t.sheet))&&this.data.push(t)}return 0}getRange(t){if(null!=t.from.row){null==t.sheet&&(t.sheet=this.position?this.position.sheet:void 0);-1===this.data.findIndex((e=>e.from&&e.from.row===t.from.row&&e.from.col===t.from.col&&e.to.row===t.to.row&&e.to.col===t.to.col))&&this.data.push(t)}return[[0]]}getVariable(t){const e={ref:this.onVariable(t,this.position.sheet)};return null==e.ref?n.NAME:(o.isCellRef(e)?this.getCell(e.ref):this.getRange(e.ref),0)}retrieveRef(t){return o.isRangeRef(t)?this.getRange(t.ref):o.isCellRef(t)?this.getCell(t.ref):t}callFunction(t,e){return e.forEach((t=>{null!=t&&this.retrieveRef(t)})),{value:0,ref:{}}}checkFormulaResult(t){this.retrieveRef(t)}parse(t,e,r=!1){if(0===t.length)throw Error("Input must not be empty.");this.data=[],this.position=e;const o=i.lex(t);this.parser.input=o.tokens;try{const t=this.parser.formulaWithBinaryOp();this.checkFormulaResult(t)}catch(a){if(!r)throw n.ERROR(a.message,a)}if(this.parser.errors.length>0&&!r){const e=this.parser.errors[0];throw s(e,t)}return this.data}}}},6203:(t,e,r)=>{const n=r(5908),{FormulaHelpers:o,Types:a,Address:i}=r(3060),{Prefix:c,Postfix:s,Infix:u,Operators:l}=r(227),f=r(8239),h=1048576;t.exports=class{constructor(t){this.context=t}columnNameToNumber(t){return i.columnNameToNumber(t)}parseCellAddress(t){const e=t.match(/([$]?)([A-Za-z]{1,3})([$]?)([1-9][0-9]*)/);return{ref:{col:this.columnNameToNumber(e[2]),row:+e[4]}}}parseRow(t){const e=+t;if(!Number.isInteger(e))throw Error("Row number must be integer.");return{ref:{col:void 0,row:+t}}}parseCol(t){return{ref:{col:this.columnNameToNumber(t),row:void 0}}}applyPrefix(t,e){return this.extractRefValue(e),0}applyPostfix(t,e){return this.extractRefValue(t),0}applyInfix(t,e,r){return this.extractRefValue(t),this.extractRefValue(r),0}applyIntersect(t){if(this.isFormulaError(t[0]))return t[0];if(!t[0].ref)throw Error(`Expecting a reference, but got ${t[0]}.`);let e,r,o,a,i,c;const s=t.shift().ref;if(i=s.sheet,s.from)e=Math.max(s.from.row,s.to.row),o=Math.min(s.from.row,s.to.row),r=Math.max(s.from.col,s.to.col),a=Math.min(s.from.col,s.to.col);else{if(void 0===s.row||void 0===s.col)throw Error("Cannot intersect the whole row or column.");e=o=s.row,r=a=s.col}let u;return t.forEach((t=>{if(this.isFormulaError(t))return t;if(!(t=t.ref))throw Error(`Expecting a reference, but got ${t}.`);if(t.from){const c=Math.max(t.from.row,t.to.row),s=Math.min(t.from.row,t.to.row),l=Math.max(t.from.col,t.to.col),f=Math.min(t.from.col,t.to.col);(s>e||c<o||f>r||l<a||i!==t.sheet)&&(u=n.NULL),e=Math.min(e,c),o=Math.max(o,s),r=Math.min(r,l),a=Math.max(a,f)}else{if(void 0===t.row||void 0===t.col)throw Error("Cannot intersect the whole row or column.");(t.row>e||t.row<o||t.col>r||t.col<a||i!==t.sheet)&&(u=n.NULL),e=o=t.row,r=a=t.col}})),u||(c=e===o&&r===a?{ref:{sheet:i,row:e,col:r}}:{ref:{sheet:i,from:{row:o,col:a},to:{row:e,col:r}}},c.ref.sheet||delete c.ref.sheet,c)}applyUnion(t){const e=new f;for(let r=0;r<t.length;r++){if(this.isFormulaError(t[r]))return t[r];e.add(this.extractRefValue(t[r]).val,t[r])}return e}applyRange(t){let e,r=-1,n=-1,o=1048577,a=16385;return t.forEach((t=>{if(this.isFormulaError(t))return t;"number"==typeof t&&(t=this.parseRow(t)),void 0===(t=t.ref).row&&(o=1,r=h),void 0===t.col&&(a=1,n=16384),t.row>r&&(r=t.row),t.row<o&&(o=t.row),t.col>n&&(n=t.col),t.col<a&&(a=t.col)})),e=r===o&&n===a?{ref:{row:r,col:n}}:{ref:{from:{row:o,col:a},to:{row:r,col:n}}},e}extractRefValue(t){const e=Array.isArray(t);return t.ref?{val:this.context.retrieveRef(t),isArray:e}:{val:t,isArray:e}}toArray(t){return t}toNumber(t){return Number(t)}toString(t){return t.substring(1,t.length-1).replace(/""/g,'"')}toBoolean(t){return"TRUE"===t}toError(t){return new n(t.toUpperCase())}isFormulaError(t){return t instanceof n}}},8222:(t,e,r)=>{const n=r(6693),o=r(3928),a=r(3730),i=r(3703),c=r(2987),s=r(9369),u=r(5714),l=r(4003),f=r(1518),h=r(1766),p=r(5908),{FormulaHelpers:d}=r(3060),{Parser:m,allTokens:v}=r(2250),g=r(4511),E=r(4043);t.exports={FormulaParser:class{constructor(t,e=!1){this.logs=[],this.isTest=e,this.utils=new E(this),t=Object.assign({functions:{},functionsNeedContext:{},onVariable:()=>null,onCell:()=>0,onRange:()=>[[0]]},t),this.onVariable=t.onVariable,this.functions=Object.assign({},f,l,u,s,c,i,n,o,a,h,t.functions,t.functionsNeedContext),this.onRange=t.onRange,this.onCell=t.onCell,this.funsNullAs0=Object.keys(o).concat(Object.keys(a)).concat(Object.keys(i)).concat(Object.keys(c)).concat(Object.keys(s)).concat(Object.keys(l)).concat(Object.keys(f)),this.funsNeedContextAndNoDataRetrieve=["ROW","ROWS","COLUMN","COLUMNS","SUMIF","INDEX","AVERAGEIF","IF"],this.funsNeedContext=[...Object.keys(t.functionsNeedContext),...this.funsNeedContextAndNoDataRetrieve,"INDEX","OFFSET","INDIRECT","IF","CHOOSE","WEBSERVICE"],this.funsPreserveRef=Object.keys(u),this.parser=new m(this,this.utils)}static get allTokens(){return v}getCell(t){return null==t.sheet&&(t.sheet=this.position?this.position.sheet:void 0),this.onCell(t)}getRange(t){return null==t.sheet&&(t.sheet=this.position?this.position.sheet:void 0),this.onRange(t)}getVariable(t){const e={ref:this.onVariable(t,this.position.sheet,this.position)};return null==e.ref?p.NAME:e}retrieveRef(t){return d.isRangeRef(t)?this.getRange(t.ref):d.isCellRef(t)?this.getCell(t.ref):t}_callFunction(t,e){0===t.indexOf("_xlfn.")&&(t=t.slice(6)),t=t.toUpperCase();const r=this.funsNullAs0.includes(t)?0:"";if(this.funsNeedContextAndNoDataRetrieve.includes(t)||(e=e.map((e=>{if(null===e)return{value:r,isArray:!1,omitted:!0};const n=this.utils.extractRefValue(e);return this.funsPreserveRef.includes(t)?{value:n.val,isArray:n.isArray,ref:e.ref}:{value:n.val,isArray:n.isArray,isRangeRef:!!d.isRangeRef(e),isCellRef:!!d.isCellRef(e)}}))),this.functions[t]){let r;try{r=this.funsNeedContextAndNoDataRetrieve.includes(t)||this.funsNeedContext.includes(t)?this.functions[t](this,...e):this.functions[t](...e)}catch(n){if(n instanceof p)return n;throw n}if(void 0===r){if(this.isTest)return this.logs.includes(t)||this.logs.push(t),{value:0,ref:{}};throw p.NOT_IMPLEMENTED(t)}return r}if(this.isTest)return this.logs.includes(t)||this.logs.push(t),{value:0,ref:{}};throw p.NOT_IMPLEMENTED(t)}async callFunctionAsync(t,e){const r=[];for(const o of e)r.push(await o);const n=await this._callFunction(t,r);return d.checkFunctionResult(n)}callFunction(t,e){if(this.async)return this.callFunctionAsync(t,e);{const r=this._callFunction(t,e);return d.checkFunctionResult(r)}}supportedFunctions(){const t=[];return Object.keys(this.functions).forEach((e=>{try{if(void 0===this.functions[e](0,0,0,0,0,0,0,0,0,0,0))return;t.push(e)}catch(r){r instanceof Error&&t.push(e)}})),t.sort()}checkFormulaResult(t,e=!1){const r=typeof t;if("number"===r){if(isNaN(t))return p.VALUE;if(!isFinite(t))return p.NUM;t+=0}else if("object"===r){if(t instanceof p)return t;if(e){if(t.ref&&(t=this.retrieveRef(t)),"object"==typeof t&&!Array.isArray(t)&&null!=t)return p.VALUE}else if(t.ref&&t.ref.row&&!t.ref.from)t=this.retrieveRef(t);else if(t.ref&&t.ref.from&&t.ref.from.col===t.ref.to.col)t=this.retrieveRef({ref:{row:t.ref.from.row,col:t.ref.from.col}});else{if(!Array.isArray(t))return p.VALUE;t=t[0][0]}}return t}parse(t,e,r=!1){if(0===t.length)throw Error("Input must not be empty.");this.position=e,this.async=!1;const n=g.lex(t);let o;this.parser.input=n.tokens;try{if(o=this.parser.formulaWithBinaryOp(),o=this.checkFormulaResult(o,r),o instanceof p)return o}catch(a){throw p.ERROR(a.message,a)}if(this.parser.errors.length>0){const e=this.parser.errors[0];throw E.formatChevrotainError(e,t)}return o}async parseAsync(t,e,r=!1){if(0===t.length)throw Error("Input must not be empty.");this.position=e,this.async=!0;const n=g.lex(t);let o;this.parser.input=n.tokens;try{if(o=await this.parser.formulaWithBinaryOp(),o=this.checkFormulaResult(o,r),o instanceof p)return o}catch(a){throw p.ERROR(a.message,a)}if(this.parser.errors.length>0){const e=this.parser.errors[0];throw E.formatChevrotainError(e,t)}return o}},FormulaHelpers:d}},4511:(t,e,r)=>{const{createToken:n,Lexer:o}=r(5949),a=r(5908),i={},c=n({name:"WhiteSpace",pattern:/\s+/,group:o.SKIPPED}),s=n({name:"String",pattern:/"(""|[^"])*"/}),u=n({name:"SingleQuotedString",pattern:/'(''|[^'])*'/}),l=n({name:"SheetQuoted",pattern:/'((?![\\\/\[\]*?:]).)+?'!/}),f=n({name:"Function",pattern:/[A-Za-z_]+[A-Za-z_0-9.]*\(/}),h=n({name:"FormulaErrorT",pattern:/#NULL!|#DIV\/0!|#VALUE!|#NAME\?|#NUM!|#N\/A/}),p=n({name:"RefError",pattern:/#REF!/}),d=n({name:"Name",pattern:/[a-zA-Z_][a-zA-Z0-9_.?]*/}),m=n({name:"Sheet",pattern:/[A-Za-z_.\d\u007F-\uFFFF]+!/}),v=n({name:"Cell",pattern:/[$]?[A-Za-z]{1,3}[$]?[1-9][0-9]*/,longer_alt:d}),g=n({name:"Number",pattern:/[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?/}),E=n({name:"Boolean",pattern:/TRUE|FALSE/i}),y=n({name:"Column",pattern:/[$]?[A-Za-z]{1,3}/,longer_alt:d}),N=n({name:"At",pattern:/@/}),R=n({name:"Comma",pattern:/,/}),T=n({name:"Colon",pattern:/:/}),A=n({name:"Semicolon",pattern:/;/}),M=n({name:"OpenParen",pattern:/\(/}),w=n({name:"CloseParen",pattern:/\)/}),O=n({name:"OpenSquareParen",pattern:/\[/}),I=n({name:"CloseSquareParen",pattern:/]/}),S=(n({name:"exclamationMark",pattern:/!/}),n({name:"OpenCurlyParen",pattern:/{/})),C=n({name:"CloseCurlyParen",pattern:/}/}),b=n({name:"QuoteS",pattern:/'/}),U=n({name:"MulOp",pattern:/\*/}),x=n({name:"PlusOp",pattern:/\+/}),L=n({name:"DivOp",pattern:/\//}),_=n({name:"MinOp",pattern:/-/}),k=n({name:"ConcatOp",pattern:/&/}),P=n({name:"ExOp",pattern:/\^/}),B=n({name:"PercentOp",pattern:/%/}),D=n({name:"GtOp",pattern:/>/}),F=n({name:"EqOp",pattern:/=/}),j=n({name:"LtOp",pattern:/</}),V=[c,s,l,u,f,h,p,m,v,E,y,d,g,N,R,T,A,M,w,O,I,S,C,b,U,x,L,_,k,P,U,B,n({name:"NeqOp",pattern:/<>/}),n({name:"GteOp",pattern:/>=/}),n({name:"LteOp",pattern:/<=/}),D,F,j],G=new o(V,{ensureOptimizations:!0});V.forEach((t=>{i[t.name]=t})),t.exports={tokenVocabulary:i,lex:function(t){const e=G.tokenize(t);if(e.errors.length>0){const r=e.errors[0],n=r.line,o=r.column;let i="\n"+t.split("\n")[n-1]+"\n";throw i+=Array(o-1).fill(" ").join("")+"^\n",r.message=i+`Error at position ${n}:${o}\n`+r.message,r.errorLocation={line:n,column:o},a.ERROR(r.message,r)}return e}}},2250:(t,e,r)=>{const n=r(4511),{EmbeddedActionsParser:o}=r(5949),a=n.tokenVocabulary,{String:i,SheetQuoted:c,ExcelRefFunction:s,ExcelConditionalRefFunction:u,Function:l,FormulaErrorT:f,RefError:h,Cell:p,Sheet:d,Name:m,Number:v,Boolean:g,Column:E,Comma:y,Colon:N,Semicolon:R,OpenParen:T,CloseParen:A,OpenCurlyParen:M,CloseCurlyParen:w,MulOp:O,PlusOp:I,DivOp:S,MinOp:C,ConcatOp:b,ExOp:U,PercentOp:x,NeqOp:L,GteOp:_,LteOp:k,GtOp:P,EqOp:B,LtOp:D}=n.tokenVocabulary;t.exports={Parser:class extends o{constructor(t,e){super(a,{outputCst:!1,maxLookahead:1,skipValidations:!0}),this.utils=e,this.binaryOperatorsPrecedence=[["^"],["*","/"],["+","-"],["&"],["<",">","=","<>","<=",">="]];const r=this;r.RULE("formulaWithBinaryOp",(()=>{const t=[],e=[r.SUBRULE(r.formulaWithPercentOp)];return r.MANY((()=>{t.push(r.OR(r.c1||(r.c1=[{ALT:()=>r.CONSUME(P).image},{ALT:()=>r.CONSUME(B).image},{ALT:()=>r.CONSUME(D).image},{ALT:()=>r.CONSUME(L).image},{ALT:()=>r.CONSUME(_).image},{ALT:()=>r.CONSUME(k).image},{ALT:()=>r.CONSUME(b).image},{ALT:()=>r.CONSUME(I).image},{ALT:()=>r.CONSUME(C).image},{ALT:()=>r.CONSUME(O).image},{ALT:()=>r.CONSUME(S).image},{ALT:()=>r.CONSUME(U).image}]))),e.push(r.SUBRULE2(r.formulaWithPercentOp))})),r.ACTION((()=>{for(const r of this.binaryOperatorsPrecedence)for(let n=0,o=t.length;n<o;n++){const a=t[n];r.includes(a)&&(t.splice(n,1),e.splice(n,2,this.utils.applyInfix(e[n],a,e[n+1])),n--,o--)}})),e[0]})),r.RULE("plusMinusOp",(()=>r.OR([{ALT:()=>r.CONSUME(I).image},{ALT:()=>r.CONSUME(C).image}]))),r.RULE("formulaWithPercentOp",(()=>{let t=r.SUBRULE(r.formulaWithUnaryOp);return r.OPTION((()=>{const e=r.CONSUME(x).image;t=r.ACTION((()=>this.utils.applyPostfix(t,e)))})),t})),r.RULE("formulaWithUnaryOp",(()=>{const t=[];r.MANY((()=>{const e=r.OR([{ALT:()=>r.CONSUME(I).image},{ALT:()=>r.CONSUME(C).image}]);t.push(e)}));const e=r.SUBRULE(r.formulaWithIntersect);return t.length>0?r.ACTION((()=>this.utils.applyPrefix(t,e))):e})),r.RULE("formulaWithIntersect",(()=>{let t=r.SUBRULE(r.formulaWithRange);const e=[t];return r.MANY({GATE:()=>{const t=r.LA(0);return r.LA(1).startOffset>t.endOffset+1},DEF:()=>{e.push(r.SUBRULE3(r.formulaWithRange))}}),e.length>1?r.ACTION((()=>r.ACTION((()=>this.utils.applyIntersect(e))))):t})),r.RULE("formulaWithRange",(()=>{const t=r.SUBRULE(r.formula),e=[t];return r.MANY((()=>{r.CONSUME(N),e.push(r.SUBRULE2(r.formula))})),e.length>1?r.ACTION((()=>r.ACTION((()=>this.utils.applyRange(e))))):t})),r.RULE("formula",(()=>r.OR9([{ALT:()=>r.SUBRULE(r.referenceWithoutInfix)},{ALT:()=>r.SUBRULE(r.paren)},{ALT:()=>r.SUBRULE(r.constant)},{ALT:()=>r.SUBRULE(r.functionCall)},{ALT:()=>r.SUBRULE(r.constantArray)}]))),r.RULE("paren",(()=>{let t;r.CONSUME(T);const e=[];return e.push(r.SUBRULE(r.formulaWithBinaryOp)),r.MANY((()=>{r.CONSUME(y),e.push(r.SUBRULE2(r.formulaWithBinaryOp))})),t=e.length>1?r.ACTION((()=>this.utils.applyUnion(e))):e[0],r.CONSUME(A),t})),r.RULE("constantArray",(()=>{const t=[[]];let e=0;return r.CONSUME(M),t[e].push(r.SUBRULE(r.constantForArray)),r.MANY((()=>{const n=r.OR([{ALT:()=>r.CONSUME(y).image},{ALT:()=>r.CONSUME(R).image}]),o=r.SUBRULE2(r.constantForArray);","===n||(e++,t[e]=[]),t[e].push(o)})),r.CONSUME(w),r.ACTION((()=>this.utils.toArray(t)))})),r.RULE("constantForArray",(()=>r.OR([{ALT:()=>{const t=r.OPTION((()=>r.SUBRULE(r.plusMinusOp))),e=r.CONSUME(v).image,n=r.ACTION((()=>this.utils.toNumber(e)));return t?r.ACTION((()=>this.utils.applyPrefix([t],n))):n}},{ALT:()=>{const t=r.CONSUME(i).image;return r.ACTION((()=>this.utils.toString(t)))}},{ALT:()=>{const t=r.CONSUME(g).image;return r.ACTION((()=>this.utils.toBoolean(t)))}},{ALT:()=>{const t=r.CONSUME(f).image;return r.ACTION((()=>this.utils.toError(t)))}},{ALT:()=>{const t=r.CONSUME(h).image;return r.ACTION((()=>this.utils.toError(t)))}}]))),r.RULE("constant",(()=>r.OR([{ALT:()=>{const t=r.CONSUME(v).image;return r.ACTION((()=>this.utils.toNumber(t)))}},{ALT:()=>{const t=r.CONSUME(i).image;return r.ACTION((()=>this.utils.toString(t)))}},{ALT:()=>{const t=r.CONSUME(g).image;return r.ACTION((()=>this.utils.toBoolean(t)))}},{ALT:()=>{const t=r.CONSUME(f).image;return r.ACTION((()=>this.utils.toError(t)))}}]))),r.RULE("functionCall",(()=>{const e=r.CONSUME(l).image.slice(0,-1),n=r.SUBRULE(r.arguments);return r.CONSUME(A),r.ACTION((()=>t.callFunction(e,n)))})),r.RULE("arguments",(()=>{r.MANY2((()=>{r.CONSUME2(y)}));const t=[];return r.OPTION((()=>{t.push(r.SUBRULE(r.formulaWithBinaryOp)),r.MANY((()=>{r.CONSUME1(y),t.push(null),r.OPTION3((()=>{t.pop(),t.push(r.SUBRULE2(r.formulaWithBinaryOp))}))}))})),t})),r.RULE("referenceWithoutInfix",(()=>r.OR([{ALT:()=>r.SUBRULE(r.referenceItem)},{ALT:()=>{const t=r.SUBRULE(r.prefixName),e=r.SUBRULE2(r.formulaWithRange);return r.ACTION((()=>{if(this.utils.isFormulaError(e))return e;e.ref.sheet=t})),e}}]))),r.RULE("referenceItem",(()=>r.OR([{ALT:()=>{const t=r.CONSUME(p).image;return r.ACTION((()=>this.utils.parseCellAddress(t)))}},{ALT:()=>{const e=r.CONSUME(m).image;return r.ACTION((()=>t.getVariable(e)))}},{ALT:()=>{const t=r.CONSUME(E).image;return r.ACTION((()=>this.utils.parseCol(t)))}},{ALT:()=>{const t=r.CONSUME(h).image;return r.ACTION((()=>this.utils.toError(t)))}}]))),r.RULE("prefixName",(()=>r.OR([{ALT:()=>r.CONSUME(d).image.slice(0,-1)},{ALT:()=>r.CONSUME(c).image.slice(1,-2).replace(/''/g,"'")}]))),this.performSelfAnalysis()}}}},8239:t=>{t.exports=class{constructor(t,e){if(null==t&&null==e)this._data=[],this._refs=[];else{if(t.length!==e.length)throw Error("Collection: data length should match references length.");this._data=t,this._refs=e}}get data(){return this._data}get refs(){return this._refs}get length(){return this._data.length}add(t,e){this._data.push(t),this._refs.push(e)}}},4043:(t,e,r)=>{const n=r(5908),{Address:o}=r(3060),{Prefix:a,Postfix:i,Infix:c,Operators:s}=r(227),u=r(8239),l=1048576,{NotAllInputParsedException:f}=r(5949);t.exports=class{constructor(t){this.context=t}columnNameToNumber(t){return o.columnNameToNumber(t)}parseCellAddress(t){const e=t.match(/([$]?)([A-Za-z]{1,3})([$]?)([1-9][0-9]*)/);return{ref:{address:e[0],col:this.columnNameToNumber(e[2]),row:+e[4]}}}parseRow(t){const e=+t;if(!Number.isInteger(e))throw Error("Row number must be integer.");return{ref:{col:void 0,row:+t}}}parseCol(t){return{ref:{col:this.columnNameToNumber(t),row:void 0}}}parseColRange(t,e){return t=this.columnNameToNumber(t),e=this.columnNameToNumber(e),{ref:{from:{col:Math.min(t,e),row:null},to:{col:Math.max(t,e),row:null}}}}parseRowRange(t,e){return{ref:{from:{col:null,row:Math.min(t,e)},to:{col:null,row:Math.max(t,e)}}}}_applyPrefix(t,e,r){return this.isFormulaError(e)?e:a.unaryOp(t,e,r)}async applyPrefixAsync(t,e){const{val:r,isArray:n}=this.extractRefValue(await e);return this._applyPrefix(t,r,n)}applyPrefix(t,e){if(this.context.async)return this.applyPrefixAsync(t,e);{const{val:r,isArray:n}=this.extractRefValue(e);return this._applyPrefix(t,r,n)}}_applyPostfix(t,e,r){return this.isFormulaError(t)?t:i.percentOp(t,r,e)}async applyPostfixAsync(t,e){const{val:r,isArray:n}=this.extractRefValue(await t);return this._applyPostfix(r,n,e)}applyPostfix(t,e){if(this.context.async)return this.applyPostfixAsync(t,e);{const{val:r,isArray:n}=this.extractRefValue(t);return this._applyPostfix(r,n,e)}}_applyInfix(t,e,r){const n=t.val,o=t.isArray,a=r.val,i=r.isArray;if(this.isFormulaError(n))return n;if(this.isFormulaError(a))return a;if(s.compareOp.includes(e))return c.compareOp(n,e,a,o,i);if(s.concatOp.includes(e))return c.concatOp(n,e,a,o,i);if(s.mathOp.includes(e))return c.mathOp(n,e,a,o,i);throw new Error(`Unrecognized infix: ${e}`)}async applyInfixAsync(t,e,r){const n=this.extractRefValue(await t),o=this.extractRefValue(await r);return this._applyInfix(n,e,o)}applyInfix(t,e,r){if(this.context.async)return this.applyInfixAsync(t,e,r);{const n=this.extractRefValue(t),o=this.extractRefValue(r);return this._applyInfix(n,e,o)}}applyIntersect(t){if(this.isFormulaError(t[0]))return t[0];if(!t[0].ref)throw Error(`Expecting a reference, but got ${t[0]}.`);let e,r,o,a,i,c;const s=t.shift().ref;if(i=s.sheet,s.from)e=Math.max(s.from.row,s.to.row),o=Math.min(s.from.row,s.to.row),r=Math.max(s.from.col,s.to.col),a=Math.min(s.from.col,s.to.col);else{if(void 0===s.row||void 0===s.col)throw Error("Cannot intersect the whole row or column.");e=o=s.row,r=a=s.col}let u;return t.forEach((t=>{if(this.isFormulaError(t))return t;if(!(t=t.ref))throw Error(`Expecting a reference, but got ${t}.`);if(t.from){const c=Math.max(t.from.row,t.to.row),s=Math.min(t.from.row,t.to.row),l=Math.max(t.from.col,t.to.col),f=Math.min(t.from.col,t.to.col);(s>e||c<o||f>r||l<a||i!==t.sheet)&&(u=n.NULL),e=Math.min(e,c),o=Math.max(o,s),r=Math.min(r,l),a=Math.max(a,f)}else{if(void 0===t.row||void 0===t.col)throw Error("Cannot intersect the whole row or column.");(t.row>e||t.row<o||t.col>r||t.col<a||i!==t.sheet)&&(u=n.NULL),e=o=t.row,r=a=t.col}})),u||(c=e===o&&r===a?{ref:{sheet:i,row:e,col:r}}:{ref:{sheet:i,from:{row:o,col:a},to:{row:e,col:r}}},c.ref.sheet||delete c.ref.sheet,c)}applyUnion(t){const e=new u;for(let r=0;r<t.length;r++){if(this.isFormulaError(t[r]))return t[r];e.add(this.extractRefValue(t[r]).val,t[r])}return e}applyRange(t){let e,r=-1,n=-1,o=1048577,a=16385;return t.forEach((t=>{if(this.isFormulaError(t))return t;"number"==typeof t&&(t=this.parseRow(t)),void 0===(t=t.ref).row&&(o=1,r=l),void 0===t.col&&(a=1,n=16384),t.row>r&&(r=t.row),t.row<o&&(o=t.row),t.col>n&&(n=t.col),t.col<a&&(a=t.col)})),e=r===o&&n===a?{ref:{row:r,col:n}}:{ref:{from:{row:o,col:a},to:{row:r,col:n}}},e}extractRefValue(t){let e=t,r=!1;return Array.isArray(e)&&(r=!0),t.ref?{val:this.context.retrieveRef(t),isArray:r}:{val:e,isArray:r}}toArray(t){return t}toNumber(t){return Number(t)}toString(t){return t.substring(1,t.length-1).replace(/""/g,'"')}toBoolean(t){return"TRUE"===t}toError(t){return new n(t.toUpperCase())}isFormulaError(t){return t instanceof n}static formatChevrotainError(t,e){let r,o,a="";return t instanceof f?(r=t.token.startLine,o=t.token.startColumn):(r=t.previousToken.startLine,o=t.previousToken.startColumn+1),a+="\n"+e.split("\n")[r-1]+"\n",a+=Array(o-1).fill(" ").join("")+"^\n",a+=`Error at position ${r}:${o}\n`+t.message,t.errorLocation={line:r,column:o},n.ERROR(a,t)}}},5336:(t,e,r)=>{const{FormulaParser:n}=r(8222),{DepParser:o}=r(4750),a=r(6751),i=r(5908);Object.assign(n,{MAX_ROW:1048576,MAX_COLUMN:16384,SSF:a,DepParser:o,FormulaError:i,...r(3060)}),t.exports=n},6751:t=>{class e{}function r(t){let e="",r=t.length-1;for(;r>=0;)e+=t.charAt(r--);return e}function n(t,e){let r="";for(;r.length<e;)r+=t;return r}function o(t,e){let r=""+t;return r.length>=e?r:n("0",e-r.length)+r}function a(t,e){let r=""+t;return r.length>=e?r:n(" ",e-r.length)+r}function i(t,e){let r=""+t;return r.length>=e?r:r+n(" ",e-r.length)}e.version="0.10.3";const c=Math.pow(2,32);function s(t,e){if(t>c||t<-c)return function(t,e){let r=""+Math.round(t);return r.length>=e?r:n("0",e-r.length)+r}(t,e);return function(t,e){let r=""+t;return r.length>=e?r:n("0",e-r.length)+r}(Math.round(t),e)}function u(t,e){return e=e||0,t.length>=7+e&&103==(32|t.charCodeAt(e))&&101==(32|t.charCodeAt(e+1))&&110==(32|t.charCodeAt(e+2))&&101==(32|t.charCodeAt(e+3))&&114==(32|t.charCodeAt(e+4))&&97==(32|t.charCodeAt(e+5))&&108==(32|t.charCodeAt(e+6))}const l=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],f=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function h(t){t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',t[65535]="General"}const p={};function d(t,e,r){const n=t<0?-1:1;let o=t*n,a=0,i=1,c=0,s=1,u=0,l=0,f=Math.floor(o);for(;u<e&&(f=Math.floor(o),c=f*i+a,l=f*u+s,!(o-f<5e-8));)o=1/(o-f),a=i,i=c,s=u,u=l;if(l>e&&(u>e?(l=s,c=a):(l=u,c=i)),!r)return[0,n*c,l];const h=Math.floor(n*c/l);return[h,n*c-h*l,l]}function m(t,e,r){if(t>2958465||t<0)return null;let n=0|t,o=Math.floor(86400*(t-n)),a=0,i=[];const c={D:n,T:o,u:86400*(t-n)-o,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(n+=1462),c.u>.9999&&(c.u=0,86400==++o&&(c.T=o=0,++n,++c.D)),60===n)i=r?[1317,10,29]:[1900,2,29],a=3;else if(0===n)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;const t=new Date(1900,0,1);t.setDate(t.getDate()+n-1),i=[t.getFullYear(),t.getMonth()+1,t.getDate()],a=t.getDay(),n<60&&(a=(a+6)%7),r&&(a=0)}return c.y=i[0],c.m=i[1],c.d=i[2],c.S=o%60,o=Math.floor(o/60),c.M=o%60,o=Math.floor(o/60),c.H=o,c.q=a,c}h(p),e.parse_date_code=m;const v=new Date(1899,11,31,0,0,0),g=v.getTime(),E=new Date(1900,2,1,0,0,0);function y(t,e){let r=t.getTime();return e?r-=1262304e5:t>=E&&(r+=864e5),(r-(g+6e4*(t.getTimezoneOffset()-v.getTimezoneOffset())))/864e5}function N(t){return t.toString(10)}e._general_int=N;const R=function(){const t=/\.(\d*[1-9])0+$/,e=/\.0*$/,r=/\.(\d*[1-9])0+/,n=/\.0*[Ee]/,o=/(E[+-])(\d)$/;function a(r){return r.indexOf(".")>-1?r.replace(e,"").replace(t,".$1"):r}return function(e){let i,c=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return i=c>=-4&&c<=-1?e.toPrecision(10+c):Math.abs(c)<=9?function(t){const e=t<0?12:11;let r=a(t.toFixed(12));return r.length<=e?r:(r=t.toPrecision(10),r.length<=e?r:t.toExponential(5))}(e):10===c?e.toFixed(10).substr(0,12):function(e){let r=e.toFixed(11).replace(t,".$1");return r.length>(e<0?12:11)&&(r=e.toPrecision(6)),r}(e),a(function(t){for(let e=0;e!==t.length;++e)if(101==(32|t.charCodeAt(e)))return t.replace(r,".$1").replace(n,"E").replace("e","E").replace(o,"$10$2");return t}(i))}}();function T(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(0|t)===t?N(t):R(t);case"undefined":return"";case"object":if(null==t)return"";if(t instanceof Date)return L(14,y(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function A(t,e,r,n){let a,i="",c=0,s=0,u=r.y,h=0;switch(t){case 98:u=r.y+543;case 121:switch(e.length){case 1:case 2:a=u%100,h=2;break;default:a=u%1e4,h=4}break;case 109:switch(e.length){case 1:case 2:a=r.m,h=e.length;break;case 3:return f[r.m-1][1];case 5:return f[r.m-1][0];default:return f[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:a=r.d,h=e.length;break;case 3:return l[r.q][0];default:return l[r.q][1]}break;case 104:switch(e.length){case 1:case 2:a=1+(r.H+11)%12,h=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:a=r.H,h=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:a=r.M,h=e.length;break;default:throw"bad minute format: "+e}break;case 115:if("s"!==e&&"ss"!==e&&".0"!==e&&".00"!==e&&".000"!==e)throw"bad second format: "+e;return 0!==r.u||"s"!==e&&"ss"!==e?(s=n>=2?3===n?1e3:100:1===n?10:1,c=Math.round(s*(r.S+r.u)),c>=60*s&&(c=0),"s"===e?0===c?"0":""+c/s:(i=o(c,2+n),"ss"===e?i.substr(0,2):"."+i.substr(2,e.length-1))):o(r.S,e.length);case 90:switch(e){case"[h]":case"[hh]":a=24*r.D+r.H;break;case"[m]":case"[mm]":a=60*(24*r.D+r.H)+r.M;break;case"[s]":case"[ss]":a=60*(60*(24*r.D+r.H)+r.M)+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}h=3===e.length?1:2;break;case 101:a=u,h=1}return h>0?o(a,h):""}function M(t){if(t.length<=3)return t;let e=t.length%3,r=t.substr(0,e);for(;e!==t.length;e+=3)r+=(r.length>0?",":"")+t.substr(e,3);return r}e._general_num=R,e._general=T;const w=function(){const t=/%/g;function e(t,r){let n,o=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0===r)return"0.0E+0";if(r<0)return"-"+e(t,-r);let a=t.indexOf(".");-1===a&&(a=t.indexOf("E"));let i=Math.floor(Math.log(r)*Math.LOG10E)%a;if(i<0&&(i+=a),n=(r/Math.pow(10,i)).toPrecision(o+1+(a+i)%a),-1===n.indexOf("e")){const t=Math.floor(Math.log(r)*Math.LOG10E);for(-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(t-n.length+i):n+="E+"+(t-i);"0."===n.substr(0,2);)n=n.charAt(0)+n.substr(2,a)+"."+n.substr(2+a),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(t,e,r,n){return e+r+n.substr(0,(a+i)%a)+"."+n.substr(i)+"E"}))}else n=r.toExponential(o);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}const c=/# (\?+)( ?)\/( ?)(\d+)/;const u=/^#*0*\.([0#]+)/,l=/\).*[0#]/,f=/\(###\) ###\\?-####/;function h(t){let e,r="";for(let n=0;n!==t.length;++n)switch(e=t.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(e)}return r}function p(t,e){const r=Math.pow(10,e);return""+Math.round(t*r)/r}function m(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?0:Math.round((t-Math.floor(t))*Math.pow(10,e))}function v(g,E,y){if(40===g.charCodeAt(0)&&!E.match(l)){const t=E.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return y>=0?v("n",t,y):"("+v("n",t,-y)+")"}if(44===E.charCodeAt(E.length-1))return function(t,e,r){let n=e.length-1;for(;44===e.charCodeAt(n-1);)--n;return w(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}(g,E,y);if(-1!==E.indexOf("%"))return function(e,r,o){const a=r.replace(t,""),i=r.length-a.length;return w(e,a,o*Math.pow(10,2*i))+n("%",i)}(g,E,y);if(-1!==E.indexOf("E"))return e(E,y);if(36===E.charCodeAt(0))return"$"+v(g,E.substr(" "==E.charAt(1)?2:1),y);let N,R,T,A,O=Math.abs(y),I=y<0?"-":"";if(E.match(/^00+$/))return I+s(O,E.length);if(E.match(/^[#?]+$/))return N=s(y,0),"0"===N&&(N=""),N.length>E.length?N:h(E.substr(0,E.length-N.length))+N;if(R=E.match(c))return function(t,e,r){const i=parseInt(t[4],10),c=Math.round(e*i),s=Math.floor(c/i);let u=c-s*i,l=i;return r+(0===s?"":""+s)+" "+(0===u?n(" ",t[1].length+1+t[4].length):a(u,t[1].length)+t[2]+"/"+t[3]+o(l,t[4].length))}(R,O,I);if(E.match(/^#+0+$/))return I+s(O,E.length-E.indexOf("0"));if(R=E.match(u))return N=p(y,R[1].length).replace(/^([^\.]+)$/,"$1."+h(R[1])).replace(/\.$/,"."+h(R[1])).replace(/\.(\d*)$/,(function(t,e){return"."+e+n("0",h(R[1]).length-e.length)})),-1!==E.indexOf("0.")?N:N.replace(/^0\./,".");if(E=E.replace(/^#+([0.])/,"$1"),R=E.match(/^(0*)\.(#*)$/))return I+p(O,R[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,R[1].length?"0.":".");if(R=E.match(/^#{1,3},##0(\.?)$/))return I+M(s(O,0));if(R=E.match(/^#,##0\.([#0]*0)$/))return y<0?"-"+v(g,E,-y):M(""+(Math.floor(y)+function(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}(y,R[1].length)))+"."+o(m(y,R[1].length),R[1].length);if(R=E.match(/^#,#*,#0/))return v(g,E.replace(/^#,#*,/,""),y);if(R=E.match(/^([0#]+)(\\?-([0#]+))+$/))return N=r(v(g,E.replace(/[\\-]/g,""),y)),T=0,r(r(E.replace(/\\/g,"")).replace(/[0#]/g,(function(t){return T<N.length?N.charAt(T++):"0"===t?"0":""})));if(E.match(f))return N=v(g,"##########",y),"("+N.substr(0,3)+") "+N.substr(3,3)+"-"+N.substr(6);let S="";if(R=E.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return T=Math.min(R[4].length,7),A=d(O,Math.pow(10,T)-1,!1),N=""+I,S=w("n",R[1],A[1])," "===S.charAt(S.length-1)&&(S=S.substr(0,S.length-1)+"0"),N+=S+R[2]+"/"+R[3],S=i(A[2],T),S.length<R[4].length&&(S=h(R[4].substr(R[4].length-S.length))+S),N+=S,N;if(R=E.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return T=Math.min(Math.max(R[1].length,R[4].length),7),A=d(O,Math.pow(10,T)-1,!0),I+(A[0]||(A[1]?"":"0"))+" "+(A[1]?a(A[1],T)+R[2]+"/"+R[3]+i(A[2],T):n(" ",2*T+1+R[2].length+R[3].length));if(R=E.match(/^[#0?]+$/))return N=s(y,0),E.length<=N.length?N:h(E.substr(0,E.length-N.length))+N;if(R=E.match(/^([#0?]+)\.([#0]+)$/)){N=""+y.toFixed(Math.min(R[2].length,10)).replace(/([^0])0+$/,"$1"),T=N.indexOf(".");const t=E.indexOf(".")-T,e=E.length-N.length-t;return h(E.substr(0,t)+N+E.substr(E.length-e))}if(R=E.match(/^00,000\.([#0]*0)$/))return T=m(y,R[1].length),y<0?"-"+v(g,E,-y):M(function(t){return t<2147483647&&t>-2147483648?""+(t>=0?0|t:t-1|0):""+Math.floor(t)}(y)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(t){return"00,"+(t.length<3?o(0,3-t.length):"")+t}))+"."+o(T,R[1].length);switch(E){case"###,##0.00":return v(g,"#,##0.00",y);case"###,###":case"##,###":case"#,###":const t=M(s(O,0));return"0"!==t?I+t:"";case"###,###.00":return v(g,"###,##0.00",y).replace(/^0\./,".");case"#,###.00":return v(g,"#,##0.00",y).replace(/^0\./,".")}throw new Error("unsupported format |"+E+"|")}function g(t,e){let r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0===e)return"0.0E+0";if(e<0)return"-"+g(t,-e);let o=t.indexOf(".");-1===o&&(o=t.indexOf("E"));let a=Math.floor(Math.log(e)*Math.LOG10E)%o;if(a<0&&(a+=o),r=(e/Math.pow(10,a)).toPrecision(n+1+(o+a)%o),!r.match(/[Ee]/)){const t=Math.floor(Math.log(e)*Math.LOG10E);-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(t-r.length+a):r+="E+"+(t-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(t,e,r,n){return e+r+n.substr(0,(o+a)%o)+"."+n.substr(a)+"E"}))}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function E(e,s,p){if(40===e.charCodeAt(0)&&!s.match(l)){const t=s.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return p>=0?E("n",t,p):"("+E("n",t,-p)+")"}if(44===s.charCodeAt(s.length-1))return function(t,e,r){let n=e.length-1;for(;44===e.charCodeAt(n-1);)--n;return w(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}(e,s,p);if(-1!==s.indexOf("%"))return function(e,r,o){const a=r.replace(t,""),i=r.length-a.length;return w(e,a,o*Math.pow(10,2*i))+n("%",i)}(e,s,p);if(-1!==s.indexOf("E"))return g(s,p);if(36===s.charCodeAt(0))return"$"+E(e,s.substr(" "==s.charAt(1)?2:1),p);let m,v,y,N,R=Math.abs(p),T=p<0?"-":"";if(s.match(/^00+$/))return T+o(R,s.length);if(s.match(/^[#?]+$/))return m=""+p,0===p&&(m=""),m.length>s.length?m:h(s.substr(0,s.length-m.length))+m;if(v=s.match(c))return function(t,e,r){return r+(0===e?"":""+e)+n(" ",t[1].length+2+t[4].length)}(v,R,T);if(s.match(/^#+0+$/))return T+o(R,s.length-s.indexOf("0"));if(v=s.match(u))return m=(""+p).replace(/^([^\.]+)$/,"$1."+h(v[1])).replace(/\.$/,"."+h(v[1])),m=m.replace(/\.(\d*)$/,(function(t,e){return"."+e+n("0",h(v[1]).length-e.length)})),-1!==s.indexOf("0.")?m:m.replace(/^0\./,".");if(s=s.replace(/^#+([0.])/,"$1"),v=s.match(/^(0*)\.(#*)$/))return T+(""+R).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,v[1].length?"0.":".");if(v=s.match(/^#{1,3},##0(\.?)$/))return T+M(""+R);if(v=s.match(/^#,##0\.([#0]*0)$/))return p<0?"-"+E(e,s,-p):M(""+p)+"."+n("0",v[1].length);if(v=s.match(/^#,#*,#0/))return E(e,s.replace(/^#,#*,/,""),p);if(v=s.match(/^([0#]+)(\\?-([0#]+))+$/))return m=r(E(e,s.replace(/[\\-]/g,""),p)),y=0,r(r(s.replace(/\\/g,"")).replace(/[0#]/g,(function(t){return y<m.length?m.charAt(y++):"0"===t?"0":""})));if(s.match(f))return m=E(e,"##########",p),"("+m.substr(0,3)+") "+m.substr(3,3)+"-"+m.substr(6);let A="";if(v=s.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return y=Math.min(v[4].length,7),N=d(R,Math.pow(10,y)-1,!1),m=""+T,A=w("n",v[1],N[1])," "==A.charAt(A.length-1)&&(A=A.substr(0,A.length-1)+"0"),m+=A+v[2]+"/"+v[3],A=i(N[2],y),A.length<v[4].length&&(A=h(v[4].substr(v[4].length-A.length))+A),m+=A,m;if(v=s.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return y=Math.min(Math.max(v[1].length,v[4].length),7),N=d(R,Math.pow(10,y)-1,!0),T+(N[0]||(N[1]?"":"0"))+" "+(N[1]?a(N[1],y)+v[2]+"/"+v[3]+i(N[2],y):n(" ",2*y+1+v[2].length+v[3].length));if(v=s.match(/^[#0?]+$/))return m=""+p,s.length<=m.length?m:h(s.substr(0,s.length-m.length))+m;if(v=s.match(/^([#0]+)\.([#0]+)$/)){m=""+p.toFixed(Math.min(v[2].length,10)).replace(/([^0])0+$/,"$1"),y=m.indexOf(".");let t=s.indexOf(".")-y,e=s.length-m.length-t;return h(s.substr(0,t)+m+s.substr(s.length-e))}if(v=s.match(/^00,000\.([#0]*0)$/))return p<0?"-"+E(e,s,-p):M(""+p).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(t){return"00,"+(t.length<3?o(0,3-t.length):"")+t}))+"."+o(0,v[1].length);switch(s){case"###,###":case"##,###":case"#,###":const t=M(""+R);return"0"!==t?T+t:"";default:if(s.match(/\.[0#?]*$/))return E(e,s.slice(0,s.lastIndexOf(".")),p)+h(s.slice(s.lastIndexOf(".")))}throw new Error("unsupported format |"+s+"|")}return function(t,e,r){return(0|r)===r?E(t,e,r):v(t,e,r)}}();function O(t){const e=[];let r=!1,n=0;for(let o=0;o<t.length;++o)switch(t.charCodeAt(o)){case 34:r=!r;break;case 95:case 42:case 92:++o;break;case 59:e[e.length]=t.substr(n,o-n),n=o+1}if(e[e.length]=t.substr(n),!0===r)throw new Error("Format |"+t+"| unterminated string ");return e}e._split=O;const I=/\[[HhMmSs]*\]/;function S(t){let e=0,r="",n="";for(;e<t.length;)switch(r=t.charAt(e)){case"G":u(t,e)&&(e+=6),e++;break;case'"':for(;34!==t.charCodeAt(++e)&&e<t.length;)++e;++e;break;case"\\":case"_":e+=2;break;case"@":++e;break;case"B":case"b":if("1"===t.charAt(e+1)||"2"===t.charAt(e+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":if("A/P"===t.substr(e,3).toUpperCase())return!0;if("AM/PM"===t.substr(e,5).toUpperCase())return!0;++e;break;case"[":for(n=r;"]"!==t.charAt(e++)&&e<t.length;)n+=t.charAt(e);if(n.match(I))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||"\\"==r&&"-"==t.charAt(e+1)&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e," "!==t.charAt(e)&&"*"!==t.charAt(e)||++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;default:++e}return!1}function C(t,e,r,n){let o,a,i,c=[],s="",l=0,f="",h="t",p="H";for(;l<t.length;)switch(f=t.charAt(l)){case"G":if(!u(t,l))throw new Error("unrecognized character "+f+" in "+t);c[c.length]={t:"G",v:"General"},l+=7;break;case'"':for(s="";34!==(i=t.charCodeAt(++l))&&l<t.length;)s+=String.fromCharCode(i);c[c.length]={t:"t",v:s},++l;break;case"\\":const a=t.charAt(++l),d="("===a||")"===a?a:"t";c[c.length]={t:d,v:a},++l;break;case"_":c[c.length]={t:"t",v:" "},l+=2;break;case"@":c[c.length]={t:"T",v:e},++l;break;case"B":case"b":if("1"===t.charAt(l+1)||"2"===t.charAt(l+1)){if(null==o&&(o=m(e,r,"2"===t.charAt(l+1)),null==o))return"";c[c.length]={t:"X",v:t.substr(l,2)},h=f,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":f=f.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0)return"";if(null==o&&(o=m(e,r),null==o))return"";for(s=f;++l<t.length&&t.charAt(l).toLowerCase()===f;)s+=f;"m"===f&&"h"===h.toLowerCase()&&(f="M"),"h"===f&&(f=p),c[c.length]={t:f,v:s},h=f;break;case"A":case"a":const v={t:f,v:f};if(null==o&&(o=m(e,r)),"A/P"===t.substr(l,3).toUpperCase()?(null!=o&&(v.v=o.H>=12?"P":"A"),v.t="T",p="h",l+=3):"AM/PM"===t.substr(l,5).toUpperCase()?(null!=o&&(v.v=o.H>=12?"PM":"AM"),v.t="T",l+=5,p="h"):(v.t="t",++l),null==o&&"T"===v.t)return"";c[c.length]=v,h=f;break;case"[":for(s=f;"]"!==t.charAt(l++)&&l<t.length;)s+=t.charAt(l);if("]"!==s.slice(-1))throw'unterminated "[" block: |'+s+"|";if(s.match(I)){if(null==o&&(o=m(e,r),null==o))return"";c[c.length]={t:"Z",v:s.toLowerCase()},h=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",S(t)||(c[c.length]={t:"t",v:s}));break;case".":if(null!=o){for(s=f;++l<t.length&&"0"===(f=t.charAt(l));)s+=f;c[c.length]={t:"s",v:s};break}case"0":case"#":for(s=f;++l<t.length&&"0#?.,E+-%".indexOf(f=t.charAt(l))>-1||"\\"==f&&"-"==t.charAt(l+1)&&l<t.length-2&&"0#".indexOf(t.charAt(l+2))>-1;)s+=f;c[c.length]={t:"n",v:s};break;case"?":for(s=f;t.charAt(++l)===f;)s+=f;c[c.length]={t:f,v:s},h=f;break;case"*":++l," "!==t.charAt(l)&&"*"!==t.charAt(l)||++l;break;case"(":case")":c[c.length]={t:1===n||"number"==typeof e&&e<0?"t":f,v:f},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=f;l<t.length&&"0123456789".indexOf(t.charAt(++l))>-1;)s+=t.charAt(l);c[c.length]={t:"D",v:s};break;case" ":c[c.length]={t:f,v:f},++l;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(f))throw new Error("unrecognized character "+f+" in "+t);c[c.length]={t:"t",v:f},++l}let d,v=0,g=0;for(l=c.length-1,h="t";l>=0;--l)switch(c[l].t){case"h":case"H":c[l].t=p,h="h",v<1&&(v=1);break;case"s":(d=c[l].v.match(/\.0+$/))&&(g=Math.max(g,d[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":h=c[l].t;break;case"m":"s"===h&&(c[l].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&c[l].v.match(/[Hh]/)&&(v=1),v<2&&c[l].v.match(/[Mm]/)&&(v=2),v<3&&c[l].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:o.u>=.5&&(o.u=0,++o.S),o.S>=60&&(o.S=0,++o.M),o.M>=60&&(o.M=0,++o.H);break;case 2:o.u>=.5&&(o.u=0,++o.S),o.S>=60&&(o.S=0,++o.M)}let E,y="";for(l=0;l<c.length;++l)switch(c[l].t){case"t":case"T":case" ":case"D":break;case"X":c[l].v="",c[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":c[l].v=A(c[l].t.charCodeAt(0),c[l].v,o,g),c[l].t="t";break;case"n":case"(":case"?":for(E=l+1;null!=c[E]&&("?"===(f=c[E].t)||"D"===f||(" "===f||"t"===f)&&null!=c[E+1]&&("?"===c[E+1].t||"t"===c[E+1].t&&"/"===c[E+1].v)||"("===c[l].t&&(" "===f||"n"===f||")"===f)||"t"===f&&("/"===c[E].v||" "===c[E].v&&null!=c[E+1]&&"?"===c[E+1].t));)c[l].v+=c[E].v,c[E]={v:"",t:";"},++E;y+=c[l].v,l=E-1;break;case"G":c[l].t="t",c[l].v=T(e,r)}let N,R,M="";if(y.length>0){40===y.charCodeAt(0)?(N=e<0&&45===y.charCodeAt(0)?-e:e,R=w("(",y,N)):(N=e<0&&n>1?-e:e,R=w("n",y,N),N<0&&c[0]&&"t"===c[0].t&&(R=R.substr(1),c[0].v="-"+c[0].v)),E=R.length-1;let t=c.length;for(l=0;l<c.length;++l)if(null!=c[l]&&"t"!==c[l].t&&c[l].v.indexOf(".")>-1){t=l;break}let r=c.length;if(t===c.length&&-1===R.indexOf("E")){for(l=c.length-1;l>=0;--l)null!=c[l]&&-1!=="n?(".indexOf(c[l].t)&&(E>=c[l].v.length-1?(E-=c[l].v.length,c[l].v=R.substr(E+1,c[l].v.length)):E<0?c[l].v="":(c[l].v=R.substr(0,E+1),E=-1),c[l].t="t",r=l);E>=0&&r<c.length&&(c[r].v=R.substr(0,E+1)+c[r].v)}else if(t!==c.length&&-1===R.indexOf("E")){for(E=R.indexOf(".")-1,l=t;l>=0;--l)if(null!=c[l]&&-1!=="n?(".indexOf(c[l].t)){for(a=c[l].v.indexOf(".")>-1&&l===t?c[l].v.indexOf(".")-1:c[l].v.length-1,M=c[l].v.substr(a+1);a>=0;--a)E>=0&&("0"===c[l].v.charAt(a)||"#"===c[l].v.charAt(a))&&(M=R.charAt(E--)+M);c[l].v=M,c[l].t="t",r=l}for(E>=0&&r<c.length&&(c[r].v=R.substr(0,E+1)+c[r].v),E=R.indexOf(".")+1,l=t;l<c.length;++l)if(null!=c[l]&&(-1!=="n?(".indexOf(c[l].t)||l===t)){for(a=c[l].v.indexOf(".")>-1&&l===t?c[l].v.indexOf(".")+1:0,M=c[l].v.substr(0,a);a<c[l].v.length;++a)E<R.length&&(M+=R.charAt(E++));c[l].v=M,c[l].t="t",r=l}}}for(l=0;l<c.length;++l)null!=c[l]&&"n(?".indexOf(c[l].t)>-1&&(N=n>1&&e<0&&l>0&&"-"===c[l-1].v?-e:e,c[l].v=w(c[l].t,c[l].v,N),c[l].t="t");let O="";for(l=0;l!==c.length;++l)null!=c[l]&&(O+=c[l].v);return O}e.is_date=S,e._eval=C;const b=/\[[=<>]/,U=/\[([=<>]*)(-?\d+\.?\d*)\]/;function x(t,e){if(null==e)return!1;const r=parseFloat(e[2]);switch(e[1]){case"=":if(t===r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!==r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0}return!1}function L(t,e,r){null==r&&(r={});let n="";switch(typeof t){case"string":n="m/d/yy"===t&&r.dateNF?r.dateNF:t;break;case"number":n=14===t&&r.dateNF?r.dateNF:(null!=r.table?r.table:p)[t]}if(u(n,0))return T(e,r);e instanceof Date&&(e=y(e,r.date1904));const o=function(t,e){let r=O(t),n=r.length,o=r[n-1].indexOf("@");if(n<4&&o>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if("number"!=typeof e)return[4,4===r.length||o>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=o>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=o>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=o>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}const a=e>0?r[0]:e<0?r[1]:r[2];if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return[n,a];if(null!=r[0].match(b)||null!=r[1].match(b)){const t=r[0].match(U),o=r[1].match(U);return x(e,t)?[n,r[0]]:x(e,o)?[n,r[1]]:[n,r[null!=t&&null!=o?2:1]]}return[n,a]}(n,e);if(u(o[1]))return T(e,r);if(!0===e)e="TRUE";else if(!1===e)e="FALSE";else if(""===e||null==e)return"";return C(o[1],e,r,o[0])}function _(t,e){if("number"!=typeof e){e=+e||-1;for(let r=0;r<392;++r)if(void 0!==p[r]){if(p[r]===t){e=r;break}}else e<0&&(e=r);e<0&&(e=391)}return p[e]=t,e}e.load=_,e._table=p,e.get_table=function(){return p},e.load_table=function(t){for(let e=0;392!==e;++e)void 0!==t[e]&&_(t[e],e)},e.init_table=h,e.format=L,t.exports=e},6572:function(t){var e;t.exports=(e=function(t,e){var r=Array.prototype.concat,n=Array.prototype.slice,o=Object.prototype.toString;function a(e,r){var n=e>r?e:r;return t.pow(10,17-~~(t.log(n>0?n:-n)*t.LOG10E))}var i=Array.isArray||function(t){return"[object Array]"===o.call(t)};function c(t){return"[object Function]"===o.call(t)}function s(t){return"number"==typeof t&&t-t==0}function u(t){return r.apply([],t)}function l(){return new l._init(arguments)}function f(){return 0}function h(){return 1}function p(t,e){return t===e?1:0}l.fn=l.prototype,l._init=function(t){if(i(t[0]))if(i(t[0][0])){c(t[1])&&(t[0]=l.map(t[0],t[1]));for(var e=0;e<t[0].length;e++)this[e]=t[0][e];this.length=t[0].length}else this[0]=c(t[1])?l.map(t[0],t[1]):t[0],this.length=1;else if(s(t[0]))this[0]=l.seq.apply(null,t),this.length=1;else{if(t[0]instanceof l)return l(t[0].toArray());this[0]=[],this.length=1}return this},l._init.prototype=l.prototype,l._init.constructor=l,l.utils={calcRdx:a,isArray:i,isFunction:c,isNumber:s,toVector:u},l._random_fn=t.random,l.setRandom=function(t){if("function"!=typeof t)throw new TypeError("fn is not a function");l._random_fn=t},l.extend=function(t){var e,r;if(1===arguments.length){for(r in t)l[r]=t[r];return this}for(e=1;e<arguments.length;e++)for(r in arguments[e])t[r]=arguments[e][r];return t},l.rows=function(t){return t.length||1},l.cols=function(t){return t[0].length||1},l.dimensions=function(t){return{rows:l.rows(t),cols:l.cols(t)}},l.row=function(t,e){return i(e)?e.map((function(e){return l.row(t,e)})):t[e]},l.rowa=function(t,e){return l.row(t,e)},l.col=function(t,e){if(i(e)){var r=l.arange(t.length).map((function(){return new Array(e.length)}));return e.forEach((function(e,n){l.arange(t.length).forEach((function(o){r[o][n]=t[o][e]}))})),r}for(var n=new Array(t.length),o=0;o<t.length;o++)n[o]=[t[o][e]];return n},l.cola=function(t,e){return l.col(t,e).map((function(t){return t[0]}))},l.diag=function(t){for(var e=l.rows(t),r=new Array(e),n=0;n<e;n++)r[n]=[t[n][n]];return r},l.antidiag=function(t){for(var e=l.rows(t)-1,r=new Array(e),n=0;e>=0;e--,n++)r[n]=[t[n][e]];return r},l.transpose=function(t){var e,r,n,o,a,c=[];for(i(t[0])||(t=[t]),r=t.length,n=t[0].length,a=0;a<n;a++){for(e=new Array(r),o=0;o<r;o++)e[o]=t[o][a];c.push(e)}return 1===c.length?c[0]:c},l.map=function(t,e,r){var n,o,a,c,s;for(i(t[0])||(t=[t]),o=t.length,a=t[0].length,c=r?t:new Array(o),n=0;n<o;n++)for(c[n]||(c[n]=new Array(a)),s=0;s<a;s++)c[n][s]=e(t[n][s],n,s);return 1===c.length?c[0]:c},l.cumreduce=function(t,e,r){var n,o,a,c,s;for(i(t[0])||(t=[t]),o=t.length,a=t[0].length,c=r?t:new Array(o),n=0;n<o;n++)for(c[n]||(c[n]=new Array(a)),a>0&&(c[n][0]=t[n][0]),s=1;s<a;s++)c[n][s]=e(c[n][s-1],t[n][s]);return 1===c.length?c[0]:c},l.alter=function(t,e){return l.map(t,e,!0)},l.create=function(t,e,r){var n,o,a=new Array(t);for(c(e)&&(r=e,e=t),n=0;n<t;n++)for(a[n]=new Array(e),o=0;o<e;o++)a[n][o]=r(n,o);return a},l.zeros=function(t,e){return s(e)||(e=t),l.create(t,e,f)},l.ones=function(t,e){return s(e)||(e=t),l.create(t,e,h)},l.rand=function(t,e){return s(e)||(e=t),l.create(t,e,l._random_fn)},l.identity=function(t,e){return s(e)||(e=t),l.create(t,e,p)},l.symmetric=function(t){var e,r,n=t.length;if(t.length!==t[0].length)return!1;for(e=0;e<n;e++)for(r=0;r<n;r++)if(t[r][e]!==t[e][r])return!1;return!0},l.clear=function(t){return l.alter(t,f)},l.seq=function(t,e,r,n){c(n)||(n=!1);var o,i=[],s=a(t,e),u=(e*s-t*s)/((r-1)*s),l=t;for(o=0;l<=e&&o<r;l=(t*s+u*s*++o)/s)i.push(n?n(l,o):l);return i},l.arange=function(t,r,n){var o,a=[];if(n=n||1,r===e&&(r=t,t=0),t===r||0===n)return[];if(t<r&&n<0)return[];if(t>r&&n>0)return[];if(n>0)for(o=t;o<r;o+=n)a.push(o);else for(o=t;o>r;o+=n)a.push(o);return a},l.slice=function(){function t(t,r,n,o){var a,i=[],c=t.length;if(r===e&&n===e&&o===e)return l.copy(t);if(o=o||1,(r=(r=r||0)>=0?r:c+r)===(n=(n=n||t.length)>=0?n:c+n)||0===o)return[];if(r<n&&o<0)return[];if(r>n&&o>0)return[];if(o>0)for(a=r;a<n;a+=o)i.push(t[a]);else for(a=r;a>n;a+=o)i.push(t[a]);return i}function r(e,r){var n,o;return s((r=r||{}).row)?s(r.col)?e[r.row][r.col]:t(l.rowa(e,r.row),(n=r.col||{}).start,n.end,n.step):s(r.col)?t(l.cola(e,r.col),(o=r.row||{}).start,o.end,o.step):(o=r.row||{},n=r.col||{},t(e,o.start,o.end,o.step).map((function(e){return t(e,n.start,n.end,n.step)})))}return r}(),l.sliceAssign=function(r,n,o){var a,i;if(s(n.row)){if(s(n.col))return r[n.row][n.col]=o;n.col=n.col||{},n.col.start=n.col.start||0,n.col.end=n.col.end||r[0].length,n.col.step=n.col.step||1,a=l.arange(n.col.start,t.min(r.length,n.col.end),n.col.step);var c=n.row;return a.forEach((function(t,e){r[c][t]=o[e]})),r}if(s(n.col)){n.row=n.row||{},n.row.start=n.row.start||0,n.row.end=n.row.end||r.length,n.row.step=n.row.step||1,i=l.arange(n.row.start,t.min(r[0].length,n.row.end),n.row.step);var u=n.col;return i.forEach((function(t,e){r[t][u]=o[e]})),r}return o[0].length===e&&(o=[o]),n.row.start=n.row.start||0,n.row.end=n.row.end||r.length,n.row.step=n.row.step||1,n.col.start=n.col.start||0,n.col.end=n.col.end||r[0].length,n.col.step=n.col.step||1,i=l.arange(n.row.start,t.min(r.length,n.row.end),n.row.step),a=l.arange(n.col.start,t.min(r[0].length,n.col.end),n.col.step),i.forEach((function(t,e){a.forEach((function(n,a){r[t][n]=o[e][a]}))})),r},l.diagonal=function(t){var e=l.zeros(t.length,t.length);return t.forEach((function(t,r){e[r][r]=t})),e},l.copy=function(t){return t.map((function(t){return s(t)?t:t.map((function(t){return t}))}))};var d=l.prototype;return d.length=0,d.push=Array.prototype.push,d.sort=Array.prototype.sort,d.splice=Array.prototype.splice,d.slice=Array.prototype.slice,d.toArray=function(){return this.length>1?n.call(this):n.call(this)[0]},d.map=function(t,e){return l(l.map(this,t,e))},d.cumreduce=function(t,e){return l(l.cumreduce(this,t,e))},d.alter=function(t){return l.alter(this,t),this},function(t){for(var e=0;e<t.length;e++)!function(t){d[t]=function(e){var r,n=this;return e?(setTimeout((function(){e.call(n,d[t].call(n))})),this):(r=l[t](this),i(r)?l(r):r)}}(t[e])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){d[t]=function(e,r){var n=this;return r?(setTimeout((function(){r.call(n,d[t].call(n,e))})),this):l(l[t](this,e))}}(t[e])}("row col".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){d[t]=function(){return l(l[t].apply(null,arguments))}}(t[e])}("create zeros ones rand identity".split(" ")),l}(Math),function(t,e){var r=t.utils.isFunction;function n(t,e){return t-e}function o(t,r,n){return e.max(r,e.min(t,n))}t.sum=function(t){for(var e=0,r=t.length;--r>=0;)e+=t[r];return e},t.sumsqrd=function(t){for(var e=0,r=t.length;--r>=0;)e+=t[r]*t[r];return e},t.sumsqerr=function(e){for(var r,n=t.mean(e),o=0,a=e.length;--a>=0;)o+=(r=e[a]-n)*r;return o},t.sumrow=function(t){for(var e=0,r=t.length;--r>=0;)e+=t[r];return e},t.product=function(t){for(var e=1,r=t.length;--r>=0;)e*=t[r];return e},t.min=function(t){for(var e=t[0],r=0;++r<t.length;)t[r]<e&&(e=t[r]);return e},t.max=function(t){for(var e=t[0],r=0;++r<t.length;)t[r]>e&&(e=t[r]);return e},t.unique=function(t){for(var e={},r=[],n=0;n<t.length;n++)e[t[n]]||(e[t[n]]=!0,r.push(t[n]));return r},t.mean=function(e){return t.sum(e)/e.length},t.meansqerr=function(e){return t.sumsqerr(e)/e.length},t.geomean=function(r){var n=r.map(e.log),o=t.mean(n);return e.exp(o)},t.median=function(t){var e=t.length,r=t.slice().sort(n);return 1&e?r[e/2|0]:(r[e/2-1]+r[e/2])/2},t.cumsum=function(e){return t.cumreduce(e,(function(t,e){return t+e}))},t.cumprod=function(e){return t.cumreduce(e,(function(t,e){return t*e}))},t.diff=function(t){var e,r=[],n=t.length;for(e=1;e<n;e++)r.push(t[e]-t[e-1]);return r},t.rank=function(t){var e,r=[],o={};for(e=0;e<t.length;e++)o[s=t[e]]?o[s]++:(o[s]=1,r.push(s));var a=r.sort(n),i={},c=1;for(e=0;e<a.length;e++){var s,u=o[s=a[e]],l=(c+(c+u-1))/2;i[s]=l,c+=u}return t.map((function(t){return i[t]}))},t.mode=function(t){var e,r=t.length,o=t.slice().sort(n),a=1,i=0,c=0,s=[];for(e=0;e<r;e++)o[e]===o[e+1]?a++:(a>i?(s=[o[e]],i=a,c=0):a===i&&(s.push(o[e]),c++),a=1);return 0===c?s[0]:s},t.range=function(e){return t.max(e)-t.min(e)},t.variance=function(e,r){return t.sumsqerr(e)/(e.length-(r?1:0))},t.pooledvariance=function(e){return e.reduce((function(e,r){return e+t.sumsqerr(r)}),0)/(e.reduce((function(t,e){return t+e.length}),0)-e.length)},t.deviation=function(e){for(var r=t.mean(e),n=e.length,o=new Array(n),a=0;a<n;a++)o[a]=e[a]-r;return o},t.stdev=function(r,n){return e.sqrt(t.variance(r,n))},t.pooledstdev=function(r){return e.sqrt(t.pooledvariance(r))},t.meandev=function(r){for(var n=t.mean(r),o=[],a=r.length-1;a>=0;a--)o.push(e.abs(r[a]-n));return t.mean(o)},t.meddev=function(r){for(var n=t.median(r),o=[],a=r.length-1;a>=0;a--)o.push(e.abs(r[a]-n));return t.median(o)},t.coeffvar=function(e){return t.stdev(e)/t.mean(e)},t.quartiles=function(t){var r=t.length,o=t.slice().sort(n);return[o[e.round(r/4)-1],o[e.round(r/2)-1],o[e.round(3*r/4)-1]]},t.quantiles=function(t,r,a,i){var c,s,u,l,f,h=t.slice().sort(n),p=[r.length],d=t.length;for(void 0===a&&(a=3/8),void 0===i&&(i=3/8),c=0;c<r.length;c++)u=d*(s=r[c])+(a+s*(1-a-i)),l=e.floor(o(u,1,d-1)),f=o(u-l,0,1),p[c]=(1-f)*h[l-1]+f*h[l];return p},t.percentile=function(t,e,r){var o=t.slice().sort(n),a=e*(o.length+(r?1:-1))+(r?0:1),i=parseInt(a),c=a-i;return i+1<o.length?o[i-1]+c*(o[i]-o[i-1]):o[i-1]},t.percentileOfScore=function(t,e,r){var n,o,a=0,i=t.length,c=!1;for("strict"===r&&(c=!0),o=0;o<i;o++)n=t[o],(c&&n<e||!c&&n<=e)&&a++;return a/i},t.histogram=function(r,n){n=n||4;var o,a=t.min(r),i=(t.max(r)-a)/n,c=r.length,s=[];for(o=0;o<n;o++)s[o]=0;for(o=0;o<c;o++)s[e.min(e.floor((r[o]-a)/i),n-1)]+=1;return s},t.covariance=function(e,r){var n,o=t.mean(e),a=t.mean(r),i=e.length,c=new Array(i);for(n=0;n<i;n++)c[n]=(e[n]-o)*(r[n]-a);return t.sum(c)/(i-1)},t.corrcoeff=function(e,r){return t.covariance(e,r)/t.stdev(e,1)/t.stdev(r,1)},t.spearmancoeff=function(e,r){return e=t.rank(e),r=t.rank(r),t.corrcoeff(e,r)},t.stanMoment=function(r,n){for(var o=t.mean(r),a=t.stdev(r),i=r.length,c=0,s=0;s<i;s++)c+=e.pow((r[s]-o)/a,n);return c/r.length},t.skewness=function(e){return t.stanMoment(e,3)},t.kurtosis=function(e){return t.stanMoment(e,4)-3};var a=t.prototype;!function(e){for(var n=0;n<e.length;n++)!function(e){a[e]=function(n,o){var i=[],c=0,s=this;if(r(n)&&(o=n,n=!1),o)return setTimeout((function(){o.call(s,a[e].call(s,n))})),this;if(this.length>1){for(s=!0===n?this:this.transpose();c<s.length;c++)i[c]=t[e](s[c]);return i}return t[e](this[0],n)}}(e[n])}("cumsum cumprod".split(" ")),function(e){for(var n=0;n<e.length;n++)!function(e){a[e]=function(n,o){var i=[],c=0,s=this;if(r(n)&&(o=n,n=!1),o)return setTimeout((function(){o.call(s,a[e].call(s,n))})),this;if(this.length>1){for("sumrow"!==e&&(s=!0===n?this:this.transpose());c<s.length;c++)i[c]=t[e](s[c]);return!0===n?t[e](t.utils.toVector(i)):i}return t[e](this[0],n)}}(e[n])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(e){for(var n=0;n<e.length;n++)!function(e){a[e]=function(){var n,o=[],i=0,c=this,s=Array.prototype.slice.call(arguments);if(r(s[s.length-1])){n=s[s.length-1];var u=s.slice(0,s.length-1);return setTimeout((function(){n.call(c,a[e].apply(c,u))})),this}n=void 0;var l=function(r){return t[e].apply(c,[r].concat(s))};if(this.length>1){for(c=c.transpose();i<c.length;i++)o[i]=l(c[i]);return o}return l(this[0])}}(e[n])}("quantiles percentileOfScore".split(" "))}(e,Math),function(t,e){t.gammaln=function(t){var r,n,o,a=0,i=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],c=1.000000000190015;for(o=(n=r=t)+5.5,o-=(r+.5)*e.log(o);a<6;a++)c+=i[a]/++n;return e.log(2.5066282746310007*c/r)-o},t.loggam=function(t){var r,n,o,a,i,c,s,u=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(r=t,s=0,1==t||2==t)return 0;for(t<=7&&(r=t+(s=e.floor(7-t))),n=1/(r*r),o=2*e.PI,i=u[9],c=8;c>=0;c--)i*=n,i+=u[c];if(a=i/r+.5*e.log(o)+(r-.5)*e.log(r)-r,t<=7)for(c=1;c<=s;c++)a-=e.log(r-1),r-=1;return a},t.gammafn=function(t){var r,n,o,a,i=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],c=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],s=!1,u=0,l=0,f=0,h=t;if(t>171.6243769536076)return 1/0;if(h<=0){if(!(a=h%1+36e-17))return 1/0;s=(1&h?-1:1)*e.PI/e.sin(e.PI*a),h=1-h}for(o=h,n=h<1?h++:(h-=u=(0|h)-1)-1,r=0;r<8;++r)f=(f+i[r])*n,l=l*n+c[r];if(a=f/l+1,o<h)a/=o;else if(o>h)for(r=0;r<u;++r)a*=h,h++;return s&&(a=s/a),a},t.gammap=function(e,r){return t.lowRegGamma(e,r)*t.gammafn(e)},t.lowRegGamma=function(r,n){var o,a=t.gammaln(r),i=r,c=1/r,s=c,u=n+1-r,l=1/1e-30,f=1/u,h=f,p=1,d=-~(8.5*e.log(r>=1?r:1/r)+.4*r+17);if(n<0||r<=0)return NaN;if(n<r+1){for(;p<=d;p++)c+=s*=n/++i;return c*e.exp(-n+r*e.log(n)-a)}for(;p<=d;p++)h*=(f=1/(f=(o=-p*(p-r))*f+(u+=2)))*(l=u+o/l);return 1-h*e.exp(-n+r*e.log(n)-a)},t.factorialln=function(e){return e<0?NaN:t.gammaln(e+1)},t.factorial=function(e){return e<0?NaN:t.gammafn(e+1)},t.combination=function(r,n){return r>170||n>170?e.exp(t.combinationln(r,n)):t.factorial(r)/t.factorial(n)/t.factorial(r-n)},t.combinationln=function(e,r){return t.factorialln(e)-t.factorialln(r)-t.factorialln(e-r)},t.permutation=function(e,r){return t.factorial(e)/t.factorial(e-r)},t.betafn=function(r,n){if(!(r<=0||n<=0))return r+n>170?e.exp(t.betaln(r,n)):t.gammafn(r)*t.gammafn(n)/t.gammafn(r+n)},t.betaln=function(e,r){return t.gammaln(e)+t.gammaln(r)-t.gammaln(e+r)},t.betacf=function(t,r,n){var o,a,i,c,s=1e-30,u=1,l=r+n,f=r+1,h=r-1,p=1,d=1-l*t/f;for(e.abs(d)<s&&(d=s),c=d=1/d;u<=100&&(d=1+(a=u*(n-u)*t/((h+(o=2*u))*(r+o)))*d,e.abs(d)<s&&(d=s),p=1+a/p,e.abs(p)<s&&(p=s),c*=(d=1/d)*p,d=1+(a=-(r+u)*(l+u)*t/((r+o)*(f+o)))*d,e.abs(d)<s&&(d=s),p=1+a/p,e.abs(p)<s&&(p=s),c*=i=(d=1/d)*p,!(e.abs(i-1)<3e-7));u++);return c},t.gammapinv=function(r,n){var o,a,i,c,s,u,l=0,f=n-1,h=1e-8,p=t.gammaln(n);if(r>=1)return e.max(100,n+100*e.sqrt(n));if(r<=0)return 0;for(n>1?(s=e.log(f),u=e.exp(f*(s-1)-p),c=r<.5?r:1-r,o=(2.30753+.27061*(a=e.sqrt(-2*e.log(c))))/(1+a*(.99229+.04481*a))-a,r<.5&&(o=-o),o=e.max(.001,n*e.pow(1-1/(9*n)-o/(3*e.sqrt(n)),3))):o=r<(a=1-n*(.253+.12*n))?e.pow(r/a,1/n):1-e.log(1-(r-a)/(1-a));l<12;l++){if(o<=0)return 0;if((o-=a=(i=(t.lowRegGamma(n,o)-r)/(a=n>1?u*e.exp(-(o-f)+f*(e.log(o)-s)):e.exp(-o+f*e.log(o)-p)))/(1-.5*e.min(1,i*((n-1)/o-1))))<=0&&(o=.5*(o+a)),e.abs(a)<h*o)break}return o},t.erf=function(t){var r,n,o,a,i=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],c=i.length-1,s=!1,u=0,l=0;for(t<0&&(t=-t,s=!0),n=4*(r=2/(2+t))-2;c>0;c--)o=u,u=n*u-l+i[c],l=o;return a=r*e.exp(-t*t+.5*(i[0]+n*u)-l),s?a-1:1-a},t.erfc=function(e){return 1-t.erf(e)},t.erfcinv=function(r){var n,o,a,i,c=0;if(r>=2)return-100;if(r<=0)return 100;for(i=r<1?r:2-r,n=-.70711*((2.30753+.27061*(a=e.sqrt(-2*e.log(i/2))))/(1+a*(.99229+.04481*a))-a);c<2;c++)n+=(o=t.erfc(n)-i)/(1.1283791670955126*e.exp(-n*n)-n*o);return r<1?n:-n},t.ibetainv=function(r,n,o){var a,i,c,s,u,l,f,h,p,d,m=1e-8,v=n-1,g=o-1,E=0;if(r<=0)return 0;if(r>=1)return 1;for(n>=1&&o>=1?(c=r<.5?r:1-r,l=(2.30753+.27061*(s=e.sqrt(-2*e.log(c))))/(1+s*(.99229+.04481*s))-s,r<.5&&(l=-l),f=(l*l-3)/6,h=2/(1/(2*n-1)+1/(2*o-1)),p=l*e.sqrt(f+h)/h-(1/(2*o-1)-1/(2*n-1))*(f+5/6-2/(3*h)),l=n/(n+o*e.exp(2*p))):(a=e.log(n/(n+o)),i=e.log(o/(n+o)),l=r<(s=e.exp(n*a)/n)/(p=s+(u=e.exp(o*i)/o))?e.pow(n*p*r,1/n):1-e.pow(o*p*(1-r),1/o)),d=-t.gammaln(n)-t.gammaln(o)+t.gammaln(n+o);E<10;E++){if(0===l||1===l)return l;if((l-=s=(u=(t.ibeta(l,n,o)-r)/(s=e.exp(v*e.log(l)+g*e.log(1-l)+d)))/(1-.5*e.min(1,u*(v/l-g/(1-l)))))<=0&&(l=.5*(l+s)),l>=1&&(l=.5*(l+s+1)),e.abs(s)<m*l&&E>0)break}return l},t.ibeta=function(r,n,o){var a=0===r||1===r?0:e.exp(t.gammaln(n+o)-t.gammaln(n)-t.gammaln(o)+n*e.log(r)+o*e.log(1-r));return!(r<0||r>1)&&(r<(n+1)/(n+o+2)?a*t.betacf(r,n,o)/n:1-a*t.betacf(1-r,o,n)/o)},t.randn=function(r,n){var o,a,i,c,s;if(n||(n=r),r)return t.create(r,n,(function(){return t.randn()}));do{o=t._random_fn(),a=1.7156*(t._random_fn()-.5),s=(i=o-.449871)*i+(c=e.abs(a)+.386595)*(.196*c-.25472*i)}while(s>.27597&&(s>.27846||a*a>-4*e.log(o)*o*o));return a/o},t.randg=function(r,n,o){var a,i,c,s,u,l,f=r;if(o||(o=n),r||(r=1),n)return(l=t.zeros(n,o)).alter((function(){return t.randg(r)})),l;r<1&&(r+=1),a=r-1/3,i=1/e.sqrt(9*a);do{do{s=1+i*(u=t.randn())}while(s<=0);s*=s*s,c=t._random_fn()}while(c>1-.331*e.pow(u,4)&&e.log(c)>.5*u*u+a*(1-s+e.log(s)));if(r==f)return a*s;do{c=t._random_fn()}while(0===c);return e.pow(c,1/f)*a*s},function(e){for(var r=0;r<e.length;r++)!function(e){t.fn[e]=function(){return t(t.map(this,(function(r){return t[e](r)})))}}(e[r])}("gammaln gammafn factorial factorialln".split(" ")),function(e){for(var r=0;r<e.length;r++)!function(e){t.fn[e]=function(){return t(t[e].apply(null,arguments))}}(e[r])}("randn".split(" "))}(e,Math),function(t,e){function r(t,r,n,o){for(var a,i=0,c=1,s=1,u=1,l=0,f=0;e.abs((s-f)/s)>o;)f=s,c=u+(a=-(r+l)*(r+n+l)*t/(r+2*l)/(r+2*l+1))*c,s=(i=s+a*i)+(a=(l+=1)*(n-l)*t/(r+2*l-1)/(r+2*l))*s,i/=u=c+a*u,c/=u,s/=u,u=1;return s/r}function n(t){return t/e.abs(t)}function o(r,n,o){var a=12,i=6,c=-30,s=-50,u=60,l=8,f=3,h=2,p=3,d=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],m=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],v=.5*r;if(v>=l)return 1;var g,E=2*t.normal.cdf(v,0,1,1,0)-1;E=E>=e.exp(s/o)?e.pow(E,o):0;for(var y=v,N=(l-v)/(g=r>f?h:p),R=y+N,T=0,A=o-1,M=1;M<=g;M++){for(var w=0,O=.5*(R+y),I=.5*(R-y),S=1;S<=a;S++){var C,b=O+I*(i<S?d[(C=a-S+1)-1]:-d[(C=S)-1]),U=b*b;if(U>u)break;var x=2*t.normal.cdf(b,0,1,1,0)*.5-2*t.normal.cdf(b,r,1,1,0)*.5;x>=e.exp(c/A)&&(w+=x=m[C-1]*e.exp(-.5*U)*e.pow(x,A))}T+=w*=2*I*o/e.sqrt(2*e.PI),y=R,R+=N}return(E+=T)<=e.exp(c/n)?0:(E=e.pow(E,n))>=1?1:E}function a(t,r,n){var o=.322232421088,a=.099348462606,i=-1,c=.588581570495,s=-.342242088547,u=.531103462366,l=-.204231210125,f=.10353775285,h=-453642210148e-16,p=.0038560700634,d=.8832,m=.2368,v=1.214,g=1.208,E=1.4142,y=120,N=.5-.5*t,R=e.sqrt(e.log(1/(N*N))),T=R+((((R*h+l)*R+s)*R+i)*R+o)/((((R*p+f)*R+u)*R+c)*R+a);n<y&&(T+=(T*T*T+T)/n/4);var A=d-m*T;return n<y&&(A+=-v/n+g*T/n),T*(A*e.log(r-1)+E)}!function(e){for(var r=0;r<e.length;r++)!function(e){t[e]=function t(e,r,n){return this instanceof t?(this._a=e,this._b=r,this._c=n,this):new t(e,r,n)},t.fn[e]=function(r,n,o){var a=t[e](r,n,o);return a.data=this,a},t[e].prototype.sample=function(r){var n=this._a,o=this._b,a=this._c;return r?t.alter(r,(function(){return t[e].sample(n,o,a)})):t[e].sample(n,o,a)},function(r){for(var n=0;n<r.length;n++)!function(r){t[e].prototype[r]=function(n){var o=this._a,a=this._b,i=this._c;return n||0===n||(n=this.data),"number"!=typeof n?t.fn.map.call(n,(function(n){return t[e][r](n,o,a,i)})):t[e][r](n,o,a,i)}}(r[n])}("pdf cdf inv".split(" ")),function(r){for(var n=0;n<r.length;n++)!function(r){t[e].prototype[r]=function(){return t[e][r](this._a,this._b,this._c)}}(r[n])}("mean median mode variance".split(" "))}(e[r])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),t.extend(t.beta,{pdf:function(r,n,o){return r>1||r<0?0:1==n&&1==o?1:n<512&&o<512?e.pow(r,n-1)*e.pow(1-r,o-1)/t.betafn(n,o):e.exp((n-1)*e.log(r)+(o-1)*e.log(1-r)-t.betaln(n,o))},cdf:function(e,r,n){return e>1||e<0?1*(e>1):t.ibeta(e,r,n)},inv:function(e,r,n){return t.ibetainv(e,r,n)},mean:function(t,e){return t/(t+e)},median:function(e,r){return t.ibetainv(.5,e,r)},mode:function(t,e){return(t-1)/(t+e-2)},sample:function(e,r){var n=t.randg(e);return n/(n+t.randg(r))},variance:function(t,r){return t*r/(e.pow(t+r,2)*(t+r+1))}}),t.extend(t.centralF,{pdf:function(r,n,o){var a;return r<0?0:n<=2?0===r&&n<2?1/0:0===r&&2===n?1:1/t.betafn(n/2,o/2)*e.pow(n/o,n/2)*e.pow(r,n/2-1)*e.pow(1+n/o*r,-(n+o)/2):(a=n*r/(o+r*n),n*(o/(o+r*n))/2*t.binomial.pdf((n-2)/2,(n+o-2)/2,a))},cdf:function(e,r,n){return e<0?0:t.ibeta(r*e/(r*e+n),r/2,n/2)},inv:function(e,r,n){return n/(r*(1/t.ibetainv(e,r/2,n/2)-1))},mean:function(t,e){return e>2?e/(e-2):void 0},mode:function(t,e){return t>2?e*(t-2)/(t*(e+2)):void 0},sample:function(e,r){return 2*t.randg(e/2)/e/(2*t.randg(r/2)/r)},variance:function(t,e){if(!(e<=4))return 2*e*e*(t+e-2)/(t*(e-2)*(e-2)*(e-4))}}),t.extend(t.cauchy,{pdf:function(t,r,n){return n<0?0:n/(e.pow(t-r,2)+e.pow(n,2))/e.PI},cdf:function(t,r,n){return e.atan((t-r)/n)/e.PI+.5},inv:function(t,r,n){return r+n*e.tan(e.PI*(t-.5))},median:function(t){return t},mode:function(t){return t},sample:function(r,n){return t.randn()*e.sqrt(1/(2*t.randg(.5)))*n+r}}),t.extend(t.chisquare,{pdf:function(r,n){return r<0?0:0===r&&2===n?.5:e.exp((n/2-1)*e.log(r)-r/2-n/2*e.log(2)-t.gammaln(n/2))},cdf:function(e,r){return e<0?0:t.lowRegGamma(r/2,e/2)},inv:function(e,r){return 2*t.gammapinv(e,.5*r)},mean:function(t){return t},median:function(t){return t*e.pow(1-2/(9*t),3)},mode:function(t){return t-2>0?t-2:0},sample:function(e){return 2*t.randg(e/2)},variance:function(t){return 2*t}}),t.extend(t.exponential,{pdf:function(t,r){return t<0?0:r*e.exp(-r*t)},cdf:function(t,r){return t<0?0:1-e.exp(-r*t)},inv:function(t,r){return-e.log(1-t)/r},mean:function(t){return 1/t},median:function(t){return 1/t*e.log(2)},mode:function(){return 0},sample:function(r){return-1/r*e.log(t._random_fn())},variance:function(t){return e.pow(t,-2)}}),t.extend(t.gamma,{pdf:function(r,n,o){return r<0?0:0===r&&1===n?1/o:e.exp((n-1)*e.log(r)-r/o-t.gammaln(n)-n*e.log(o))},cdf:function(e,r,n){return e<0?0:t.lowRegGamma(r,e/n)},inv:function(e,r,n){return t.gammapinv(e,r)*n},mean:function(t,e){return t*e},mode:function(t,e){if(t>1)return(t-1)*e},sample:function(e,r){return t.randg(e)*r},variance:function(t,e){return t*e*e}}),t.extend(t.invgamma,{pdf:function(r,n,o){return r<=0?0:e.exp(-(n+1)*e.log(r)-o/r-t.gammaln(n)+n*e.log(o))},cdf:function(e,r,n){return e<=0?0:1-t.lowRegGamma(r,n/e)},inv:function(e,r,n){return n/t.gammapinv(1-e,r)},mean:function(t,e){return t>1?e/(t-1):void 0},mode:function(t,e){return e/(t+1)},sample:function(e,r){return r/t.randg(e)},variance:function(t,e){if(!(t<=2))return e*e/((t-1)*(t-1)*(t-2))}}),t.extend(t.kumaraswamy,{pdf:function(t,r,n){return 0===t&&1===r?n:1===t&&1===n?r:e.exp(e.log(r)+e.log(n)+(r-1)*e.log(t)+(n-1)*e.log(1-e.pow(t,r)))},cdf:function(t,r,n){return t<0?0:t>1?1:1-e.pow(1-e.pow(t,r),n)},inv:function(t,r,n){return e.pow(1-e.pow(1-t,1/n),1/r)},mean:function(e,r){return r*t.gammafn(1+1/e)*t.gammafn(r)/t.gammafn(1+1/e+r)},median:function(t,r){return e.pow(1-e.pow(2,-1/r),1/t)},mode:function(t,r){if(t>=1&&r>=1&&1!==t&&1!==r)return e.pow((t-1)/(t*r-1),1/t)},variance:function(){throw new Error("variance not yet implemented")}}),t.extend(t.lognormal,{pdf:function(t,r,n){return t<=0?0:e.exp(-e.log(t)-.5*e.log(2*e.PI)-e.log(n)-e.pow(e.log(t)-r,2)/(2*n*n))},cdf:function(r,n,o){return r<0?0:.5+.5*t.erf((e.log(r)-n)/e.sqrt(2*o*o))},inv:function(r,n,o){return e.exp(-1.4142135623730951*o*t.erfcinv(2*r)+n)},mean:function(t,r){return e.exp(t+r*r/2)},median:function(t){return e.exp(t)},mode:function(t,r){return e.exp(t-r*r)},sample:function(r,n){return e.exp(t.randn()*n+r)},variance:function(t,r){return(e.exp(r*r)-1)*e.exp(2*t+r*r)}}),t.extend(t.noncentralt,{pdf:function(r,n,o){var a=1e-14;return e.abs(o)<a?t.studentt.pdf(r,n):e.abs(r)<a?e.exp(t.gammaln((n+1)/2)-o*o/2-.5*e.log(e.PI*n)-t.gammaln(n/2)):n/r*(t.noncentralt.cdf(r*e.sqrt(1+2/n),n+2,o)-t.noncentralt.cdf(r,n,o))},cdf:function(r,n,o){var a=1e-14,i=200;if(e.abs(o)<a)return t.studentt.cdf(r,n);var c=!1;r<0&&(c=!0,o=-o);for(var s=t.normal.cdf(-o,0,1),u=a+1,l=u,f=r*r/(r*r+n),h=0,p=e.exp(-o*o/2),d=e.exp(-o*o/2-.5*e.log(2)-t.gammaln(1.5))*o;h<i||l>a||u>a;)l=u,h>0&&(p*=o*o/(2*h),d*=o*o/(2*(h+.5))),s+=.5*(u=p*t.beta.cdf(f,h+.5,n/2)+d*t.beta.cdf(f,h+1,n/2)),h++;return c?1-s:s}}),t.extend(t.normal,{pdf:function(t,r,n){return e.exp(-.5*e.log(2*e.PI)-e.log(n)-e.pow(t-r,2)/(2*n*n))},cdf:function(r,n,o){return.5*(1+t.erf((r-n)/e.sqrt(2*o*o)))},inv:function(e,r,n){return-1.4142135623730951*n*t.erfcinv(2*e)+r},mean:function(t){return t},median:function(t){return t},mode:function(t){return t},sample:function(e,r){return t.randn()*r+e},variance:function(t,e){return e*e}}),t.extend(t.pareto,{pdf:function(t,r,n){return t<r?0:n*e.pow(r,n)/e.pow(t,n+1)},cdf:function(t,r,n){return t<r?0:1-e.pow(r/t,n)},inv:function(t,r,n){return r/e.pow(1-t,1/n)},mean:function(t,r){if(!(r<=1))return r*e.pow(t,r)/(r-1)},median:function(t,r){return t*(r*e.SQRT2)},mode:function(t){return t},variance:function(t,r){if(!(r<=2))return t*t*r/(e.pow(r-1,2)*(r-2))}}),t.extend(t.studentt,{pdf:function(r,n){return n=n>1e100?1e100:n,1/(e.sqrt(n)*t.betafn(.5,n/2))*e.pow(1+r*r/n,-(n+1)/2)},cdf:function(r,n){var o=n/2;return t.ibeta((r+e.sqrt(r*r+n))/(2*e.sqrt(r*r+n)),o,o)},inv:function(r,n){var o=t.ibetainv(2*e.min(r,1-r),.5*n,.5);return o=e.sqrt(n*(1-o)/o),r>.5?o:-o},mean:function(t){return t>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(r){return t.randn()*e.sqrt(r/(2*t.randg(r/2)))},variance:function(t){return t>2?t/(t-2):t>1?1/0:void 0}}),t.extend(t.weibull,{pdf:function(t,r,n){return t<0||r<0||n<0?0:n/r*e.pow(t/r,n-1)*e.exp(-e.pow(t/r,n))},cdf:function(t,r,n){return t<0?0:1-e.exp(-e.pow(t/r,n))},inv:function(t,r,n){return r*e.pow(-e.log(1-t),1/n)},mean:function(e,r){return e*t.gammafn(1+1/r)},median:function(t,r){return t*e.pow(e.log(2),1/r)},mode:function(t,r){return r<=1?0:t*e.pow((r-1)/r,1/r)},sample:function(r,n){return r*e.pow(-e.log(t._random_fn()),1/n)},variance:function(r,n){return r*r*t.gammafn(1+2/n)-e.pow(t.weibull.mean(r,n),2)}}),t.extend(t.uniform,{pdf:function(t,e,r){return t<e||t>r?0:1/(r-e)},cdf:function(t,e,r){return t<e?0:t<r?(t-e)/(r-e):1},inv:function(t,e,r){return e+t*(r-e)},mean:function(t,e){return.5*(t+e)},median:function(e,r){return t.mean(e,r)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(e,r){return e/2+r/2+(r/2-e/2)*(2*t._random_fn()-1)},variance:function(t,r){return e.pow(r-t,2)/12}}),t.extend(t.binomial,{pdf:function(r,n,o){return 0===o||1===o?n*o===r?1:0:t.combination(n,r)*e.pow(o,r)*e.pow(1-o,n-r)},cdf:function(n,o,a){var i,c=1e-10;if(n<0)return 0;if(n>=o)return 1;if(a<0||a>1||o<=0)return NaN;var s=a,u=(n=e.floor(n))+1,l=o-n,f=u+l,h=e.exp(t.gammaln(f)-t.gammaln(l)-t.gammaln(u)+u*e.log(s)+l*e.log(1-s));return i=s<(u+1)/(f+2)?h*r(s,u,l,c):1-h*r(1-s,l,u,c),e.round(1/c*(1-i))/(1/c)}}),t.extend(t.negbin,{pdf:function(r,n,o){return r===r>>>0&&(r<0?0:t.combination(r+n-1,n-1)*e.pow(1-o,r)*e.pow(o,n))},cdf:function(e,r,n){var o=0,a=0;if(e<0)return 0;for(;a<=e;a++)o+=t.negbin.pdf(a,r,n);return o}}),t.extend(t.hypgeom,{pdf:function(r,n,o,a){if(r!=r|0)return!1;if(r<0||r<o-(n-a))return 0;if(r>a||r>o)return 0;if(2*o>n)return 2*a>n?t.hypgeom.pdf(n-o-a+r,n,n-o,n-a):t.hypgeom.pdf(a-r,n,n-o,a);if(2*a>n)return t.hypgeom.pdf(o-r,n,o,n-a);if(o<a)return t.hypgeom.pdf(r,n,a,o);for(var i=1,c=0,s=0;s<r;s++){for(;i>1&&c<a;)i*=1-o/(n-c),c++;i*=(a-s)*(o-s)/((s+1)*(n-o-a+s+1))}for(;c<a;c++)i*=1-o/(n-c);return e.min(1,e.max(0,i))},cdf:function(r,n,o,a){if(r<0||r<o-(n-a))return 0;if(r>=a||r>=o)return 1;if(2*o>n)return 2*a>n?t.hypgeom.cdf(n-o-a+r,n,n-o,n-a):1-t.hypgeom.cdf(a-r-1,n,n-o,a);if(2*a>n)return 1-t.hypgeom.cdf(o-r-1,n,o,n-a);if(o<a)return t.hypgeom.cdf(r,n,a,o);for(var i=1,c=1,s=0,u=0;u<r;u++){for(;i>1&&s<a;){var l=1-o/(n-s);c*=l,i*=l,s++}i+=c*=(a-u)*(o-u)/((u+1)*(n-o-a+u+1))}for(;s<a;s++)i*=1-o/(n-s);return e.min(1,e.max(0,i))}}),t.extend(t.poisson,{pdf:function(r,n){return n<0||r%1!=0||r<0?0:e.pow(n,r)*e.exp(-n)/t.factorial(r)},cdf:function(e,r){var n=[],o=0;if(e<0)return 0;for(;o<=e;o++)n.push(t.poisson.pdf(o,r));return t.sum(n)},mean:function(t){return t},variance:function(t){return t},sampleSmall:function(r){var n=1,o=0,a=e.exp(-r);do{o++,n*=t._random_fn()}while(n>a);return o-1},sampleLarge:function(r){var n,o,a,i,c,s,u,l,f,h,p=r;for(i=e.sqrt(p),c=e.log(p),s=.02483*(u=.931+2.53*i)-.059,l=1.1239+1.1328/(u-3.4),f=.9277-3.6224/(u-2);;){if(o=e.random()-.5,a=e.random(),h=.5-e.abs(o),n=e.floor((2*s/h+u)*o+p+.43),h>=.07&&a<=f)return n;if(!(n<0||h<.013&&a>h)&&e.log(a)+e.log(l)-e.log(s/(h*h)+u)<=n*c-p-t.loggam(n+1))return n}},sample:function(t){return t<10?this.sampleSmall(t):this.sampleLarge(t)}}),t.extend(t.triangular,{pdf:function(t,e,r,n){return r<=e||n<e||n>r?NaN:t<e||t>r?0:t<n?2*(t-e)/((r-e)*(n-e)):t===n?2/(r-e):2*(r-t)/((r-e)*(r-n))},cdf:function(t,r,n,o){return n<=r||o<r||o>n?NaN:t<=r?0:t>=n?1:t<=o?e.pow(t-r,2)/((n-r)*(o-r)):1-e.pow(n-t,2)/((n-r)*(n-o))},inv:function(t,r,n,o){return n<=r||o<r||o>n?NaN:t<=(o-r)/(n-r)?r+(n-r)*e.sqrt(t*((o-r)/(n-r))):r+(n-r)*(1-e.sqrt((1-t)*(1-(o-r)/(n-r))))},mean:function(t,e,r){return(t+e+r)/3},median:function(t,r,n){return n<=(t+r)/2?r-e.sqrt((r-t)*(r-n))/e.sqrt(2):n>(t+r)/2?t+e.sqrt((r-t)*(n-t))/e.sqrt(2):void 0},mode:function(t,e,r){return r},sample:function(r,n,o){var a=t._random_fn();return a<(o-r)/(n-r)?r+e.sqrt(a*(n-r)*(o-r)):n-e.sqrt((1-a)*(n-r)*(n-o))},variance:function(t,e,r){return(t*t+e*e+r*r-t*e-t*r-e*r)/18}}),t.extend(t.arcsine,{pdf:function(t,r,n){return n<=r?NaN:t<=r||t>=n?0:2/e.PI*e.pow(e.pow(n-r,2)-e.pow(2*t-r-n,2),-.5)},cdf:function(t,r,n){return t<r?0:t<n?2/e.PI*e.asin(e.sqrt((t-r)/(n-r))):1},inv:function(t,r,n){return r+(.5-.5*e.cos(e.PI*t))*(n-r)},mean:function(t,e){return e<=t?NaN:(t+e)/2},median:function(t,e){return e<=t?NaN:(t+e)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(r,n){return(r+n)/2+(n-r)/2*e.sin(2*e.PI*t.uniform.sample(0,1))},variance:function(t,r){return r<=t?NaN:e.pow(r-t,2)/8}}),t.extend(t.laplace,{pdf:function(t,r,n){return n<=0?0:e.exp(-e.abs(t-r)/n)/(2*n)},cdf:function(t,r,n){return n<=0?0:t<r?.5*e.exp((t-r)/n):1-.5*e.exp(-(t-r)/n)},mean:function(t){return t},median:function(t){return t},mode:function(t){return t},variance:function(t,e){return 2*e*e},sample:function(r,o){var a=t._random_fn()-.5;return r-o*n(a)*e.log(1-2*e.abs(a))}}),t.extend(t.tukey,{cdf:function(r,n,a){var i=1,c=n,s=16,u=8,l=-30,f=1e-14,h=100,p=800,d=5e3,m=25e3,v=1,g=.5,E=.25,y=.125,N=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],R=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(r<=0)return 0;if(a<2||i<1||c<2)return NaN;if(!Number.isFinite(r))return 1;if(a>m)return o(r,i,c);var T,A=.5*a,M=A*e.log(a)-a*e.log(2)-t.gammaln(A),w=A-1,O=.25*a;T=a<=h?v:a<=p?g:a<=d?E:y,M+=e.log(T);for(var I=0,S=1;S<=50;S++){for(var C=0,b=(2*S-1)*T,U=1;U<=s;U++){var x,L;u<U?(x=U-u-1,L=M+w*e.log(b+N[x]*T)-(N[x]*T+b)*O):(x=U-1,L=M+w*e.log(b-N[x]*T)+(N[x]*T-b)*O),L>=l&&(C+=o(u<U?r*e.sqrt(.5*(N[x]*T+b)):r*e.sqrt(.5*(-N[x]*T+b)),i,c)*R[x]*e.exp(L))}if(S*T>=1&&C<=f)break;I+=C}if(C>f)throw new Error("tukey.cdf failed to converge");return I>1&&(I=1),I},inv:function(r,n,o){var i=1e-4,c=50;if(o<2||n<2)return NaN;if(r<0||r>1)return NaN;if(0===r)return 0;if(1===r)return 1/0;var s,u=a(r,n,o),l=t.tukey.cdf(u,n,o)-r;s=l>0?e.max(0,u-1):u+1;for(var f,h=t.tukey.cdf(s,n,o)-r,p=1;p<c;p++)if(f=s-h*(s-u)/(h-l),l=h,u=s,f<0&&(f=0,h=-r),h=t.tukey.cdf(f,n,o)-r,s=f,e.abs(s-u)<i)return f;throw new Error("tukey.inv failed to converge")}})}(e,Math),function(t,e){var r=Array.prototype.push,n=t.utils.isArray;function o(e){return n(e)||e instanceof t}t.extend({add:function(e,r){return o(r)?(o(r[0])||(r=[r]),t.map(e,(function(t,e,n){return t+r[e][n]}))):t.map(e,(function(t){return t+r}))},subtract:function(e,r){return o(r)?(o(r[0])||(r=[r]),t.map(e,(function(t,e,n){return t-r[e][n]||0}))):t.map(e,(function(t){return t-r}))},divide:function(e,r){return o(r)?(o(r[0])||(r=[r]),t.multiply(e,t.inv(r))):t.map(e,(function(t){return t/r}))},multiply:function(e,r){var n,a,i,c,s,u,l,f;if(void 0===e.length&&void 0===r.length)return e*r;if(s=e.length,u=e[0].length,l=t.zeros(s,i=o(r)?r[0].length:u),f=0,o(r)){for(;f<i;f++)for(n=0;n<s;n++){for(c=0,a=0;a<u;a++)c+=e[n][a]*r[a][f];l[n][f]=c}return 1===s&&1===f?l[0][0]:l}return t.map(e,(function(t){return t*r}))},outer:function(e,r){return t.multiply(e.map((function(t){return[t]})),[r])},dot:function(e,r){o(e[0])||(e=[e]),o(r[0])||(r=[r]);for(var n,a,i=1===e[0].length&&1!==e.length?t.transpose(e):e,c=1===r[0].length&&1!==r.length?t.transpose(r):r,s=[],u=0,l=i.length,f=i[0].length;u<l;u++){for(s[u]=[],n=0,a=0;a<f;a++)n+=i[u][a]*c[u][a];s[u]=n}return 1===s.length?s[0]:s},pow:function(r,n){return t.map(r,(function(t){return e.pow(t,n)}))},exp:function(r){return t.map(r,(function(t){return e.exp(t)}))},log:function(r){return t.map(r,(function(t){return e.log(t)}))},abs:function(r){return t.map(r,(function(t){return e.abs(t)}))},norm:function(t,r){var n=0,a=0;for(isNaN(r)&&(r=2),o(t[0])&&(t=t[0]);a<t.length;a++)n+=e.pow(e.abs(t[a]),r);return e.pow(n,1/r)},angle:function(r,n){return e.acos(t.dot(r,n)/(t.norm(r)*t.norm(n)))},aug:function(t,e){var n,o=[];for(n=0;n<t.length;n++)o.push(t[n].slice());for(n=0;n<o.length;n++)r.apply(o[n],e[n]);return o},inv:function(e){for(var r,n=e.length,o=e[0].length,a=t.identity(n,o),i=t.gauss_jordan(e,a),c=[],s=0;s<n;s++)for(c[s]=[],r=o;r<i[0].length;r++)c[s][r-o]=i[s][r];return c},det:function t(e){if(2===e.length)return e[0][0]*e[1][1]-e[0][1]*e[1][0];for(var r=0,n=0;n<e.length;n++){for(var o=[],a=1;a<e.length;a++){o[a-1]=[];for(var i=0;i<e.length;i++)i<n?o[a-1][i]=e[a][i]:i>n&&(o[a-1][i-1]=e[a][i])}var c=n%2?-1:1;r+=t(o)*e[0][n]*c}return r},gauss_elimination:function(r,n){var o,a,i,c,s=0,u=0,l=r.length,f=r[0].length,h=1,p=0,d=[];for(o=(r=t.aug(r,n))[0].length,s=0;s<l;s++){for(a=r[s][s],u=s,c=s+1;c<f;c++)a<e.abs(r[c][s])&&(a=r[c][s],u=c);if(u!=s)for(c=0;c<o;c++)i=r[s][c],r[s][c]=r[u][c],r[u][c]=i;for(u=s+1;u<l;u++)for(h=r[u][s]/r[s][s],c=s;c<o;c++)r[u][c]=r[u][c]-h*r[s][c]}for(s=l-1;s>=0;s--){for(p=0,u=s+1;u<=l-1;u++)p+=d[u]*r[s][u];d[s]=(r[s][o-1]-p)/r[s][s]}return d},gauss_jordan:function(r,n){var o,a,i,c=t.aug(r,n),s=c.length,u=c[0].length,l=0;for(a=0;a<s;a++){var f=a;for(i=a+1;i<s;i++)e.abs(c[i][a])>e.abs(c[f][a])&&(f=i);var h=c[a];for(c[a]=c[f],c[f]=h,i=a+1;i<s;i++)for(l=c[i][a]/c[a][a],o=a;o<u;o++)c[i][o]-=c[a][o]*l}for(a=s-1;a>=0;a--){for(l=c[a][a],i=0;i<a;i++)for(o=u-1;o>a-1;o--)c[i][o]-=c[a][o]*c[i][a]/l;for(c[a][a]/=l,o=s;o<u;o++)c[a][o]/=l}return c},triaUpSolve:function(e,r){var n,o=e[0].length,a=t.zeros(1,o)[0],i=!1;return null!=r[0].length&&(r=r.map((function(t){return t[0]})),i=!0),t.arange(o-1,-1,-1).forEach((function(i){n=t.arange(i+1,o).map((function(t){return a[t]*e[i][t]})),a[i]=(r[i]-t.sum(n))/e[i][i]})),i?a.map((function(t){return[t]})):a},triaLowSolve:function(e,r){var n,o=e[0].length,a=t.zeros(1,o)[0],i=!1;return null!=r[0].length&&(r=r.map((function(t){return t[0]})),i=!0),t.arange(o).forEach((function(o){n=t.arange(o).map((function(t){return e[o][t]*a[t]})),a[o]=(r[o]-t.sum(n))/e[o][o]})),i?a.map((function(t){return[t]})):a},lu:function(e){var r,n=e.length,o=t.identity(n),a=t.zeros(e.length,e[0].length);return t.arange(n).forEach((function(t){a[0][t]=e[0][t]})),t.arange(1,n).forEach((function(i){t.arange(i).forEach((function(n){r=t.arange(n).map((function(t){return o[i][t]*a[t][n]})),o[i][n]=(e[i][n]-t.sum(r))/a[n][n]})),t.arange(i,n).forEach((function(n){r=t.arange(i).map((function(t){return o[i][t]*a[t][n]})),a[i][n]=e[r.length][n]-t.sum(r)}))})),[o,a]},cholesky:function(r){var n,o=r.length,a=t.zeros(r.length,r[0].length);return t.arange(o).forEach((function(i){n=t.arange(i).map((function(t){return e.pow(a[i][t],2)})),a[i][i]=e.sqrt(r[i][i]-t.sum(n)),t.arange(i+1,o).forEach((function(e){n=t.arange(i).map((function(t){return a[i][t]*a[e][t]})),a[e][i]=(r[i][e]-t.sum(n))/a[i][i]}))})),a},gauss_jacobi:function(r,n,o,a){for(var i,c,s,u,l=0,f=0,h=r.length,p=[],d=[],m=[];l<h;l++)for(p[l]=[],d[l]=[],m[l]=[],f=0;f<h;f++)l>f?(p[l][f]=r[l][f],d[l][f]=m[l][f]=0):l<f?(d[l][f]=r[l][f],p[l][f]=m[l][f]=0):(m[l][f]=r[l][f],p[l][f]=d[l][f]=0);for(s=t.multiply(t.multiply(t.inv(m),t.add(p,d)),-1),c=t.multiply(t.inv(m),n),i=o,u=t.add(t.multiply(s,o),c),l=2;e.abs(t.norm(t.subtract(u,i)))>a;)i=u,u=t.add(t.multiply(s,i),c),l++;return u},gauss_seidel:function(r,n,o,a){for(var i,c,s,u,l,f=0,h=r.length,p=[],d=[],m=[];f<h;f++)for(p[f]=[],d[f]=[],m[f]=[],i=0;i<h;i++)f>i?(p[f][i]=r[f][i],d[f][i]=m[f][i]=0):f<i?(d[f][i]=r[f][i],p[f][i]=m[f][i]=0):(m[f][i]=r[f][i],p[f][i]=d[f][i]=0);for(u=t.multiply(t.multiply(t.inv(t.add(m,p)),d),-1),s=t.multiply(t.inv(t.add(m,p)),n),c=o,l=t.add(t.multiply(u,o),s),f=2;e.abs(t.norm(t.subtract(l,c)))>a;)c=l,l=t.add(t.multiply(u,c),s),f+=1;return l},SOR:function(r,n,o,a,i){for(var c,s,u,l,f,h=0,p=r.length,d=[],m=[],v=[];h<p;h++)for(d[h]=[],m[h]=[],v[h]=[],c=0;c<p;c++)h>c?(d[h][c]=r[h][c],m[h][c]=v[h][c]=0):h<c?(m[h][c]=r[h][c],d[h][c]=v[h][c]=0):(v[h][c]=r[h][c],d[h][c]=m[h][c]=0);for(l=t.multiply(t.inv(t.add(v,t.multiply(d,i))),t.subtract(t.multiply(v,1-i),t.multiply(m,i))),u=t.multiply(t.multiply(t.inv(t.add(v,t.multiply(d,i))),n),i),s=o,f=t.add(t.multiply(l,o),u),h=2;e.abs(t.norm(t.subtract(f,s)))>a;)s=f,f=t.add(t.multiply(l,s),u),h++;return f},householder:function(r){for(var n,o,a,i,c=r.length,s=r[0].length,u=0,l=[],f=[];u<c-1;u++){for(n=0,i=u+1;i<s;i++)n+=r[i][u]*r[i][u];for(n=(r[u+1][u]>0?-1:1)*e.sqrt(n),o=e.sqrt((n*n-r[u+1][u]*n)/2),(l=t.zeros(c,1))[u+1][0]=(r[u+1][u]-n)/(2*o),a=u+2;a<c;a++)l[a][0]=r[a][u]/(2*o);f=t.subtract(t.identity(c,s),t.multiply(t.multiply(l,t.transpose(l)),2)),r=t.multiply(f,t.multiply(r,f))}return r},QR:function(){var r=t.sum,n=t.arange;function o(o){var a,i,c,s=o.length,u=o[0].length,l=t.zeros(u,u);for(o=t.copy(o),i=0;i<u;i++){for(l[i][i]=e.sqrt(r(n(s).map((function(t){return o[t][i]*o[t][i]})))),a=0;a<s;a++)o[a][i]=o[a][i]/l[i][i];for(c=i+1;c<u;c++)for(l[i][c]=r(n(s).map((function(t){return o[t][i]*o[t][c]}))),a=0;a<s;a++)o[a][c]=o[a][c]-o[a][i]*l[i][c]}return[o,l]}return o}(),lstsq:function(){function e(e){var r=(e=t.copy(e)).length,n=t.identity(r);return t.arange(r-1,-1,-1).forEach((function(r){t.sliceAssign(n,{row:r},t.divide(t.slice(n,{row:r}),e[r][r])),t.sliceAssign(e,{row:r},t.divide(t.slice(e,{row:r}),e[r][r])),t.arange(r).forEach((function(o){var a=t.multiply(e[o][r],-1),i=t.slice(e,{row:o}),c=t.multiply(t.slice(e,{row:r}),a);t.sliceAssign(e,{row:o},t.add(i,c));var s=t.slice(n,{row:o}),u=t.multiply(t.slice(n,{row:r}),a);t.sliceAssign(n,{row:o},t.add(s,u))}))})),n}function r(r,n){var o=!1;void 0===n[0].length&&(n=n.map((function(t){return[t]})),o=!0);var a=t.QR(r),i=a[0],c=a[1],s=r[0].length,u=t.slice(i,{col:{end:s}}),l=e(t.slice(c,{row:{end:s}})),f=t.transpose(u);void 0===f[0].length&&(f=[f]);var h=t.multiply(t.multiply(l,f),n);return void 0===h.length&&(h=[[h]]),o?h.map((function(t){return t[0]})):h}return r}(),jacobi:function(r){for(var n,o,a,i,c,s,u,l=1,f=r.length,h=t.identity(f,f),p=[];1===l;){for(c=r[0][1],a=0,i=1,n=0;n<f;n++)for(o=0;o<f;o++)n!=o&&c<e.abs(r[n][o])&&(c=e.abs(r[n][o]),a=n,i=o);for(s=r[a][a]===r[i][i]?r[a][i]>0?e.PI/4:-e.PI/4:e.atan(2*r[a][i]/(r[a][a]-r[i][i]))/2,(u=t.identity(f,f))[a][a]=e.cos(s),u[a][i]=-e.sin(s),u[i][a]=e.sin(s),u[i][i]=e.cos(s),h=t.multiply(h,u),r=t.multiply(t.multiply(t.inv(u),r),u),l=0,n=1;n<f;n++)for(o=1;o<f;o++)n!=o&&e.abs(r[n][o])>.001&&(l=1)}for(n=0;n<f;n++)p.push(r[n][n]);return[h,p]},rungekutta:function(t,e,r,n,o,a){var i,c,s;if(2===a)for(;n<=r;)o+=((i=e*t(n,o))+(c=e*t(n+e,o+i)))/2,n+=e;if(4===a)for(;n<=r;)o+=((i=e*t(n,o))+2*(c=e*t(n+e/2,o+i/2))+2*(s=e*t(n+e/2,o+c/2))+e*t(n+e,o+s))/6,n+=e;return o},romberg:function(t,r,n,o){for(var a,i,c,s,u,l=0,f=(n-r)/2,h=[],p=[],d=[];l<o/2;){for(u=t(r),c=r,s=0;c<=n;c+=f,s++)h[s]=c;for(a=h.length,c=1;c<a-1;c++)u+=(c%2!=0?4:2)*t(h[c]);u=f/3*(u+t(n)),d[l]=u,f/=2,l++}for(i=d.length,a=1;1!==i;){for(c=0;c<i-1;c++)p[c]=(e.pow(4,a)*d[c+1]-d[c])/(e.pow(4,a)-1);i=p.length,d=p,p=[],a++}return d},richardson:function(t,r,n,o){function a(t,e){for(var r,n=0,o=t.length;n<o;n++)t[n]===e&&(r=n);return r}for(var i,c,s,u,l,f=e.abs(n-t[a(t,n)+1]),h=0,p=[],d=[];o>=f;)i=a(t,n+o),c=a(t,n),p[h]=(r[i]-2*r[c]+r[2*c-i])/(o*o),o/=2,h++;for(u=p.length,s=1;1!=u;){for(l=0;l<u-1;l++)d[l]=(e.pow(4,s)*p[l+1]-p[l])/(e.pow(4,s)-1);u=d.length,p=d,d=[],s++}return p},simpson:function(t,e,r,n){for(var o,a=(r-e)/n,i=t(e),c=[],s=e,u=0,l=1;s<=r;s+=a,u++)c[u]=s;for(o=c.length;l<o-1;l++)i+=(l%2!=0?4:2)*t(c[l]);return a/3*(i+t(r))},hermite:function(t,e,r,n){for(var o,a=t.length,i=0,c=0,s=[],u=[],l=[],f=[];c<a;c++){for(s[c]=1,o=0;o<a;o++)c!=o&&(s[c]*=(n-t[o])/(t[c]-t[o]));for(u[c]=0,o=0;o<a;o++)c!=o&&(u[c]+=1/(t[c]-t[o]));l[c]=(1-2*(n-t[c])*u[c])*(s[c]*s[c]),f[c]=(n-t[c])*(s[c]*s[c]),i+=l[c]*e[c]+f[c]*r[c]}return i},lagrange:function(t,e,r){for(var n,o,a=0,i=0,c=t.length;i<c;i++){for(o=e[i],n=0;n<c;n++)i!=n&&(o*=(r-t[n])/(t[i]-t[n]));a+=o}return a},cubic_spline:function(e,r,n){for(var o,a=e.length,i=0,c=[],s=[],u=[],l=[],f=[],h=[],p=[];i<a-1;i++)f[i]=e[i+1]-e[i];for(u[0]=0,i=1;i<a-1;i++)u[i]=3/f[i]*(r[i+1]-r[i])-3/f[i-1]*(r[i]-r[i-1]);for(i=1;i<a-1;i++)c[i]=[],s[i]=[],c[i][i-1]=f[i-1],c[i][i]=2*(f[i-1]+f[i]),c[i][i+1]=f[i],s[i][0]=u[i];for(l=t.multiply(t.inv(c),s),o=0;o<a-1;o++)h[o]=(r[o+1]-r[o])/f[o]-f[o]*(l[o+1][0]+2*l[o][0])/3,p[o]=(l[o+1][0]-l[o][0])/(3*f[o]);for(o=0;o<a&&!(e[o]>n);o++);return r[o-=1]+(n-e[o])*h[o]+t.sq(n-e[o])*l[o]+(n-e[o])*t.sq(n-e[o])*p[o]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(e){var r,n,o=e.length,a=e[0].length,i=0,c=[],s=[],u=[],l=[],f=[],h=[],p=[],d=[],m=[],v=[];for(i=0;i<o;i++)c[i]=t.sum(e[i])/a;for(i=0;i<a;i++)for(p[i]=[],r=0;r<o;r++)p[i][r]=e[r][i]-c[r];for(p=t.transpose(p),i=0;i<o;i++)for(d[i]=[],r=0;r<o;r++)d[i][r]=t.dot([p[i]],[p[r]])/(a-1);for(m=(u=t.jacobi(d))[0],s=u[1],v=t.transpose(m),i=0;i<s.length;i++)for(r=i;r<s.length;r++)s[i]<s[r]&&(n=s[i],s[i]=s[r],s[r]=n,l=v[i],v[i]=v[r],v[r]=l);for(h=t.transpose(p),i=0;i<o;i++)for(f[i]=[],r=0;r<h.length;r++)f[i][r]=t.dot([v[i]],[h[r]]);return[e,s,v,f]}}),function(e){for(var r=0;r<e.length;r++)!function(e){t.fn[e]=function(r,n){var o=this;return n?(setTimeout((function(){n.call(o,t.fn[e].call(o,r))}),15),this):"number"==typeof t[e](this,r)?t[e](this,r):t(t[e](this,r))}}(e[r])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(e,Math),function(t,e){var r=[].slice,n=t.utils.isNumber,o=t.utils.isArray;function a(t,r,n,o){if(t>1||n>1||t<=0||n<=0)throw new Error("Proportions should be greater than 0 and less than 1");var a=(t*r+n*o)/(r+o);return(t-n)/e.sqrt(a*(1-a)*(1/r+1/o))}t.extend({zscore:function(){var e=r.call(arguments);return n(e[1])?(e[0]-e[1])/e[2]:(e[0]-t.mean(e[1]))/t.stdev(e[1],e[2])},ztest:function(){var n,a=r.call(arguments);return o(a[1])?(n=t.zscore(a[0],a[1],a[3]),1===a[2]?t.normal.cdf(-e.abs(n),0,1):2*t.normal.cdf(-e.abs(n),0,1)):a.length>2?(n=t.zscore(a[0],a[1],a[2]),1===a[3]?t.normal.cdf(-e.abs(n),0,1):2*t.normal.cdf(-e.abs(n),0,1)):(n=a[0],1===a[1]?t.normal.cdf(-e.abs(n),0,1):2*t.normal.cdf(-e.abs(n),0,1))}}),t.extend(t.fn,{zscore:function(t,e){return(t-this.mean())/this.stdev(e)},ztest:function(r,n,o){var a=e.abs(this.zscore(r,o));return 1===n?t.normal.cdf(-a,0,1):2*t.normal.cdf(-a,0,1)}}),t.extend({tscore:function(){var n=r.call(arguments);return 4===n.length?(n[0]-n[1])/(n[2]/e.sqrt(n[3])):(n[0]-t.mean(n[1]))/(t.stdev(n[1],!0)/e.sqrt(n[1].length))},ttest:function(){var o,a=r.call(arguments);return 5===a.length?(o=e.abs(t.tscore(a[0],a[1],a[2],a[3])),1===a[4]?t.studentt.cdf(-o,a[3]-1):2*t.studentt.cdf(-o,a[3]-1)):n(a[1])?(o=e.abs(a[0]),1==a[2]?t.studentt.cdf(-o,a[1]-1):2*t.studentt.cdf(-o,a[1]-1)):(o=e.abs(t.tscore(a[0],a[1])),1==a[2]?t.studentt.cdf(-o,a[1].length-1):2*t.studentt.cdf(-o,a[1].length-1))}}),t.extend(t.fn,{tscore:function(t){return(t-this.mean())/(this.stdev(!0)/e.sqrt(this.cols()))},ttest:function(r,n){return 1===n?1-t.studentt.cdf(e.abs(this.tscore(r)),this.cols()-1):2*t.studentt.cdf(-e.abs(this.tscore(r)),this.cols()-1)}}),t.extend({anovafscore:function(){var n,o,a,i,c,s,u,l,f=r.call(arguments);if(1===f.length){for(c=new Array(f[0].length),u=0;u<f[0].length;u++)c[u]=f[0][u];f=c}for(o=new Array,u=0;u<f.length;u++)o=o.concat(f[u]);for(a=t.mean(o),n=0,u=0;u<f.length;u++)n+=f[u].length*e.pow(t.mean(f[u])-a,2);for(n/=f.length-1,s=0,u=0;u<f.length;u++)for(i=t.mean(f[u]),l=0;l<f[u].length;l++)s+=e.pow(f[u][l]-i,2);return n/(s/=o.length-f.length)},anovaftest:function(){var e,o,a,i,c=r.call(arguments);if(n(c[0]))return 1-t.centralF.cdf(c[0],c[1],c[2]);var s=t.anovafscore(c);for(e=c.length-1,a=0,i=0;i<c.length;i++)a+=c[i].length;return o=a-e-1,1-t.centralF.cdf(s,e,o)},ftest:function(e,r,n){return 1-t.centralF.cdf(e,r,n)}}),t.extend(t.fn,{anovafscore:function(){return t.anovafscore(this.toArray())},anovaftes:function(){var e,r=0;for(e=0;e<this.length;e++)r+=this[e].length;return t.ftest(this.anovafscore(),this.length-1,r-this.length)}}),t.extend({qscore:function(){var o,a,i,c,s,u=r.call(arguments);return n(u[0])?(o=u[0],a=u[1],i=u[2],c=u[3],s=u[4]):(o=t.mean(u[0]),a=t.mean(u[1]),i=u[0].length,c=u[1].length,s=u[2]),e.abs(o-a)/(s*e.sqrt((1/i+1/c)/2))},qtest:function(){var e,n=r.call(arguments);3===n.length?(e=n[0],n=n.slice(1)):7===n.length?(e=t.qscore(n[0],n[1],n[2],n[3],n[4]),n=n.slice(5)):(e=t.qscore(n[0],n[1],n[2]),n=n.slice(3));var o=n[0],a=n[1];return 1-t.tukey.cdf(e,a,o-a)},tukeyhsd:function(e){for(var r=t.pooledstdev(e),n=e.map((function(e){return t.mean(e)})),o=e.reduce((function(t,e){return t+e.length}),0),a=[],i=0;i<e.length;++i)for(var c=i+1;c<e.length;++c){var s=t.qtest(n[i],n[c],e[i].length,e[c].length,r,o,e.length);a.push([[i,c],s])}return a}}),t.extend({normalci:function(){var n,o=r.call(arguments),a=new Array(2);return n=4===o.length?e.abs(t.normal.inv(o[1]/2,0,1)*o[2]/e.sqrt(o[3])):e.abs(t.normal.inv(o[1]/2,0,1)*t.stdev(o[2])/e.sqrt(o[2].length)),a[0]=o[0]-n,a[1]=o[0]+n,a},tci:function(){var n,o=r.call(arguments),a=new Array(2);return n=4===o.length?e.abs(t.studentt.inv(o[1]/2,o[3]-1)*o[2]/e.sqrt(o[3])):e.abs(t.studentt.inv(o[1]/2,o[2].length-1)*t.stdev(o[2],!0)/e.sqrt(o[2].length)),a[0]=o[0]-n,a[1]=o[0]+n,a},significant:function(t,e){return t<e}}),t.extend(t.fn,{normalci:function(e,r){return t.normalci(e,r,this.toArray())},tci:function(e,r){return t.tci(e,r,this.toArray())}}),t.extend(t.fn,{oneSidedDifferenceOfProportions:function(e,r,n,o){var i=a(e,r,n,o);return t.ztest(i,1)},twoSidedDifferenceOfProportions:function(e,r,n,o){var i=a(e,r,n,o);return t.ztest(i,2)}})}(e,Math),e.models=function(){function t(t){var n=t[0].length;return e.arange(n).map((function(o){var a=e.arange(n).filter((function(t){return t!==o}));return r(e.col(t,o).map((function(t){return t[0]})),e.col(t,a))}))}function r(t,r){var n=t.length,o=r[0].length-1,a=n-o-1,i=e.lstsq(r,t),c=e.multiply(r,i.map((function(t){return[t]}))).map((function(t){return t[0]})),s=e.subtract(t,c),u=e.mean(t),l=e.sum(c.map((function(t){return Math.pow(t-u,2)}))),f=e.sum(t.map((function(t,e){return Math.pow(t-c[e],2)}))),h=l+f;return{exog:r,endog:t,nobs:n,df_model:o,df_resid:a,coef:i,predict:c,resid:s,ybar:u,SST:h,SSE:l,SSR:f,R2:l/h}}function n(r){var n=t(r.exog),o=Math.sqrt(r.SSR/r.df_resid),a=n.map((function(t){var e=t.SST,r=t.R2;return o/Math.sqrt(e*(1-r))})),i=r.coef.map((function(t,e){return(t-0)/a[e]})),c=i.map((function(t){var n=e.studentt.cdf(t,r.df_resid);return 2*(n>.5?1-n:n)})),s=e.studentt.inv(.975,r.df_resid),u=r.coef.map((function(t,e){var r=s*a[e];return[t-r,t+r]}));return{se:a,t:i,p:c,sigmaHat:o,interval95:u}}function o(t){var r,n,o,a=t.R2/t.df_model/((1-t.R2)/t.df_resid);return{F_statistic:a,pvalue:1-(r=a,n=t.df_model,o=t.df_resid,e.beta.cdf(r/(o/n+r),n/2,o/2))}}function a(t,e){var a=r(t,e),i=n(a),c=o(a),s=1-(1-a.R2)*((a.nobs-1)/a.df_resid);return a.t=i,a.f=c,a.adjust_R2=s,a}return{ols:a}}(),e.extend({buildxmatrix:function(){for(var t=new Array(arguments.length),r=0;r<arguments.length;r++){var n=[1];t[r]=n.concat(arguments[r])}return e(t)},builddxmatrix:function(){for(var t=new Array(arguments[0].length),r=0;r<arguments[0].length;r++){var n=[1];t[r]=n.concat(arguments[0][r])}return e(t)},buildjxmatrix:function(t){for(var r=new Array(t.length),n=0;n<t.length;n++)r[n]=t[n];return e.builddxmatrix(r)},buildymatrix:function(t){return e(t).transpose()},buildjymatrix:function(t){return t.transpose()},matrixmult:function(t,r){var n,o,a,i,c;if(t.cols()==r.rows()){if(r.rows()>1){for(i=[],n=0;n<t.rows();n++)for(i[n]=[],o=0;o<r.cols();o++){for(c=0,a=0;a<t.cols();a++)c+=t.toArray()[n][a]*r.toArray()[a][o];i[n][o]=c}return e(i)}for(i=[],n=0;n<t.rows();n++)for(i[n]=[],o=0;o<r.cols();o++){for(c=0,a=0;a<t.cols();a++)c+=t.toArray()[n][a]*r.toArray()[o];i[n][o]=c}return e(i)}},regress:function(t,r){var n=e.xtranspxinv(t),o=t.transpose(),a=e.matrixmult(e(n),o);return e.matrixmult(a,r)},regresst:function(t,r,n){var o=e.regress(t,r),a={anova:{}},i=e.jMatYBar(t,o);a.yBar=i;var c=r.mean();a.anova.residuals=e.residuals(r,i),a.anova.ssr=e.ssr(i,c),a.anova.msr=a.anova.ssr/(t[0].length-1),a.anova.sse=e.sse(r,i),a.anova.mse=a.anova.sse/(r.length-(t[0].length-1)-1),a.anova.sst=e.sst(r,c),a.anova.mst=a.anova.sst/(r.length-1),a.anova.r2=1-a.anova.sse/a.anova.sst,a.anova.r2<0&&(a.anova.r2=0),a.anova.fratio=a.anova.msr/a.anova.mse,a.anova.pvalue=e.anovaftest(a.anova.fratio,t[0].length-1,r.length-(t[0].length-1)-1),a.anova.rmse=Math.sqrt(a.anova.mse),a.anova.r2adj=1-a.anova.mse/a.anova.mst,a.anova.r2adj<0&&(a.anova.r2adj=0),a.stats=new Array(t[0].length);for(var s,u,l,f=e.xtranspxinv(t),h=0;h<o.length;h++)s=Math.sqrt(a.anova.mse*Math.abs(f[h][h])),u=Math.abs(o[h]/s),l=e.ttest(u,r.length-t[0].length-1,n),a.stats[h]=[o[h],s,u,l];return a.regress=o,a},xtranspx:function(t){return e.matrixmult(t.transpose(),t)},xtranspxinv:function(t){var r=e.matrixmult(t.transpose(),t);return e.inv(r)},jMatYBar:function(t,r){var n=e.matrixmult(t,r);return new e(n)},residuals:function(t,r){return e.matrixsubtract(t,r)},ssr:function(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e,2);return r},sse:function(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e[n],2);return r},sst:function(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e,2);return r},matrixsubtract:function(t,r){for(var n=new Array(t.length),o=0;o<t.length;o++){n[o]=new Array(t[o].length);for(var a=0;a<t[o].length;a++)n[o][a]=t[o][a]-r[o][a]}return e(n)}}),e.jStat=e,e)},4954:(t,e,r)=>{"use strict";r.d(e,{JH:()=>et,Ay:()=>ke});var n=r(6540),o=r(2485),a=r.n(o),i=r(5336),c=r.n(i),s=r(9982);const u=Symbol(),l=Symbol(),f="undefined"==typeof window||/ServerSideRendering/.test(window.navigator&&window.navigator.userAgent)?n.useEffect:n.useLayoutEffect,h=s.unstable_runWithPriority?t=>{try{(0,s.unstable_runWithPriority)(s.unstable_NormalPriority,t)}catch(e){if("Not implemented."!==e.message)throw e;t()}}:t=>t();function p(t,e){const r=(0,n.useContext)(t)[u];const{v:{current:o},n:{current:a},l:i}=r,c=e(o),[s,l]=(0,n.useReducer)(((t,r)=>{if(!r)return[o,c];if("p"in r)throw r.p;if(r.n===a)return Object.is(t[1],c)?t:[o,c];try{if("v"in r){if(Object.is(t[0],r.v))return t;const n=e(r.v);return Object.is(t[1],n)?t:[r.v,n]}}catch(n){}return[...t]}),[o,c]);return Object.is(s[1],c)||l(),f((()=>(i.add(l),()=>{i.delete(l)})),[i]),s[1]}var d=function(t,e){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},d(t,e)};function m(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}d(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var v=function(){return v=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},v.apply(this,arguments)};function g(t,e){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&c[0]?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,n=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=e.call(t,i)}catch(s){c=[6,s],n=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}}function E(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,a=r.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function N(t,e,r){if(r||2===arguments.length)for(var n,o=0,a=e.length;o<a;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}var R="SET_DATA",T="SET_CREATE_FORMULA_PARSER",A="SELECT_ENTIRE_ROW",M="SELECT_ENTIRE_COLUMN",w="SELECT_ENTIRE_WORKSHEET",O="SET_SELECTION",I="SELECT",S="ACTIVATE",C="SET_CELL_DATA",b="SET_CELL_DIMENSIONS",U="COPY",x="CUT",L="PASTE",_="EDIT",k="VIEW",P="BLUR",B="KEY_PRESS",D="KEY_DOWN",F="DRAG_START",j="DRAG_END",V="COMMIT";function G(t){return{type:R,payload:{data:t}}}function z(t){return{type:T,payload:{createFormulaParser:t}}}function H(t){return{type:O,payload:{selection:t}}}function W(t){return{type:S,payload:{point:t}}}function Y(t,e){return{type:C,payload:{active:t,data:e}}}function K(t){return{type:L,payload:{data:t}}}function q(t){return{type:B,payload:{event:t}}}function $(t){return{type:D,payload:{event:t}}}function X(){return{type:F}}function J(){return{type:j}}function Q(){return{type:U}}function Z(){return{type:x}}function tt(){return{type:P}}function et(t,e){for(var r=Array(t),n=0;n<t;n++)r[n]=Array(e);return r}function rt(t,e){var r=e[t.row];if(void 0!==r)return r[t.column]}function nt(t,e,r){for(var n=[],o=e.column-t.column,a=t.row;a<=e.row;a++){var i=a-t.row;n[i]=n[i]||Array(o);for(var c=t.column;c<=e.column;c++)n[i][c-t.column]=rt({row:a,column:c},r)}return n}function ot(t,e,r){var n=N([],y(r),!1),o=r[0],a=o?N([],y(o),!1):[];a.length-1<t.column&&(a[t.column]=void 0,n[0]=a);var i=r[t.row]?N([],y(r[t.row]),!1):[];return i[t.column]=e,n[t.row]=i,n}function at(t,e,r){var n=r[0];n||(n=[],r[0]=n),t.row in r||(r[t.row]=[]),t.column in n||(n[t.column]=void 0),r[t.row][t.column]=e}function it(t,e){if(!st(t,e))return e;var r=N([],y(e),!1),n=N([],y(e[t.row]),!1);return n[t.column]=void 0,r[t.row]=n,r}function ct(t){var e,r,n,o,a,i,c,s,u,l,f,h,p,d,m,v;return g(this,(function(g){switch(g.label){case 0:g.trys.push([0,11,12,13]),e=E(t.entries()),r=e.next(),g.label=1;case 1:if(r.done)return[3,10];n=y(r.value,2),o=n[0],a=n[1],g.label=2;case 2:g.trys.push([2,7,8,9]),m=void 0,i=E(a.entries()),c=i.next(),g.label=3;case 3:return c.done?[3,6]:(s=y(c.value,2),u=s[0],l=s[1],[4,[{row:o,column:u},l]]);case 4:g.sent(),g.label=5;case 5:return c=i.next(),[3,3];case 6:return[3,9];case 7:return f=g.sent(),m={error:f},[3,9];case 8:try{c&&!c.done&&(v=i.return)&&v.call(i)}finally{if(m)throw m.error}return[7];case 9:return r=e.next(),[3,1];case 10:return[3,13];case 11:return h=g.sent(),p={error:h},[3,13];case 12:try{r&&!r.done&&(d=e.return)&&d.call(e)}finally{if(p)throw p.error}return[7];case 13:return[2]}}))}function st(t,e){var r=e[0];return r&&t.row>=0&&t.column>=0&&Number.isInteger(t.row)&&Number.isInteger(t.column)&&t.column<r.length&&t.row<e.length}function ut(t){return{columns:ft(t),rows:lt(t)}}function lt(t){return t.length}function ft(t){var e=t[0];return e?e.length:0}function ht(t){var e=ut(t);return{row:e.rows-1,column:e.columns-1}}var pt=function(){function t(t,e){this.start={row:Math.min(t.row,e.row),column:Math.min(t.column,e.column)},this.end={row:Math.max(t.row,e.row),column:Math.max(t.column,e.column)}}return t.prototype[Symbol.iterator]=function(){var t,e;return g(this,(function(r){switch(r.label){case 0:t=this.start.row,r.label=1;case 1:if(!(t<=this.end.row))return[3,6];e=this.start.column,r.label=2;case 2:return e<=this.end.column?[4,{row:t,column:e}]:[3,5];case 3:r.sent(),r.label=4;case 4:return e++,[3,2];case 5:return t++,[3,1];case 6:return[2]}}))},t.prototype.size=function(){return(this.end.row+1-this.start.row)*(this.end.column+1-this.start.column)},t.prototype.has=function(t){return t.row>=this.start.row&&t.column>=this.start.column&&t.row<=this.end.row&&t.column<=this.end.column},t.prototype.mask=function(e){return new t({row:e.start.row>this.start.row?e.start.row:this.start.row,column:e.start.column>this.start.column?e.start.column:this.start.column},{row:e.end.row<this.end.row?e.end.row:this.end.row,column:e.end.column<this.end.column?e.end.column:this.end.column})},t.prototype.equals=function(t){return this.start.row===t.start.row&&this.start.column===t.start.column&&this.end.row===t.end.row&&this.end.column===t.end.column},t}();var dt={row:0,column:0},mt=function(){},vt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.toRange=function(t){return null},e.prototype.normalizeTo=function(t){return this},e.prototype.hasEntireRow=function(t){return!1},e.prototype.hasEntireColumn=function(t){return!1},e.prototype.size=function(){return 0},e.prototype.has=function(){return!1},e.prototype.equals=function(t){return t instanceof e},e}(mt),gt=function(t){function e(e){var r=t.call(this)||this;return r.range=e,r}return m(e,t),e.prototype.toRange=function(t){return this.range},e.prototype.normalizeTo=function(t){var r=At(t);return new e(this.range.mask(r))},e.prototype.hasEntireRow=function(t){return!1},e.prototype.hasEntireColumn=function(t){return!1},e.prototype.size=function(t){var e=this.toRange(t);return e?e.size():0},e.prototype.has=function(t,e){var r=this.toRange(t);return null!==r&&r.has(e)},e.prototype.equals=function(t){return t instanceof e&&this.range.equals(t.range)},e}(mt),Et=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e}(mt),yt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.toRange=function(t){return At(t)},e.prototype.normalizeTo=function(t){return this},e.prototype.hasEntireColumn=function(t){return!0},e.prototype.hasEntireRow=function(t){return!0},e.prototype.size=function(t){return ft(t)*lt(t)},e.prototype.has=function(t,e){return!0},e.prototype.equals=function(t){return t instanceof e},e}(Et),Nt=function(t){function e(e,r){var n=this;if(!Mt(e))throw new wt("start");if(!Mt(r))throw new wt("end");return(n=t.call(this)||this).start=Math.min(e,r),n.end=Math.max(e,r),n}return m(e,t),e.prototype.equals=function(t){return t instanceof e&&this.constructor===t.constructor&&this.start===t.start&&this.end===t.end},e}(Et),Rt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.toRange=function(t){var e=ht(t);return new pt({row:this.start,column:0},{row:this.end,column:e.column})},e.prototype.normalizeTo=function(t){var r=lt(t);return new e(Math.max(this.start,0),Math.min(this.end,r-1))},e.prototype.hasEntireRow=function(t){return t>=this.start&&t<=this.end},e.prototype.hasEntireColumn=function(t){return!1},e.prototype.size=function(t){return(this.end-this.start+1)*ft(t)},e.prototype.has=function(t,e){return e.row>=this.start&&e.row<=this.end},e}(Nt),Tt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.toRange=function(t){var e=ht(t);return new pt({row:0,column:this.start},{row:e.row,column:this.end})},e.prototype.normalizeTo=function(t){var r=ft(t);return new e(Math.max(this.start,0),Math.min(this.end,r-1))},e.prototype.hasEntireRow=function(t){return!1},e.prototype.hasEntireColumn=function(t){return t>=this.start&&t<=this.end},e.prototype.size=function(t){return(this.end-this.start+1)*lt(t)},e.prototype.has=function(t,e){return e.column>=this.start&&e.column<=this.end},e}(Nt);function At(t){var e=ht(t);return new pt(dt,e)}function Mt(t){return Number.isInteger(t)&&t>=0}var wt=function(t){function e(e){return t.call(this,"".concat(e," is not a valid index. It must be 0 or a positive integer"))||this}return m(e,t),e}(Error),Ot="text/plain";function It(t,e,r){void 0===e&&(e=0),void 0===r&&(r=1);var n=[];if(-1===Math.sign(t-e)){for(var o=e;o>t;o-=r)n.push(o);return n}for(o=e;o<t;o+=r)n.push(o);return n}function St(t,e){return Boolean(t&&(n=t,(r=e).column===n.column&&r.row===n.row));var r,n}function Ct(t){return{width:t.offsetWidth,height:t.offsetHeight,left:t.offsetLeft,top:t.offsetTop}}function bt(t,e,r){var n=e&&e[t.row],o=r&&r[t.column];return n&&o&&v(v({},n),o)}function Ut(t,e,r){var n=bt(r.start,t,e),o=bt(r.end,t,e);return n&&o&&{width:o.left+o.width-n.left,height:o.top+o.height-n.top,top:n.top,left:n.left}}function xt(t){return function(t,e,r){void 0===e&&(e="\t"),void 0===r&&(r="\n");for(var n="",o=ut(t),a=o.rows,i=o.columns,c=0;c<a;c++){c&&(n+=r);for(var s=0;s<i;s++)s&&(n+=e),t[c]&&s in t[c]&&(n+=String(t[c][s]))}return n}(function(t,e){var r,n,o=[];try{for(var a=E(ct(e)),i=a.next();!i.done;i=a.next()){var c=y(i.value,2),s=c[0];at(s,t(c[1],s),o)}}catch(u){r={error:u}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return o}((function(t){return(null==t?void 0:t.value)||""}),t))}function Lt(t,e){return null!==t&&"view"===e&&_t(t)}function _t(t){return t.matches(":focus-within")}function kt(t){return"string"==typeof t&&t.includes("\n")}function Pt(t){return"".concat(t.row,",").concat(t.column)}function Bt(t){var e=y(t.split(","),2),r=e[0],n=e[1];return{row:Number(r),column:Number(n)}}var Dt=function(){function t(t){this.set=t}return t.from=function(e){var r,n,o=new Set;try{for(var a=E(e),i=a.next();!i.done;i=a.next()){var c=i.value;o.add(Pt(c))}}catch(s){r={error:s}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return new t(o)},t.prototype.has=function(t){return this.set.has(Pt(t))},Object.defineProperty(t.prototype,"size",{get:function(){return this.set.size},enumerable:!1,configurable:!0}),t.prototype.add=function(e){var r=new Set(this.set);return r.add(Pt(e)),new t(r)},t.prototype.delete=function(e){var r=new Set(this.set);return r.delete(Pt(e))?new t(r):this},t.prototype.difference=function(t){var e,r,n=this;try{for(var o=E(t),a=o.next();!a.done;a=o.next()){var i=a.value;n=n.delete(i)}}catch(c){e={error:c}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return n},t.prototype.union=function(t){var e,r,n=this;try{for(var o=E(t),a=o.next();!a.done;a=o.next()){var i=a.value;n=n.add(i)}}catch(c){e={error:c}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return n},t.prototype[Symbol.iterator]=function(){var t,e,r,n,o;return g(this,(function(a){switch(a.label){case 0:a.trys.push([0,5,6,7]),t=E(this.set),e=t.next(),a.label=1;case 1:return e.done?[3,4]:[4,Bt(e.value)];case 2:a.sent(),a.label=3;case 3:return e=t.next(),[3,1];case 4:return[3,7];case 5:return r=a.sent(),n={error:r},[3,7];case 6:try{e&&!e.done&&(o=t.return)&&o.call(t)}finally{if(n)throw n.error}return[7];case 7:return[2]}}))},t}();function Ft(t){return"string"==typeof t&&t.startsWith("=")&&t.length>1}function jt(t){return t.slice(1)}function Vt(t,e){return new(c())(v(v({},e),{onCell:function(e){var r=rt({row:e.row-1,column:e.col-1},t);return isNaN(null==r?void 0:r.value)?null==r?void 0:r.value:Number(null==r?void 0:r.value)},onRange:function(e){var r=ut(t);return function(t,e){for(var r=[],n=0;n<t.length;n++)for(var o=0;o<t[n].length;o++){var a=t[n][o];r.push(e?e(a,{row:n,column:o}):a)}return r}(nt({row:e.from.row-1,column:e.from.col-1},{row:Math.min(e.to.row-1,r.rows-1),column:Math.min(e.to.col-1,r.columns-1)},t),(function(t){return isNaN(null==t?void 0:t.value)?null==t?void 0:t.value:Number(null==t?void 0:t.value)}))}}))}var Gt=new i.DepParser;function zt(t,e,r){var n=ut(r),o=n.rows,a=n.columns;try{var c=Gt.parse(t,Ht(e)),s=Dt.from(c.flatMap((function(t){if("from"in t){var e=t.from,r=t.to,n={row:e.row-1,column:e.col-1},i={row:Math.min(r.row-1,o-1),column:Math.min(r.col-1,a-1)},c=new pt(n,i);return Array.from(c)}return{row:t.row-1,column:t.col-1}})));return s}catch(u){if(u instanceof i.FormulaError)return Dt.from([]);throw u}}function Ht(t){return{row:t.row+1,col:t.column+1,sheet:"Sheet1"}}var Wt=function(){function t(t){void 0===t&&(t=new Map),this.forwards=t}return t.from=function(e){var r,n,o=new Map;try{for(var a=E(e),i=a.next();!i.done;i=a.next()){var c=y(i.value,2),s=c[0],u=c[1];o.set(Pt(s),u)}}catch(l){r={error:l}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return new t(o)},t.prototype.set=function(e,r){var n=new t(new Map(this.forwards));return 0===r.size?(n.forwards.delete(Pt(e)),n):(n.forwards.set(Pt(e),r),n)},t.prototype.get=function(t){return this.forwards.get(Pt(t))||Dt.from([])},t.prototype.getBackwards=function(t){var e,r,n=Dt.from([]);try{for(var o=E(this.forwards),a=o.next();!a.done;a=o.next()){var i=y(a.value,2),c=i[0];i[1].has(t)&&(n=n.add(Bt(c)))}}catch(s){e={error:s}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return n},t.prototype.getBackwardsRecursive=function(t,e){var r,n;void 0===e&&(e=Dt.from([]));var o=this.getBackwards(t),a=e;try{for(var i=E(o),c=i.next();!c.done;c=i.next()){var s=c.value;a.has(s)||(a=a.add(s),o=o.union(this.getBackwardsRecursive(s,a)))}}catch(u){r={error:u}}finally{try{c&&!c.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return o},t.prototype.hasCircularDependency=function(t){for(var e,r,n=Dt.from([]),o=[t];o.length>0;){var a=o.pop();if(a){if(n.has(a))return!0;n=n.add(a);var i=this.get(a);if(i)try{for(var c=(e=void 0,E(i)),s=c.next();!s.done;s=c.next()){var u=s.value;o.push(u)}}catch(l){e={error:l}}finally{try{s&&!s.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}}}return!1},t.prototype[Symbol.iterator]=function(){var t,e,r,n,o,a,i,c,s,u,l,f,h,p,d,m,v;return g(this,(function(g){switch(g.label){case 0:t=new Set,g.label=1;case 1:g.trys.push([1,13,14,15]),e=E(this.forwards),r=e.next(),g.label=2;case 2:return r.done?[3,12]:(n=y(r.value,2),o=n[0],a=n[1],i=Bt(o),t.add(o),[4,[i,a]]);case 3:g.sent(),g.label=4;case 4:g.trys.push([4,9,10,11]),m=void 0,c=E(a),s=c.next(),g.label=5;case 5:return s.done?[3,8]:(u=s.value,l=Pt(u),t.has(l)||this.forwards.has(l)?[3,7]:(t.add(l),[4,[u,Dt.from([])]]));case 6:g.sent(),g.label=7;case 7:return s=c.next(),[3,5];case 8:return[3,11];case 9:return f=g.sent(),m={error:f},[3,11];case 10:try{s&&!s.done&&(v=c.return)&&v.call(c)}finally{if(m)throw m.error}return[7];case 11:return r=e.next(),[3,2];case 12:return[3,15];case 13:return h=g.sent(),p={error:h},[3,15];case 14:try{r&&!r.done&&(d=e.return)&&d.call(e)}finally{if(p)throw p.error}return[7];case 15:return[2]}}))},t.prototype.traverseBFSBackwards=function(){var t,e,r,n,o,a,i,c,s,u,l,f,h,p;return g(this,(function(d){switch(d.label){case 0:t=Dt.from([]),e=[];try{for(r=E(this),n=r.next();!n.done;n=r.next())o=y(n.value,2),a=o[0],0===o[1].size&&(t=t.add(a),e.push(a))}catch(m){l={error:m}}finally{try{n&&!n.done&&(f=r.return)&&f.call(r)}finally{if(l)throw l.error}}d.label=1;case 1:return e.length>0?(a=e.shift())?[4,a]:[3,1]:[3,3];case 2:if(d.sent(),0===(i=this.getBackwards(a)).size)return[3,1];try{for(h=void 0,c=E(i),s=c.next();!s.done;s=c.next())u=s.value,t.has(u)||0!==this.get(u).difference(t).size||(e.push(u),t=t.add(u))}catch(v){h={error:v}}finally{try{s&&!s.done&&(p=c.return)&&p.call(c)}finally{if(h)throw h.error}}return[3,1];case 3:return[2]}}))},t}(),Yt=function(t,e,r,n){this.createFormulaParser=t,this.data=e,this.referenceGraph=r||function(t){var e,r,n=[];try{for(var o=E(ct(t)),a=o.next();!a.done;a=o.next()){var i=y(a.value,2),c=i[0],s=i[1];if(s&&Ft(s.value)){var u=zt(jt(s.value),c,t);n.push([c,u])}}}catch(l){e={error:l}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return Wt.from(n)}(e),this.evaluatedData=n||function(t,e,r){var n,o,a=t,i=r(a);try{for(var c=E(e.traverseBFSBackwards()),s=c.next();!s.done;s=c.next()){var u=s.value,l=rt(u,t);if(l&&Ft(l.value)){var f=qt(l.value,u,i);i=r(a=ot(u,v(v({},l),{value:f}),a))}}}catch(h){n={error:h}}finally{try{s&&!s.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}return a}(e,this.referenceGraph,this.createFormulaParser)};function Kt(t,e,r){var n=ot(e,r,t.data),o=Ft(r.value)?function(t,e,r,n){var o=zt(jt(r.value),e,n),a=t.set(e,o);return a}(t.referenceGraph,e,r,n):t.referenceGraph,a=t.createFormulaParser(n),c=function(t,e,r,n,o,a){var c,s,u,l;if(r.hasCircularDependency(n)){var f=Dt.from([n]),h=ot(n,v(v({},o),{value:i.FormulaError.REF}),t);try{for(var p=E(r.getBackwardsRecursive(n)),d=p.next();!d.done;d=p.next()){var m=d.value;if(f.has(m))break;f=f.add(m),(A=rt(m,e))&&(h=ot(m,v(v({},A),{value:i.FormulaError.REF}),h))}}catch(w){c={error:w}}finally{try{d&&!d.done&&(s=p.return)&&s.call(p)}finally{if(c)throw c.error}}return h}var g=t,y=Ft(o.value)?qt(o.value,n,a):o.value,N=v(v({},o),{value:y});g=ot(n,N,g);try{for(var R=E(r.getBackwardsRecursive(n)),T=R.next();!T.done;T=R.next()){var A;if(A=rt(m=T.value,e)){var M=Ft(A.value)?qt(A.value,n,a):A.value;g=ot(m,v(v({},A),{value:M}),g)}}}catch(O){u={error:O}}finally{try{T&&!T.done&&(l=R.return)&&l.call(R)}finally{if(u)throw u.error}}return g}(t.evaluatedData,n,o,e,r,a);return new Yt(t.createFormulaParser,n,o,c)}function qt(t,e,r){var n=jt(t);try{return function(t,e,r){try{var n=Ht(e),o=r.parse(t,n);return o instanceof i.FormulaError?o.toString():o}catch(a){if(a instanceof i.FormulaError)return a.toString();throw a}}(n,e,r)}catch(o){return i.FormulaError.REF}}var $t={active:null,mode:"view",rowDimensions:{},columnDimensions:{},lastChanged:null,hasPasted:!1,cut:!1,dragging:!1,model:new Yt(Vt,[]),selected:new vt,copied:null,lastCommit:null};function Xt(t,e){var r,n,o,a,i,c,s,u,l;switch(e.type){case R:var f=e.payload.data,h=t.active&&st(t.active,f)?t.active:null,p=t.selected.normalizeTo(f);return v(v({},t),{model:new Yt(t.model.createFormulaParser,f),active:h,selected:p});case T:var d=e.payload.createFormulaParser;return v(v({},t),{model:new Yt(d,t.model.data)});case A:var m=e.payload,g=m.row,G=m.extend,z=t.active;return v(v({},t),{selected:new Rt(G&&z?z.row:g,g),active:G&&z?z:v(v({},dt),{row:g}),mode:"view"});case M:var H=e.payload,W=H.column;G=H.extend,z=t.active;return v(v({},t),{selected:new Tt(G&&z?z.column:W,W),active:G&&z?z:v(v({},dt),{column:W}),mode:"view"});case w:return v(v({},t),{selected:new yt,active:dt,mode:"view"});case O:var Y=e.payload.selection,K=Y.toRange(t.model.data);z=t.active&&Y.has(t.model.data,t.active)?t.active:null==K?void 0:K.start;return v(v({},t),{selected:Y,active:z||null,mode:"view"});case I:var q=e.payload.point;return t.active&&!St(t.active,q)?v(v({},t),{selected:new gt(new pt(q,t.active)),mode:"view"}):t;case S:q=e.payload.point;return v(v({},t),{selected:new gt(new pt(q,q)),active:q,mode:St(t.active,q)?"edit":"view"});case C:var $=e.payload,X=(z=$.active,$.data);return fe(t)?t:v(v({},t),{model:Kt(t.model,z,X),lastChanged:z});case b:var J=e.payload,Q=(q=J.point,J.dimensions),Z=t.rowDimensions[q.row],tt=t.columnDimensions[q.column];return Z&&tt&&Z.top===Q.top&&Z.height===Q.height&&tt.left===Q.left&&tt.width===Q.width?t:v(v({},t),{rowDimensions:v(v({},t.rowDimensions),(r={},r[q.row]={top:Q.top,height:Q.height},r)),columnDimensions:v(v({},t.columnDimensions),(n={},n[q.column]={left:Q.left,width:Q.width},n))});case U:case x:var et=t.selected.toRange(t.model.data);return v(v({},t),{copied:et,cut:e.type===x,hasPasted:!1});case L:var nt=e.payload.data;if(!(z=t.active))return t;var at=(s=function(t){return{value:t}},void 0===u&&(u="\t"),void 0===l&&(l=/\r\n|\n|\r/),nt.replace(/"([^"]*?)"/g,(function(t,e){return e.replace(/\n/g,"\\n")})).split(l).map((function(t){return t.split(u).map((function(t){return t.replace(/\\n/g,"\n")})).map(s)}))),lt=ut(at);if((et=t.selected.toRange(t.model.data))&&1===lt.rows&&1===lt.columns){var ft=rt({row:0,column:0},at),ht=t.cut&&t.copied?it(t.copied.start,t.model.data):t.model.data,mt=[];try{for(var vt=E(et||[]),Et=vt.next();!Et.done;Et=vt.next()){var Nt=rt(q=Et.value,t.model.data);mt.push({prevCell:Nt||null,nextCell:ft||null}),ht=ot(q,ft,ht)}}catch(Bt){o={error:Bt}}finally{try{Et&&!Et.done&&(a=vt.return)&&a.call(vt)}finally{if(o)throw o.error}}return v(v({},t),{model:new Yt(Vt,ht),copied:null,cut:!1,hasPasted:!0,mode:"view",lastCommit:mt})}var At={rows:z.row+lt.rows,columns:z.column+lt.columns},Mt=function(t,e){var r=ut(t),n=r.rows,o=r.columns;if(n>=e.rows&&o>=e.columns)return t;var a={rows:e.rows>n?e.rows:n,columns:e.columns>o?e.columns:o},i=N([],y(t),!1);if(a.columns>o){var c=a.columns-o;i=i.map((function(t){return N(N([],y(t),!1),y(Array(c).fill(void 0)),!1)}))}if(a.rows>n){var s=a.rows-n,u=Array(a.columns).fill(void 0);i=N(N([],y(i),!1),y(Array(s).fill(u)),!1)}return i}(t.model.data,At),wt={data:Mt,commit:[]};try{for(var Ot=E(ct(at)),It=Ot.next();!It.done;It=Ot.next()){var Ct=y(It.value,2),bt=(q=Ct[0],ft=Ct[1],wt.commit||[]),Ut={row:q.row+z.row,column:q.column+z.column},xt=wt.data;if(t.cut){if(t.copied)xt=it({row:q.row+t.copied.start.row,column:q.column+t.copied.start.column},wt.data);bt=N(N([],y(bt),!1),[{prevCell:ft||null,nextCell:null}],!1)}st(Ut,Mt)||(wt={data:xt,commit:bt});Nt=rt(Ut,xt)||null;bt=N(N([],y(bt),!1),[{prevCell:Nt,nextCell:ft||null}],!1),wt.data=ot(Ut,v(v({value:void 0},Nt),ft),xt),wt.commit=bt}}catch(Dt){i={error:Dt}}finally{try{It&&!It.done&&(c=Ot.return)&&c.call(Ot)}finally{if(i)throw i.error}}return v(v({},t),{model:new Yt(Vt,wt.data),selected:new gt(new pt(z,{row:z.row+lt.rows-1,column:z.column+lt.columns-1})),copied:null,cut:!1,hasPasted:!0,mode:"view",lastCommit:wt.commit});case _:return Jt(t);case k:return te(t);case"CLEAR":return Qt(t);case P:return Zt(t);case B:var Lt=e.payload.event;return fe(t)||Lt.metaKey?t:"view"===t.mode&&t.active?1===(null==(et=t.selected.toRange(t.model.data))?void 0:et.size())?Jt(Qt(t)):Jt(t):t;case D:var _t=e.payload.event,kt=le(t,_t);return kt?v(v({},t),kt(t,_t)):t;case F:return v(v({},t),{dragging:!0});case j:return v(v({},t),{dragging:!1});case V:var Pt=e.payload.changes;return v(v({},t),ee(Pt));default:throw new Error("Unknown action")}}function Jt(t){return fe(t)?t:v(v({},t),{mode:"edit"})}function Qt(t){var e,r;if(!t.active)return t;var n=function(t){return function(t){return t&&!t.readOnly}(t)?Object.assign({},t,{value:void 0}):t},o=t.selected.toRange(t.model.data),a=[],i=t.model.data;try{for(var c=E(o||[]),s=c.next();!s.done;s=c.next()){var u=s.value,l=rt(u,t.model.data),f=n(l);a.push({prevCell:l||null,nextCell:f||null}),i=ot(u,f,i)}}catch(h){e={error:h}}finally{try{s&&!s.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}return v(v(v({},t),{model:new Yt(Vt,i)}),ee(a))}function Zt(t){return v(v({},t),{active:null,selected:new vt})}function te(t){return v(v({},t),{mode:"view"})}function ee(t){return{lastCommit:t}}var re,ne=function(t,e){return function(r){if(r.active){var n=ut(r.model.data),o=r.active.column+e>=n.columns,a={row:r.active.row+t+(o?1:0),column:(r.active.column+e)%n.columns};return st(a,r.model.data)?v(v({},r),{active:a,selected:new gt(new pt(a,a)),mode:"view"}):v(v({},r),{mode:"view"})}}},oe={ArrowUp:ne(-1,0),ArrowDown:ne(1,0),ArrowLeft:ne(0,-1),ArrowRight:ne(0,1),Tab:ne(0,1),Enter:Jt,Backspace:Qt,Delete:Qt,Escape:Zt},ae={Escape:te,Tab:oe.Tab,Enter:oe.ArrowDown},ie={Tab:ne(0,-1)};!function(t){t.Left="Left",t.Right="Right",t.Top="Top",t.Bottom="Bottom"}(re||(re={}));var ce={ArrowUp:function(t){return v(v({},t),{selected:he(t.selected,t.active,t.model.data,re.Top)})},ArrowDown:function(t){return v(v({},t),{selected:he(t.selected,t.active,t.model.data,re.Bottom)})},ArrowLeft:function(t){return v(v({},t),{selected:he(t.selected,t.active,t.model.data,re.Left)})},ArrowRight:function(t){return v(v({},t),{selected:he(t.selected,t.active,t.model.data,re.Right)})},Tab:ne(0,-1)},se={},ue={};function le(t,e){var r=e.key;return("edit"===t.mode?e.shiftKey?ie:ae:e.shiftKey&&e.metaKey?se:e.shiftKey?ce:e.metaKey?ue:oe)[r]}function fe(t){var e=function(t){var e=t.active&&rt(t.active,t.model.data);return e||null}(t);return Boolean(null==e?void 0:e.readOnly)}function he(t,e,r,n){if(!e)return t;if(t instanceof gt){var o=function(t,e,r,n){var o,a=n===re.Left||n===re.Right?"column":"row",i=n===re.Left||n===re.Top?"start":"end",c="start"===i?-1:1,s=t.range.has(v(v({},e),((o={})[a]=e[a]+-1*c,o))),u=s?"start"===i?"end":"start":i,l=new pt(t.range.start,t.range.end);l[u][a]+=c;var f=new gt(l).normalizeTo(r);return f}(t,e,r,n);return o}return t instanceof Tt?function(t,e,r,n){if(n===re.Top||n===re.Bottom)return t;var o=n===re.Left?-1:1,a=n===re.Left?"start":"end",i="start"===a?"end":"start",c=v({},t);(n===re.Left?t.end>e.row:t.start<e.row)?c[i]=t[i]+o:c[a]=t[a]+o;var s=new Tt(Math.max(c.start,0),Math.max(c.end,0));return s.normalizeTo(r)}(t,e,r,n):t instanceof Rt?function(t,e,r,n){if(n===re.Left||n===re.Right)return t;var o=n===re.Top?-1:1,a=n===re.Top?"start":"end",i="start"===a?"end":"start",c=v({},t);(n===re.Top?t.end>e.row:t.start<e.row)?c[i]=t[i]+o:c[a]=t[a]+o;var s=new Rt(Math.max(c.start,0),Math.max(c.end,0));return s.normalizeTo(r)}(t,e,r,n):t}var pe=function(t){const e=(0,n.createContext)({[u]:{v:{current:t},n:{current:-1},l:new Set,u:t=>t()}});var r;return e[l]=e.Provider,e.Provider=(r=e.Provider,({value:t,children:e})=>{const o=(0,n.useRef)(t),a=(0,n.useRef)(0),[i,c]=(0,n.useState)(null);i&&(i(t),c(null));const s=(0,n.useRef)();if(!s.current){const t=new Set,e=(e,r)=>{a.current+=1;const n={n:a.current};(null==r?void 0:r.suspense)&&(n.n*=-1,n.p=new Promise((t=>{c((()=>e=>{n.v=e,delete n.p,t(e)}))}))),t.forEach((t=>t(n))),e()};s.current={[u]:{v:o,n:a,l:t,u:e}}}return f((()=>{o.current=t,a.current+=1,h((()=>{s.current[u].l.forEach((e=>{e({n:a.current,v:t})}))}))}),[t]),(0,n.createElement)(r,{value:s.current},e)}),delete e.Consumer,e}([$t,function(){}]),de=function(t){var e=t.children,r=It(t.columns+(t.hideColumnIndicators?0:1)).map((function(t){return n.createElement("col",{key:t})}));return n.createElement("table",{className:"Spreadsheet__table"},n.createElement("colgroup",null,r),n.createElement("tbody",null,e))},me=function(t){return n.createElement("tr",v({},t))},ve=function(t){return n.createElement("tr",v({},t))};function ge(){return p(pe,(function(t){var e=y(t,2);return e[0],e[1]}))}function Ee(t){return p(pe,(function(e){var r=y(e,1)[0];return t(r)}))}var ye=function(t){var e=t.selected,r=t.onSelect,o=n.useCallback((function(){r()}),[r]);return n.createElement("th",{className:a()("Spreadsheet__header",{"Spreadsheet__header--selected":e}),onClick:o,tabIndex:0})},Ne=function(t){return function(e){var r=ge(),o=n.useCallback((function(){return r({type:w})}),[r]),a=Ee((function(t){return t.selected instanceof yt}));return n.createElement(t,v({},e,{selected:a,onSelect:o}))}},Re=function(t){var e=t.column,r=t.label,o=t.selected,i=t.onSelect,c=n.useCallback((function(t){i(e,t.shiftKey)}),[i,e]);return n.createElement("th",{className:a()("Spreadsheet__header",{"Spreadsheet__header--selected":o}),onClick:c,tabIndex:0},void 0!==r?r:function(t){var e="",r=t;for(;r>=0;)e=String.fromCharCode(65+r%26)+e,r=Math.floor(r/26)-1;return e}(e))},Te=function(t){return function(e){var r=ge(),o=n.useCallback((function(t,e){return r(function(t,e){return{type:M,payload:{column:t,extend:e}}}(t,e))}),[r]),a=Ee((function(t){return t.selected.hasEntireColumn(e.column)}));return n.createElement(t,v({},e,{selected:a,onSelect:o}))}};var Ae=function(t){var e=t.row,r=t.label,o=t.selected,i=t.onSelect,c=n.useCallback((function(t){i(e,t.shiftKey)}),[i,e]);return n.createElement("th",{className:a()("Spreadsheet__header",{"Spreadsheet__header--selected":o}),onClick:c,tabIndex:0},void 0!==r?r:e+1)},Me=function(t){return function(e){var r=ge(),o=Ee((function(t){return t.selected.hasEntireRow(e.row)})),a=n.useCallback((function(t,e){return r(function(t,e){return{type:A,payload:{row:t,extend:e}}}(t,e))}),[r]);return n.createElement(t,v({},e,{selected:o,onSelect:a}))}},we=function(t){var e=t.row,r=t.column,o=t.DataViewer,i=t.selected,c=t.active,s=t.dragging,u=t.mode,l=t.data,f=t.evaluatedData,h=t.select,p=t.activate,d=t.setCellDimensions,m=t.setCellData,v=n.useRef(null),g=n.useMemo((function(){return{row:e,column:r}}),[e,r]),E=n.useCallback((function(t){"view"===u&&(d(g,Ct(t.currentTarget)),t.shiftKey?h(g):p(g))}),[u,d,g,h,p]),y=n.useCallback((function(t){s&&(d(g,Ct(t.currentTarget)),h(g))}),[d,h,s,g]);return n.useEffect((function(){var t=v.current;i&&t&&d(g,Ct(t)),t&&c&&"view"===u&&t.focus()}),[d,i,c,u,g,l]),l&&l.DataViewer&&(o=l.DataViewer),n.createElement("td",{ref:v,className:a()("Spreadsheet__cell",null==l?void 0:l.className,{"Spreadsheet__cell--readonly":null==l?void 0:l.readOnly}),onMouseOver:y,onMouseDown:E,tabIndex:0},n.createElement(o,{row:e,column:r,cell:l,evaluatedCell:f,setCellData:m}))},Oe=function(t){return function(e){var r=e.row,o=e.column,a=ge(),i=n.useMemo((function(){return{row:r,column:o}}),[r,o]),c=n.useCallback((function(t){return a(Y(i,t))}),[a,i]),s=n.useCallback((function(t){return a(function(t){return{type:I,payload:{point:t}}}(t))}),[a]),u=n.useCallback((function(t){return a(W(t))}),[a]),l=n.useCallback((function(t,e){return a(function(t,e){return{type:b,payload:{point:t,dimensions:e}}}(t,e))}),[a]),f=Ee((function(t){return St(t.active,i)})),h=Ee((function(t){return f?t.mode:"view"})),p=Ee((function(t){return rt(i,t.model.data)})),d=Ee((function(t){return rt(i,t.model.evaluatedData)})),m=Ee((function(t){return t.selected.has(t.model.data,i)})),g=Ee((function(t){return t.dragging})),E=Ee((function(t){var e;return(null===(e=t.copied)||void 0===e?void 0:e.has(i))||!1}));return n.createElement(t,v({},e,{selected:m,active:f,copied:E,dragging:g,mode:h,evaluatedData:d,data:p,select:s,activate:u,setCellDimensions:l,setCellData:c}))}},Ie="TRUE",Se="FALSE",Ce=function(t){var e=function(t,e){var r,n=null!==(r=null==e?void 0:e.value)&&void 0!==r?r:null==t?void 0:t.value;if(n&&"object"==typeof n)return n.toString();return n}(t.cell,t.evaluatedCell);return"boolean"==typeof e?n.createElement("span",{className:"Spreadsheet__data-viewer Spreadsheet__data-viewer--boolean"},function(t){return t?Ie:Se}(e)):n.createElement("span",{className:a()("Spreadsheet__data-viewer",{"Spreadsheet__data-viewer--preserve-breaks":kt(e)})},e)};var be=function(t){var e,r=t.onChange,o=t.cell,a=n.useRef(null),i=n.useCallback((function(t){r(v(v({},o),{value:t.target.value}))}),[r,o]);n.useEffect((function(){var t;a.current&&((t=a.current).selectionStart=t.selectionEnd=t.value.length)}),[a]);var c=null!==(e=null==o?void 0:o.value)&&void 0!==e?e:"";return n.createElement("div",{className:"Spreadsheet__data-editor"},n.createElement("input",{ref:a,type:"text",onChange:i,value:c,autoFocus:!0}))},Ue=function(t){var e=n.useRef(null),r=ge(),o=n.useCallback((function(t,e){return r(Y(t,e))}),[r]),i=n.useCallback((function(){return r({type:_})}),[r]),c=n.useCallback((function(t){return r(function(t){return{type:V,payload:{changes:t}}}(t))}),[r]),s=n.useCallback((function(){r({type:k})}),[r]),u=Ee((function(t){return t.active})),l=Ee((function(t){return t.mode})),f=Ee((function(t){return t.active?rt(t.active,t.model.data):void 0})),h=Ee((function(t){return u?bt(u,t.rowDimensions,t.columnDimensions):void 0})),p=n.useMemo((function(){return!u||!h}),[u,h]),d=n.useRef(void 0),m=n.useRef(null),v=n.useRef(void 0),g=n.useCallback((function(t){u&&o(u,t)}),[o,u]);n.useEffect((function(){var t=e.current;!p&&t&&t.focus()}),[e,p]),n.useEffect((function(){var t=m.current,e=v.current;if(m.current=u,v.current=f,t&&e){var r=(null==u?void 0:u.row)!==t.row||(null==u?void 0:u.column)!==t.column;if(r||"edit"!==l){var n=d.current;e!==n?c([{prevCell:n||null,nextCell:e}]):r||f===e||c([{prevCell:e,nextCell:f||null}]),d.current=f}}}));var E=f&&f.DataEditor||t.DataEditor,y=f&&f.readOnly;return p?null:n.createElement("div",{ref:e,className:a()("Spreadsheet__active-cell","Spreadsheet__active-cell--".concat(l)),style:h,onClick:"view"!==l||y?void 0:i,tabIndex:0},"edit"===l&&u&&n.createElement(E,{row:u.row,column:u.column,cell:f,onChange:g,exitEditMode:s}))},xe=function(t){var e,r=t.dimensions,o=t.dragging,i=t.hidden,c=t.variant,s=r||{},u=s.width,l=s.height,f=s.top,h=s.left;return n.createElement("div",{className:a()("Spreadsheet__floating-rect",(e={},e["Spreadsheet__floating-rect--".concat(c)]=c,e["Spreadsheet__floating-rect--dragging"]=o,e["Spreadsheet__floating-rect--hidden"]=i,e)),style:{width:u,height:l,top:f,left:h}})},Le=function(){var t=Ee((function(t){return t.selected})),e=Ee((function(e){return t&&function(t,e,r,n){var o=n.toRange(r);return o?Ut(t,e,o):void 0}(e.rowDimensions,e.columnDimensions,e.model.data,e.selected)})),r=Ee((function(t){return t.dragging})),o=Ee((function(t){return t.selected.size(t.model.data)<2}));return n.createElement(xe,{variant:"selected",dimensions:e,dragging:r,hidden:o})},_e=function(){var t=Ee((function(t){return t.copied})),e=Ee((function(e){return t&&Ut(e.rowDimensions,e.columnDimensions,t)})),r=null===t;return n.createElement(xe,{variant:"copied",dimensions:e,hidden:r,dragging:!1})};!function(t,e){void 0===e&&(e={});var r=e.insertAt;if(t&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===r&&n.firstChild?n.insertBefore(o,n.firstChild):n.appendChild(o),o.styleSheet?o.styleSheet.cssText=t:o.appendChild(document.createTextNode(t))}}(".Spreadsheet {\n  --background-color: white;\n  --text-color: black;\n  --readonly-text-color: rgb(0 0 0 / 40%);\n  --outline-color: #4285f4;\n  --outline-background-color: rgb(160 195 255 / 20%);\n  --border-color: hsl(2deg 0% 91%);\n  --header-background-color: rgb(0 0 0 / 4%);\n  --elevation: 0 2px 5px rgb(0 0 0 / 40%);\n\n  position: relative;\n  overflow: visible;\n  background: var(--background-color);\n  color: var(--text-color);\n  display: inline-block;\n}\n\n.Spreadsheet--dark-mode {\n  --background-color: black;\n  --text-color: white;\n  --readonly-text-color: rgb(255 255 255 / 40%);\n  --header-background-color: rgb(255 255 255 / 4%);\n  --border-color: hsl(2deg 0% 19%);\n}\n\n.Spreadsheet__active-cell {\n  position: absolute;\n  border: 2px solid var(--outline-color);\n  box-sizing: border-box;\n}\n\n.Spreadsheet__active-cell--edit {\n  background: var(--background-color);\n  box-shadow: var(--elevation);\n}\n\n.Spreadsheet__table {\n  border-collapse: collapse;\n  table-layout: fixed;\n}\n\n.Spreadsheet__cell,\n.Spreadsheet__active-cell {\n  cursor: cell;\n}\n\n.Spreadsheet__cell {\n  outline: none;\n}\n\n.Spreadsheet__cell--readonly {\n  color: var(--readonly-text-color);\n}\n\n.Spreadsheet__cell,\n.Spreadsheet__header {\n  min-width: 6em;\n  min-height: 1.9em;\n  height: 1.9em;\n  max-height: 1.9em;\n  border: 1px solid var(--border-color);\n  overflow: hidden;\n  word-break: keep-all;\n  white-space: nowrap;\n  text-align: left;\n  box-sizing: border-box;\n  user-select: none;\n}\n\n.Spreadsheet__header {\n  background: var(--header-background-color);\n  color: var(--readonly-text-color);\n  text-align: center;\n  font: inherit;\n}\n\n.Spreadsheet__header--selected {\n  background: #5f6268;\n  color: #fff;\n}\n\n.Spreadsheet__header,\n.Spreadsheet__data-viewer,\n.Spreadsheet__data-editor input {\n  padding: 4px;\n  box-sizing: border-box;\n}\n\n.Spreadsheet__data-viewer--preserve-breaks {\n  white-space: pre-wrap;\n}\n\n.Spreadsheet__data-editor,\n.Spreadsheet__data-editor input {\n  width: 100%;\n  height: 100%;\n}\n\n.Spreadsheet__data-editor input {\n  font: inherit;\n  color: inherit;\n  background: none;\n  border: none;\n  outline: none;\n  margin: 0;\n}\n\n.Spreadsheet__data-viewer--boolean {\n  text-align: center;\n}\n\n.Spreadsheet__floating-rect {\n  position: absolute;\n  pointer-events: none;\n  box-sizing: border-box;\n}\n\n.Spreadsheet__floating-rect--hidden {\n  display: none;\n}\n\n.Spreadsheet__floating-rect--selected {\n  background: var(--outline-background-color);\n  border: 2px var(--outline-color) solid;\n}\n\n.Spreadsheet__floating-rect--dragging {\n  border: none;\n}\n\n.Spreadsheet__floating-rect--copied {\n  border: 2px var(--outline-color) dashed;\n}\n");var ke=n.forwardRef((function(t,e){var r,o=t.className,i=t.darkMode,c=t.columnLabels,s=t.rowLabels,u=t.hideColumnIndicators,l=t.hideRowIndicators,f=t.onKeyDown,h=t.Table,p=void 0===h?de:h,d=t.Row,m=void 0===d?me:d,g=t.HeaderRow,R=void 0===g?ve:g,T=t.DataEditor,A=void 0===T?be:T,M=t.DataViewer,w=void 0===M?Ce:M,O=t.onChange,I=void 0===O?function(){}:O,S=t.onModeChange,C=void 0===S?function(){}:S,b=t.onSelect,U=void 0===b?function(){}:b,x=t.onActivate,L=void 0===x?function(){}:x,_=t.onBlur,k=void 0===_?function(){}:_,P=t.onCellCommit,B=void 0===P?function(){}:P,D=t.onEvaluatedDataChange,F=void 0===D?function(){}:D,j=n.useMemo((function(){var e=t.createFormulaParser||Vt,r=new Yt(e,t.data);return v(v({},$t),{model:r,selected:t.selected||$t.selected})}),[t.createFormulaParser,t.data,t.selected]),V=n.useReducer(Xt,j),Y=y(V,2),et=Y[0],rt=Y[1],ot=n.useMemo((function(){return function(t,e,r){var n=ut(t),o=n.columns,a=n.rows;return{rows:e?Math.max(a,e.length):a,columns:r?Math.max(o,r.length):o}}(et.model.data,s,c)}),[et.model.data,s,c]),at=et.mode,it=n.useRef(null),ct=function(t){return n.useCallback((function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return rt(t.apply(void 0,N([],y(e),!1)))}),[t])},st=ct(Z),lt=ct(Q),ft=ct(K),ht=ct($),pt=ct(q),dt=ct(X),mt=ct(J),vt=ct(G),gt=ct(z),Et=ct(tt),yt=ct(H),Nt=ct(W),Rt=n.useMemo((function(){return{activate:function(t){Nt(t)}}}),[]);n.useImperativeHandle(e,(function(){return Rt}));var Tt=n.useRef(et.active);n.useEffect((function(){if(et.active!==Tt.current)if(et.active)L(et.active);else{var t=it.current;t&&_t(t)&&document.activeElement&&document.activeElement.blur(),k()}Tt.current=et.active}),[L,k,et.active]);var At=n.useRef(et.model.data);n.useEffect((function(){et.model.data!==At.current&&et.model.data!==t.data&&I(et.model.data),At.current=et.model.data}),[et.model.data,I,t.data]);var Mt=n.useRef(et.model.evaluatedData);n.useEffect((function(){var t,e;(null===(t=null==et?void 0:et.model)||void 0===t?void 0:t.evaluatedData)!==(null==Mt?void 0:Mt.current)&&F(null===(e=null==et?void 0:et.model)||void 0===e?void 0:e.evaluatedData),Mt.current=et.model.evaluatedData}),[null===(r=null==et?void 0:et.model)||void 0===r?void 0:r.evaluatedData,F]);var wt=n.useRef(et.selected);n.useEffect((function(){et.selected.equals(wt.current)||t.selected&&et.selected.equals(t.selected)||U(et.selected),wt.current=et.selected}),[et.selected,U,t.selected]);var St=n.useRef(et.mode);n.useEffect((function(){et.mode!==St.current&&C(et.mode),St.current=et.mode}),[et.mode,C]);var Ct=n.useRef(et.lastCommit);n.useEffect((function(){var t,e;if(et.lastCommit&&et.lastCommit!==Ct.current)try{for(var r=E(et.lastCommit),n=r.next();!n.done;n=r.next()){var o=n.value;B(o.prevCell,o.nextCell,et.lastChanged)}}catch(a){t={error:a}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}}),[B,et.lastChanged,et.lastCommit]);var bt=n.useRef(t.selected);n.useEffect((function(){t.selected&&bt.current&&!t.selected.equals(bt.current)&&yt(t.selected),bt.current=t.selected}),[t.selected,yt]);var Ut=n.useRef(t.data);n.useEffect((function(){t.data!==Ut.current&&vt(t.data),Ut.current=t.data}),[t.data,vt]);var kt=n.useRef(t.createFormulaParser);n.useEffect((function(){t.createFormulaParser!==kt.current&&t.createFormulaParser&&gt(t.createFormulaParser),kt.current=t.createFormulaParser}),[t.createFormulaParser,gt]);var Pt=n.useCallback((function(t){var e=et.model,r=et.selected,n=e.data,o=r.toRange(n);o&&function(t,e){var r;null===(r=t.clipboardData)||void 0===r||r.setData(Ot,e)}(t,xt(nt(o.start,o.end,n)))}),[et]),Bt=n.useCallback((function(t){Lt(it.current,at)&&(t.preventDefault(),t.stopPropagation(),Pt(t),st())}),[at,Pt,st]),Dt=n.useCallback((function(t){Lt(it.current,at)&&(t.preventDefault(),t.stopPropagation(),Pt(t),lt())}),[at,Pt,lt]),Ft=n.useCallback((function(t){if(Lt(it.current,at)&&(t.preventDefault(),t.stopPropagation(),t.clipboardData)){var e=function(t){return window.clipboardData&&window.clipboardData.getData?window.clipboardData.getData("Text"):t.clipboardData&&t.clipboardData.getData?t.clipboardData.getData(Ot):""}(t);ft(e)}}),[at,ft]),jt=n.useCallback((function(t){t.persist(),f&&f(t),t.defaultPrevented||(function(t,e){return void 0!==le(t,e)}(et,t)&&t.nativeEvent.preventDefault(),ht(t))}),[et,f,ht]),Gt=n.useCallback((function(){mt(),document.removeEventListener("mouseup",Gt)}),[mt]),zt=n.useCallback((function(t){et.dragging||1!==t.buttons||(dt(),document.addEventListener("mouseup",Gt))}),[et,dt,Gt]),Ht=n.useCallback((function(t){t.currentTarget.contains(t.relatedTarget)||Et()}),[Et]),Wt=n.useMemo((function(){return Oe(t.Cell||we)}),[t.Cell]),Kt=n.useMemo((function(){return Ne(t.CornerIndicator||ye)}),[t.CornerIndicator]),qt=n.useMemo((function(){return Me(t.RowIndicator||Ae)}),[t.RowIndicator]),Jt=n.useMemo((function(){return Te(t.ColumnIndicator||Re)}),[t.ColumnIndicator]);n.useEffect((function(){return document.addEventListener("cut",Bt),document.addEventListener("copy",Dt),document.addEventListener("paste",Ft),function(){document.removeEventListener("cut",Bt),document.removeEventListener("copy",Dt),document.removeEventListener("paste",Ft)}}),[Bt,Dt,Ft]);var Qt=n.useMemo((function(){return n.createElement(p,{columns:ot.columns,hideColumnIndicators:u},n.createElement(R,null,!l&&!u&&n.createElement(Kt,null),!u&&It(ot.columns).map((function(t){return c?n.createElement(Jt,{key:t,column:t,label:t in c?c[t]:null}):n.createElement(Jt,{key:t,column:t})}))),It(ot.rows).map((function(t){return n.createElement(m,{key:t,row:t},!l&&(s?n.createElement(qt,{key:t,row:t,label:t in s?s[t]:null}):n.createElement(qt,{key:t,row:t})),It(ot.columns).map((function(e){return n.createElement(Wt,{key:e,row:t,column:e,DataViewer:w})})))})))}),[p,ot.rows,ot.columns,u,m,R,l,Kt,c,Jt,s,qt,Wt,w]),Zt=n.useMemo((function(){return n.createElement(Ue,{DataEditor:A})}),[A]),te=n.useMemo((function(){return n.createElement("div",{ref:it,className:a()("Spreadsheet",o,{"Spreadsheet--dark-mode":i}),onKeyPress:pt,onKeyDown:jt,onMouseMove:zt,onBlur:Ht},Qt,Zt,n.createElement(Le,null),n.createElement(_e,null))}),[o,i,pt,jt,zt,Ht,Qt,Zt]);return n.createElement(pe.Provider,{value:V},te)}))},2475:function(t,e){var r,n,o;"undefined"!=typeof self&&self,n=[],void 0===(o="function"==typeof(r=function(){function t(){}t.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},t.prototype.restoreState=function(t){this.idx=t.idx,this.input=t.input,this.groupIdx=t.groupIdx},t.prototype.pattern=function(t){this.idx=0,this.input=t,this.groupIdx=0,this.consumeChar("/");var e=this.disjunction();this.consumeChar("/");for(var r={type:"Flags",loc:{begin:this.idx,end:t.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":c(r,"global");break;case"i":c(r,"ignoreCase");break;case"m":c(r,"multiLine");break;case"u":c(r,"unicode");break;case"y":c(r,"sticky")}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:r,value:e,loc:this.loc(0)}},t.prototype.disjunction=function(){var t=[],e=this.idx;for(t.push(this.alternative());"|"===this.peekChar();)this.consumeChar("|"),t.push(this.alternative());return{type:"Disjunction",value:t,loc:this.loc(e)}},t.prototype.alternative=function(){for(var t=[],e=this.idx;this.isTerm();)t.push(this.term());return{type:"Alternative",value:t,loc:this.loc(e)}},t.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},t.prototype.assertion=function(){var t=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(t)};case"$":return{type:"EndAnchor",loc:this.loc(t)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(t)};case"B":return{type:"NonWordBoundary",loc:this.loc(t)}}throw Error("Invalid Assertion Escape");case"(":var e;switch(this.consumeChar("?"),this.popChar()){case"=":e="Lookahead";break;case"!":e="NegativeLookahead"}s(e);var r=this.disjunction();return this.consumeChar(")"),{type:e,value:r,loc:this.loc(t)}}u()},t.prototype.quantifier=function(t){var e,r=this.idx;switch(this.popChar()){case"*":e={atLeast:0,atMost:1/0};break;case"+":e={atLeast:1,atMost:1/0};break;case"?":e={atLeast:0,atMost:1};break;case"{":var n=this.integerIncludingZero();switch(this.popChar()){case"}":e={atLeast:n,atMost:n};break;case",":e=this.isDigit()?{atLeast:n,atMost:this.integerIncludingZero()}:{atLeast:n,atMost:1/0},this.consumeChar("}")}if(!0===t&&void 0===e)return;s(e)}if(!0!==t||void 0!==e)return s(e),"?"===this.peekChar(0)?(this.consumeChar("?"),e.greedy=!1):e.greedy=!0,e.type="Quantifier",e.loc=this.loc(r),e},t.prototype.atom=function(){var t,e=this.idx;switch(this.peekChar()){case".":t=this.dotAll();break;case"\\":t=this.atomEscape();break;case"[":t=this.characterClass();break;case"(":t=this.group()}return void 0===t&&this.isPatternCharacter()&&(t=this.patternCharacter()),s(t),t.loc=this.loc(e),this.isQuantifier()&&(t.quantifier=this.quantifier()),t},t.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[a("\n"),a("\r"),a("\u2028"),a("\u2029")]}},t.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},t.prototype.decimalEscapeAtom=function(){return{type:"GroupBackReference",value:this.positiveInteger()}},t.prototype.characterClassEscape=function(){var t,e=!1;switch(this.popChar()){case"d":t=l;break;case"D":t=l,e=!0;break;case"s":t=h;break;case"S":t=h,e=!0;break;case"w":t=f;break;case"W":t=f,e=!0}return s(t),{type:"Set",value:t,complement:e}},t.prototype.controlEscapeAtom=function(){var t;switch(this.popChar()){case"f":t=a("\f");break;case"n":t=a("\n");break;case"r":t=a("\r");break;case"t":t=a("\t");break;case"v":t=a("\v")}return s(t),{type:"Character",value:t}},t.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var t=this.popChar();if(!1===/[a-zA-Z]/.test(t))throw Error("Invalid ");return{type:"Character",value:t.toUpperCase().charCodeAt(0)-64}},t.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:a("\0")}},t.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},t.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},t.prototype.identityEscapeAtom=function(){return{type:"Character",value:a(this.popChar())}},t.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case"\n":case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:return{type:"Character",value:a(this.popChar())}}},t.prototype.characterClass=function(){var t=[],e=!1;for(this.consumeChar("["),"^"===this.peekChar(0)&&(this.consumeChar("^"),e=!0);this.isClassAtom();){var r=this.classAtom();if("Character"===r.type&&this.isRangeDash()){this.consumeChar("-");var n=this.classAtom();if("Character"===n.type){if(n.value<r.value)throw Error("Range out of order in character class");t.push({from:r.value,to:n.value})}else i(r.value,t),t.push(a("-")),i(n.value,t)}else i(r.value,t)}return this.consumeChar("]"),{type:"Set",complement:e,value:t}},t.prototype.classAtom=function(){switch(this.peekChar()){case"]":case"\n":case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},t.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:a("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},t.prototype.group=function(){var t=!0;this.consumeChar("("),"?"===this.peekChar(0)?(this.consumeChar("?"),this.consumeChar(":"),t=!1):this.groupIdx++;var e=this.disjunction();this.consumeChar(")");var r={type:"Group",capturing:t,value:e};return t&&(r.idx=this.groupIdx),r},t.prototype.positiveInteger=function(){var t=this.popChar();if(!1===o.test(t))throw Error("Expecting a positive integer");for(;n.test(this.peekChar(0));)t+=this.popChar();return parseInt(t,10)},t.prototype.integerIncludingZero=function(){var t=this.popChar();if(!1===n.test(t))throw Error("Expecting an integer");for(;n.test(this.peekChar(0));)t+=this.popChar();return parseInt(t,10)},t.prototype.patternCharacter=function(){var t=this.popChar();switch(t){case"\n":case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:a(t)}}},t.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},t.prototype.isRangeDash=function(){return"-"===this.peekChar()&&this.isClassAtom(1)},t.prototype.isDigit=function(){return n.test(this.peekChar(0))},t.prototype.isClassAtom=function(t){switch(void 0===t&&(t=0),this.peekChar(t)){case"]":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},t.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},t.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},t.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return"?"===this.peekChar(1)&&("="===this.peekChar(2)||"!"===this.peekChar(2));default:return!1}},t.prototype.isQuantifier=function(){var t=this.saveState();try{return void 0!==this.quantifier(!0)}catch(e){return!1}finally{this.restoreState(t)}},t.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},t.prototype.parseHexDigits=function(t){for(var e="",n=0;n<t;n++){var o=this.popChar();if(!1===r.test(o))throw Error("Expecting a HexDecimal digits");e+=o}return{type:"Character",value:parseInt(e,16)}},t.prototype.peekChar=function(t){return void 0===t&&(t=0),this.input[this.idx+t]},t.prototype.popChar=function(){var t=this.peekChar(0);return this.consumeChar(),t},t.prototype.consumeChar=function(t){if(void 0!==t&&this.input[this.idx]!==t)throw Error("Expected: '"+t+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++},t.prototype.loc=function(t){return{begin:t,end:this.idx}};var e,r=/[0-9a-fA-F]/,n=/[0-9]/,o=/[1-9]/;function a(t){return t.charCodeAt(0)}function i(t,e){void 0!==t.length?t.forEach((function(t){e.push(t)})):e.push(t)}function c(t,e){if(!0===t[e])throw"duplicate flag "+e;t[e]=!0}function s(t){if(void 0===t)throw Error("Internal Error - Should never get here!")}function u(){throw Error("Internal Error - Should never get here!")}var l=[];for(e=a("0");e<=a("9");e++)l.push(e);var f=[a("_")].concat(l);for(e=a("a");e<=a("z");e++)f.push(e);for(e=a("A");e<=a("Z");e++)f.push(e);var h=[a(" "),a("\f"),a("\n"),a("\r"),a("\t"),a("\v"),a("\t"),a("\xa0"),a("\u1680"),a("\u2000"),a("\u2001"),a("\u2002"),a("\u2003"),a("\u2004"),a("\u2005"),a("\u2006"),a("\u2007"),a("\u2008"),a("\u2009"),a("\u200a"),a("\u2028"),a("\u2029"),a("\u202f"),a("\u205f"),a("\u3000"),a("\ufeff")];function p(){}return p.prototype.visitChildren=function(t){for(var e in t){var r=t[e];t.hasOwnProperty(e)&&(void 0!==r.type?this.visit(r):Array.isArray(r)&&r.forEach((function(t){this.visit(t)}),this))}},p.prototype.visit=function(t){switch(t.type){case"Pattern":this.visitPattern(t);break;case"Flags":this.visitFlags(t);break;case"Disjunction":this.visitDisjunction(t);break;case"Alternative":this.visitAlternative(t);break;case"StartAnchor":this.visitStartAnchor(t);break;case"EndAnchor":this.visitEndAnchor(t);break;case"WordBoundary":this.visitWordBoundary(t);break;case"NonWordBoundary":this.visitNonWordBoundary(t);break;case"Lookahead":this.visitLookahead(t);break;case"NegativeLookahead":this.visitNegativeLookahead(t);break;case"Character":this.visitCharacter(t);break;case"Set":this.visitSet(t);break;case"Group":this.visitGroup(t);break;case"GroupBackReference":this.visitGroupBackReference(t);break;case"Quantifier":this.visitQuantifier(t)}this.visitChildren(t)},p.prototype.visitPattern=function(t){},p.prototype.visitFlags=function(t){},p.prototype.visitDisjunction=function(t){},p.prototype.visitAlternative=function(t){},p.prototype.visitStartAnchor=function(t){},p.prototype.visitEndAnchor=function(t){},p.prototype.visitWordBoundary=function(t){},p.prototype.visitNonWordBoundary=function(t){},p.prototype.visitLookahead=function(t){},p.prototype.visitNegativeLookahead=function(t){},p.prototype.visitCharacter=function(t){},p.prototype.visitSet=function(t){},p.prototype.visitGroup=function(t){},p.prototype.visitGroupBackReference=function(t){},p.prototype.visitQuantifier=function(t){},{RegExpParser:t,BaseRegExpVisitor:p,VERSION:"0.5.0"}})?r.apply(e,n):r)||(t.exports=o)},7463:(t,e)=>{"use strict";function r(t,e){var r=t.length;t.push(e);t:for(;0<r;){var n=r-1>>>1,o=t[n];if(!(0<a(o,e)))break t;t[n]=e,t[r]=o,r=n}}function n(t){return 0===t.length?null:t[0]}function o(t){if(0===t.length)return null;var e=t[0],r=t.pop();if(r!==e){t[0]=r;t:for(var n=0,o=t.length,i=o>>>1;n<i;){var c=2*(n+1)-1,s=t[c],u=c+1,l=t[u];if(0>a(s,r))u<o&&0>a(l,s)?(t[n]=l,t[u]=r,n=u):(t[n]=s,t[c]=r,n=c);else{if(!(u<o&&0>a(l,r)))break t;t[n]=l,t[u]=r,n=u}}}return e}function a(t,e){var r=t.sortIndex-e.sortIndex;return 0!==r?r:t.id-e.id}if("object"==typeof performance&&"function"==typeof performance.now){var i=performance;e.unstable_now=function(){return i.now()}}else{var c=Date,s=c.now();e.unstable_now=function(){return c.now()-s}}var u=[],l=[],f=1,h=null,p=3,d=!1,m=!1,v=!1,g="function"==typeof setTimeout?setTimeout:null,E="function"==typeof clearTimeout?clearTimeout:null,y="undefined"!=typeof setImmediate?setImmediate:null;function N(t){for(var e=n(l);null!==e;){if(null===e.callback)o(l);else{if(!(e.startTime<=t))break;o(l),e.sortIndex=e.expirationTime,r(u,e)}e=n(l)}}function R(t){if(v=!1,N(t),!m)if(null!==n(u))m=!0,L(T);else{var e=n(l);null!==e&&_(R,e.startTime-t)}}function T(t,r){m=!1,v&&(v=!1,E(O),O=-1),d=!0;var a=p;try{for(N(r),h=n(u);null!==h&&(!(h.expirationTime>r)||t&&!C());){var i=h.callback;if("function"==typeof i){h.callback=null,p=h.priorityLevel;var c=i(h.expirationTime<=r);r=e.unstable_now(),"function"==typeof c?h.callback=c:h===n(u)&&o(u),N(r)}else o(u);h=n(u)}if(null!==h)var s=!0;else{var f=n(l);null!==f&&_(R,f.startTime-r),s=!1}return s}finally{h=null,p=a,d=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var A,M=!1,w=null,O=-1,I=5,S=-1;function C(){return!(e.unstable_now()-S<I)}function b(){if(null!==w){var t=e.unstable_now();S=t;var r=!0;try{r=w(!0,t)}finally{r?A():(M=!1,w=null)}}else M=!1}if("function"==typeof y)A=function(){y(b)};else if("undefined"!=typeof MessageChannel){var U=new MessageChannel,x=U.port2;U.port1.onmessage=b,A=function(){x.postMessage(null)}}else A=function(){g(b,0)};function L(t){w=t,M||(M=!0,A())}function _(t,r){O=g((function(){t(e.unstable_now())}),r)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){m||d||(m=!0,L(T))},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<t?Math.floor(1e3/t):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(t){switch(p){case 1:case 2:case 3:var e=3;break;default:e=p}var r=p;p=e;try{return t()}finally{p=r}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var r=p;p=t;try{return e()}finally{p=r}},e.unstable_scheduleCallback=function(t,o,a){var i=e.unstable_now();switch("object"==typeof a&&null!==a?a="number"==typeof(a=a.delay)&&0<a?i+a:i:a=i,t){case 1:var c=-1;break;case 2:c=250;break;case 5:c=1073741823;break;case 4:c=1e4;break;default:c=5e3}return t={id:f++,callback:o,priorityLevel:t,startTime:a,expirationTime:c=a+c,sortIndex:-1},a>i?(t.sortIndex=a,r(l,t),null===n(u)&&t===n(l)&&(v?(E(O),O=-1):v=!0,_(R,a-i))):(t.sortIndex=c,r(u,t),m||d||(m=!0,L(T))),t},e.unstable_shouldYield=C,e.unstable_wrapCallback=function(t){var e=p;return function(){var r=p;p=e;try{return t.apply(this,arguments)}finally{p=r}}}},9982:(t,e,r)=>{"use strict";t.exports=r(7463)}}]);